<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUVEX - Autonomous Wealth Automation</title>
    
    <!-- Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bignumber.js@9.1.2/bignumber.min.js"></script>

    <style>
        :root {
            --bg-deep: #0d0702;
            --bg-card: rgba(26, 13, 1, 0.9);
            --primary: #ff6a00; /* Burnt Orange */
            --secondary: #ffb300; /* Amber */
            --accent: #ffd700; /* Gold */
            --text-main: #fffcf9;
            --text-muted: #a39382;
            --glass-border: 1px solid rgba(255, 106, 0, 0.2);
            --grad-main: linear-gradient(135deg, #4b2200 0%, #ff6a00 100%);
            --grad-gold: linear-gradient(135deg, #ffb300 0%, #ffd700 100%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-main);
            overflow-x: hidden;
            background-image: radial-gradient(circle at 10% 20%, rgba(255, 106, 0, 0.05) 0%, transparent 40%),
                              radial-gradient(circle at 90% 80%, rgba(255, 215, 0, 0.03) 0%, transparent 40%);
            line-height: 1.6;
        }

        /* UI Helpers */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .gradient-text { background: var(--grad-gold); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }
        .btn { 
            display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; 
            border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.3s;
            border: none; text-decoration: none; font-size: 0.95rem;
        }
        .btn-primary { background: var(--grad-main); color: white; box-shadow: 0 4px 15px rgba(255, 106, 0, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 106, 0, 0.5); }
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        .btn-outline:hover { background: rgba(255, 106, 0, 0.1); }
        
        .card { background: var(--bg-card); border: var(--glass-border); border-radius: 20px; padding: 25px; margin-bottom: 20px; position: relative; overflow: hidden; }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, rgba(255,106,0,0.05) 0%, transparent 100%); pointer-events: none; }

        /* Navbar */
        header { position: fixed; top: 0; width: 100%; height: 80px; background: rgba(13, 7, 2, 0.9); backdrop-filter: blur(10px); z-index: 1000; border-bottom: var(--glass-border); }
        .nav-wrap { display: flex; justify-content: space-between; align-items: center; height: 100%; }
        .logo-box { display: flex; align-items: center; gap: 10px; text-decoration: none; }
        .logo-box img { height: 40px; }
        .logo-box span { font-family: 'Space Grotesk', sans-serif; font-size: 1.5rem; font-weight: 700; color: white; letter-spacing: 2px; }
        
        .menu-toggle { font-size: 1.5rem; color: var(--primary); cursor: pointer; }
        .nav-menu { position: fixed; top: 80px; right: -100%; width: 280px; height: calc(100vh - 80px); background: #1a0d01; transition: 0.4s; padding: 40px 20px; display: flex; flex-direction: column; gap: 20px; border-left: var(--glass-border); }
        .nav-menu.active { right: 0; }
        .nav-link { color: var(--text-muted); text-decoration: none; font-size: 1.1rem; font-weight: 500; display: flex; align-items: center; gap: 15px; }
        .nav-link:hover, .nav-link.active { color: var(--primary); }

        /* Sections */
        section { padding: 120px 0 60px; display: none; min-height: 100vh; }
        section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Home */
        .hero { text-align: center; max-width: 900px; margin: 0 auto 60px; }
        .hero h1 { font-family: 'Space Grotesk', sans-serif; font-size: 3.5rem; line-height: 1.1; margin-bottom: 20px; }
        .hero p { font-size: 1.2rem; color: var(--text-muted); margin-bottom: 35px; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .stat-box { text-align: center; padding: 20px; border-radius: 15px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05); }
        .stat-val { display: block; font-size: 1.3rem; font-weight: 700; color: var(--accent); }
        .stat-label { font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; }

        /* Forms */
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 0.9rem; }
        .input-box { width: 100%; padding: 15px; border-radius: 12px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,106,0,0.2); color: white; font-size: 1rem; }
        .plan-select { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .plan-opt { padding: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); cursor: pointer; text-align: center; transition: 0.3s; }
        .plan-opt:hover { border-color: var(--primary); }
        .plan-opt.selected { border-color: var(--primary); background: rgba(255,106,0,0.1); }
        .plan-opt b { display: block; color: var(--secondary); }

        /* Dashboard Table */
        .table-responsive { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; min-width: 500px; }
        th { text-align: left; padding: 12px; border-bottom: 1px solid rgba(255,106,0,0.2); color: var(--text-muted); font-size: 0.85rem; }
        td { padding: 15px 12px; border-bottom: 1px solid rgba(255,255,255,0.03); font-size: 0.9rem; }

        /* Referral Tiers */
        .tier-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 15px; }
        .tier-box { padding: 15px; border-radius: 12px; background: rgba(255,106,0,0.05); border-left: 4px solid var(--primary); }
        .tier-head { display: flex; justify-content: space-between; margin-bottom: 5px; font-weight: 700; }
        .tier-req { font-size: 0.75rem; color: var(--text-muted); }

        /* FAQ */
        .faq-item { margin-bottom: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); }
        .faq-q { padding: 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 600; }
        .faq-a { padding: 0 15px 15px; color: var(--text-muted); display: none; }
        .faq-item.active .faq-a { display: block; }
        .faq-item.active .faq-q i { transform: rotate(180deg); }

        /* Modal */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 20px; }
        .modal.active { display: flex; }
        .modal-content { background: #1a0d01; border: var(--glass-border); border-radius: 20px; width: 100%; max-width: 400px; padding: 30px; position: relative; }

        .scorch-text { color: #ff3c00; text-shadow: 0 0 10px rgba(255,60,0,0.3); }

        @media (max-width: 768px) {
            .hero h1 { font-size: 2.2rem; }
            .plan-select { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container nav-wrap">
            <a href="#" class="logo-box" onclick="showSection('home')">
                <img src="image/logo.png" alt="Auvex" onerror="this.style.display='none'">
                <span>AUVEX</span>
            </a>
            
            <div style="display: flex; align-items: center; gap: 20px;">
                <button class="btn btn-primary" id="connectBtn" onclick="connectWallet()">
                    <i class="fas fa-wallet"></i> Connect Wallet
                </button>
                <div class="menu-toggle" id="menuBtn">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </div>
    </header>

    <nav class="nav-menu" id="sideNav">
        <a href="#" class="nav-link active" onclick="showSection('home')"><i class="fas fa-home"></i> Home</a>
        <a href="#" class="nav-link" onclick="showSection('cycle')"><i class="fas fa-sync-alt"></i> Cycle</a>
        <a href="#" class="nav-link" onclick="showSection('saving')"><i class="fas fa-piggy-bank"></i> Saving</a>
        <a href="#" class="nav-link" onclick="showSection('whitepaper')"><i class="fas fa-file-alt"></i> Whitepaper</a>
        <a href="#" class="nav-link" onclick="showSection('audit')"><i class="fas fa-shield-alt"></i> Audit</a>
        <a href="#" class="nav-link" onclick="showSection('faq')"><i class="fas fa-question-circle"></i> FAQ</a>
    </nav>

    <main class="container">
        <!-- Home Section -->
        <section id="home" class="active">
            <div class="hero">
                <h2 style="color: var(--primary); letter-spacing: 3px;">INSTITUTIONAL YIELD</h2>
                <h1>Autonomous <span class="gradient-text">Wealth Automation</span></h1>
                <p>Auvex Protocol delivers decentralized asset management via secure algorithmic cycles and liquid savings on the Binance Smart Chain.</p>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="showSection('cycle')">
                        <i class="fas fa-bolt"></i> Start Cycle
                    </button>
                    <button class="btn btn-outline" onclick="showSection('saving')">
                        <i class="fas fa-leaf"></i> Start Saving
                    </button>
                </div>
            </div>

            <div class="card stats-grid">
                <div class="stat-box">
                    <span class="stat-label">Liquidity</span>
                    <span class="stat-val" id="statPool">0.00 USDT</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Total Users</span>
                    <span class="stat-val" id="statUsers">0 Active</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Total Investment</span>
                    <span class="stat-val" id="statInvested">0.00 USDT</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Total Paid Out</span>
                    <span class="stat-val" id="statWithdrawn">0.00 USDT</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label scorch-text">Scorch Referral</span>
                    <span class="stat-val scorch-text" id="statScorch">0.00 USDT</span>
                </div>
            </div>
        </section>

        <!-- Cycle Section -->
        <section id="cycle">
            <div class="hero" style="margin-bottom: 40px;">
                <h1>Cycle <span class="gradient-text">Investment</span></h1>
                <p>Execute short-term yield cycles with fixed duration and guaranteed returns</p>
            </div>

            <div class="card">
                <h3>Start New Cycle</h3>
                <div class="input-group" style="margin-top: 20px;">
                    <label>Select Duration</label>
                    <div class="plan-select" id="cyclePlanSelect">
                        <div class="plan-opt selected" data-plan="0"><b>100.5%</b> Cycle 1 Hari</div>
                        <div class="plan-opt" data-plan="1"><b>105%</b> Cycle 7 Hari</div>
                        <div class="plan-opt" data-plan="2"><b>110%</b> Cycle 14 Hari</div>
                        <div class="plan-opt" data-plan="3"><b>125%</b> Cycle 30 Hari</div>
                    </div>
                </div>
                <div class="input-group">
                    <label>Investment Amount (USDT)</label>
                    <input type="number" class="input-box" id="cycleAmount" placeholder="Min 5 USDT">
                </div>
                <div class="input-group">
                    <label>Upline Address</label>
                    <input type="text" class="input-box" id="cycleRef" placeholder="0x...">
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="depositCycle()">
                    <i class="fas fa-check"></i> Confirm Cycle
                </button>
            </div>

            <div class="card">
                <h3>My Cycle Dashboard</h3>
                <div class="table-responsive">
                    <table id="cycleTable">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Amount</th>
                                <th>Plan</th>
                                <th>End Time</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="cycleBody">
                            <tr><td colspan="5" align="center">No active cycles</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h3>Cycle Network</h3>
                <div class="stats-grid" style="margin: 20px 0;">
                    <div class="stat-box">
                        <span class="stat-label">Total Earned</span>
                        <span class="stat-val" id="cycleEarned">0.00 USDT</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Level Achieved</span>
                        <span class="stat-val" id="cycleLevel">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Total Team</span>
                        <span class="stat-val" id="cycleTeam">0</span>
                    </div>
                </div>
                <button class="btn btn-outline" style="width: 100%;" onclick="withdrawCycleRewards()">
                    <i class="fas fa-download"></i> Withdraw Rewards
                </button>

                <h4 style="margin: 30px 0 15px;">Referral Tiers</h4>
                <div class="tier-grid">
                    <div class="tier-box">
                        <div class="tier-head">Level 1 <span>15%</span></div>
                        <div class="tier-req">Syarat: Stake Aktif 20 USDT</div>
                    </div>
                    <div class="tier-box">
                        <div class="tier-head">Level 2 <span>7%</span></div>
                        <div class="tier-req">Syarat: 1 Downline Lvl 1 Stake 20 USDT</div>
                    </div>
                    <div class="tier-box">
                        <div class="tier-head">Level 3 <span>2%</span></div>
                        <div class="tier-req">Syarat: 3 Downline Lvl 1 Stake 20 USDT</div>
                    </div>
                    <div class="tier-box">
                        <div class="tier-head">Level 4 <span>1%</span></div>
                        <div class="tier-req">Syarat: 5 Downline Lvl 1 Stake 20 USDT</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Cycle Mechanics</h3>
                <div style="font-size: 0.95rem; color: var(--text-muted);">
                    <p>Cycle Investment bekerja dengan mengunci dana anda selama durasi pilihan. Keuntungan dihitung dari modal anda.</p>
                    <p style="margin-top:10px;"><b>Contoh Investasi 1000 USDT (Cycle 30 Hari - 125%):</b></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Total yang anda terima: 1250 USDT (Modal + 25% Profit)</li>
                        <li>Referral dihitung dari PROFIT (250 USDT):</li>
                        <li>Upline Lvl 1 anda menerima 15% dari profit = 37.5 USDT</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Saving Section -->
        <section id="saving">
            <div class="hero" style="margin-bottom: 40px;">
                <h1>Saving <span class="gradient-text">Investment</span></h1>
                <p>Dynamic daily yields with flexible capital withdrawal options</p>
            </div>

            <div class="card">
                <h3>Start Saving</h3>
                <div class="input-group" style="margin-top: 20px;">
                    <label>Investment Amount (USDT)</label>
                    <input type="number" class="input-box" id="savingAmount" placeholder="Min 5 USDT">
                </div>
                <div class="input-group">
                    <label>Upline Address</label>
                    <input type="text" class="input-box" id="savingRef" placeholder="0x...">
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="depositSaving()">
                    <i class="fas fa-check"></i> Confirm Saving
                </button>
            </div>

            <div class="card">
                <h3>My Saving Dashboard</h3>
                <div class="table-responsive">
                    <table id="savingTable">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Amount</th>
                                <th>Daily ROI</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="savingBody">
                            <tr><td colspan="4" align="center">No active saving</td></tr>
                        </tbody>
                    </table>
                </div>
                <button class="btn btn-outline" style="width:100%; margin-top: 20px;" onclick="claimSaving()">
                    <i class="fas fa-coins"></i> Claim All Daily ROI
                </button>
            </div>

            <div class="card">
                <h3>Saving Network</h3>
                <div class="stats-grid" style="margin: 20px 0;">
                    <div class="stat-box">
                        <span class="stat-label">Total Earned</span>
                        <span class="stat-val" id="savingEarned">0.00 USDT</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Level Achieved</span>
                        <span class="stat-val" id="savingLevel">0</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Total Team</span>
                        <span class="stat-val" id="savingTeam">0</span>
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 15px;">Saving Referral Tiers</h4>
                <div class="tier-grid">
                    <div class="tier-box"><div class="tier-head">Lvl 1 <span>20%</span></div><div class="tier-req">Req: 10 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 2 <span>15%</span></div><div class="tier-req">Req: 20 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 3 <span>8%</span></div><div class="tier-req">Req: 30 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 4 <span>4%</span></div><div class="tier-req">Req: 40 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 5 <span>2%</span></div><div class="tier-req">Req: 50 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 6 <span>2%</span></div><div class="tier-req">Req: 60 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 7 <span>1%</span></div><div class="tier-req">Req: 70 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 8 <span>1%</span></div><div class="tier-req">Req: 80 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 9 <span>1%</span></div><div class="tier-req">Req: 90 USDT Stake</div></div>
                    <div class="tier-box"><div class="tier-head">Lvl 10 <span>1%</span></div><div class="tier-req">Req: 100 USDT Stake</div></div>
                </div>
            </div>

            <div class="card">
                <h3>Saving Mechanics</h3>
                <div style="font-size: 0.95rem; color: var(--text-muted);">
                    <p>Saving Investment memberikan yield harian dinamis (0.3% - 0.8%) tergantung performa pool mingguan. Modal fleksibel dapat ditarik.</p>
                    <p style="margin-top:10px;"><b>Contoh Investasi 1000 USDT:</b></p>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Harian (asumsi 0.5%): 5 USDT/hari.</li>
                        <li>Referral dihitung dari ROI yang diklaim (5 USDT):</li>
                        <li>Upline Lvl 1 menerima 20% dari ROI = 1 USDT/hari</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Whitepaper & Audit Section (Simplified for HTML structure) -->
        <section id="whitepaper">
            <div class="card">
                <h1 class="gradient-text">Auvex Protocol Whitepaper</h1>
                <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 20px;">
                    <h3>1. Pendahuluan</h3>
                    <p>Auvex Protocol merupakan sebuah protokol DeFi berbasis smart contract... (Isi sesuai instruksi anda)</p>
                    <h3 style="margin-top:20px;">2. Arsitektur Umum</h3>
                    <p>Protokol beroperasi di atas token ERC-20 (USDT) dan mengelola dana secara on-chain...</p>
                    <h3 style="margin-top:20px;">3. Mekanisme Investasi</h3>
                    <p>Cycle Investment (Fixed) dan Saving Investment (Dynamic Yield)...</p>
                    <p>(Lanjutkan semua poin whitepaper yang anda berikan di sini)</p>
                </div>
            </div>
        </section>

        <section id="audit">
            <div class="card">
                <h1 class="gradient-text">Smart Contract Audit Report</h1>
                <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
                    <p><b>Status:</b> ✅ PASSED – FULLY CORRECT</p>
                    <p style="margin-top:10px;">Audit ini mengevaluasi keamanan, determinisme, dan konsistensi Auvex Protocol.</p>
                    <h3 style="margin-top:20px;">Executive Summary</h3>
                    <p>Kontrak diimplementasikan dengan logika yang benar tanpa isu kritikal...</p>
                    <h3 style="margin-top:20px;">Security Controls</h3>
                    <p>Perlindungan Reentrancy (nonReentrant), Keamanan Aritmatika (Solidity 0.8.33), dan State Integrity terjamin.</p>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq">
            <h1 style="text-align: center; margin-bottom: 40px;">Frequently Asked <span class="gradient-text">Questions</span></h1>
            <div id="faqList">
                <!-- FAQ Items based on your list -->
                <div class="faq-item">
                    <div class="faq-q">Apa itu Auvex Protocol? <i class="fas fa-chevron-down"></i></div>
                    <div class="faq-a">Auvex Protocol adalah platform DeFi berbasis smart contract yang menyediakan mekanisme investasi terstruktur melalui Cycle, Saving, dan Referral...</div>
                </div>
                <div class="faq-item">
                    <div class="faq-q">Apakah Auvex Protocol non-custodial? <i class="fas fa-chevron-down"></i></div>
                    <div class="faq-a">Ya. Semua dana dikelola langsung oleh smart contract, bukan oleh individu atau pihak terpusat. Pengguna memiliki kontrol penuh.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-q">Apakah smart contract Auvex sudah diaudit? <i class="fas fa-chevron-down"></i></div>
                    <div class="faq-a">Ya. Smart contract Auvex telah melalui manual audit komprehensif dan dinyatakan PASSED – Fully Correct.</div>
                </div>
                <!-- Tambahkan sisa 12 FAQ anda di sini dengan struktur yang sama -->
            </div>
        </section>
    </main>

    <!-- Modal Regrow -->
    <div class="modal" id="regrowModal">
        <div class="modal-content">
            <h3>Regrow Cycle</h3>
            <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 20px;">Select new duration for your reinvestment</p>
            <div class="plan-select" id="regrowPlanSelect">
                <div class="plan-opt selected" data-plan="0">1 Hari</div>
                <div class="plan-opt" data-plan="1">7 Hari</div>
                <div class="plan-opt" data-plan="2">14 Hari</div>
                <div class="plan-opt" data-plan="3">30 Hari</div>
            </div>
            <input type="hidden" id="regrowTargetId">
            <button class="btn btn-primary" style="width: 100%;" onclick="executeRegrow()">Confirm Regrow</button>
            <button class="btn btn-outline" style="width: 100%; margin-top: 10px;" onclick="closeModal('regrowModal')">Cancel</button>
        </div>
    </div>

    <!-- Script Section -->
    <script>
        const CONTRACT_ADDR = "0x7F33CbE48a617192c9A8AA490708BF547f1488AD";
        const USDT_ADDR = "0x55d398326f99059fF775485246999027B3197955";
        const ABI = [{"inputs":[{"internalType":"address","name":"_usdtAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"CapitalWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"profit","type":"uint256"}],"name":"CycleClaimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"planType","type":"uint8"},{"indexed":false,"internalType":"address","name":"referrer","type":"address"}],"name":"NewDeposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"}],"name":"OwnershipRenounced","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newBalance","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"changePercent","type":"uint256"}],"name":"PoolAdjusted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"referrer","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"planType","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"}],"name":"ReferralRewardPaid","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"oldCycleId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newCycleId","type":"uint256"}],"name":"RegrowExecuted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"SavingClaimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ScorchReferralWithdrawn","type":"event"},{"inputs":[],"name":"ADMIN_FEE_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ADMIN_FICTITIOUS_DEPOSIT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ADMIN_REWARD_INTERVAL","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ADMIN_WALLET","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_DURATIONS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_REF_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_REF_REQUIREMENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MIN_DEPOSIT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SAVING_ADJUSTMENT_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SAVING_MAX_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SAVING_MIN_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"SAVING_REF_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"SAVING_REF_REQUIREMENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"TIME_STEP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"adminAccumulatedRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"adminLastRewardTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"savingId","type":"uint256"}],"name":"capitalSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"claimCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"claimSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"contractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"cycleInvestments","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"plan","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"bool","name":"claimed","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint8","name":"plan","type":"uint8"},{"internalType":"address","name":"referrer","type":"address"}],"name":"depositCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"referrer","type":"address"}],"name":"depositSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"downlines","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getContractStats","outputs":[{"internalType":"uint256","name":"totalInvested_","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn_","type":"uint256"},{"internalType":"uint256","name":"totalUsers_","type":"uint256"},{"internalType":"uint256","name":"contractBalance_","type":"uint256"},{"internalType":"uint256","name":"poolBalance_","type":"uint256"},{"internalType":"uint256","name":"scorchPool_","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"getCycleDetails","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"plan","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"},{"internalType":"uint256","name":"profit","type":"uint256"},{"internalType":"bool","name":"claimed","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"getCycleProfitDetails","outputs":[{"internalType":"uint256","name":"profitPer8Hours","type":"uint256"},{"internalType":"uint256","name":"timeLeft","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"savingId","type":"uint256"}],"name":"getSavingDetails","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"currentPercent","type":"uint256"},{"internalType":"uint256","name":"dailyReward","type":"uint256"},{"internalType":"bool","name":"active","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserInfo","outputs":[{"internalType":"uint256","name":"totalInvested_","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn_","type":"uint256"},{"internalType":"uint256","name":"cycleRewards_","type":"uint256"},{"internalType":"uint256","name":"savingRewards_","type":"uint256"},{"internalType":"uint256","name":"activeInvestment_","type":"uint256"},{"internalType":"address","name":"referrer_","type":"address"},{"internalType":"uint256","name":"referrals_","type":"uint256"},{"internalType":"bool","name":"isActive_","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserInvestments","outputs":[{"internalType":"uint256","name":"activeCycles","type":"uint256"},{"internalType":"uint256","name":"activeSavings","type":"uint256"},{"internalType":"uint256","name":"totalCycles","type":"uint256"},{"internalType":"uint256","name":"totalSavings","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"isRenounced","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"poolBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"poolSnapshots","outputs":[{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"uint256","name":"poolBalance","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"qualifiedDownlineCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"},{"internalType":"uint8","name":"newPlan","type":"uint8"}],"name":"regrow","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"savingInvestments","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"currentPercent","type":"uint256"},{"internalType":"uint256","name":"lastPayout","type":"uint256"},{"internalType":"bool","name":"active","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"scorchReferralPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalInvested","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalUsers","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalWithdrawn","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"usdt","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"users","outputs":[{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256","name":"referrals","type":"uint256"},{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"cycleRewards","type":"uint256"},{"internalType":"uint256","name":"savingRewards","type":"uint256"},{"internalType":"uint256","name":"lastSavingClaim","type":"uint256"},{"internalType":"uint256","name":"activeInvestment","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdrawScorchReferral","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}];
        const ERC20_ABI = [{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"type":"function"}];

        let web3, contract, usdt, user;

        // --- Navigation Logic ---
        function showSection(id) {
            document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList?.add('active');
            document.getElementById('sideNav').classList.remove('active');
        }

        document.getElementById('menuBtn').onclick = (e) => {
            e.stopPropagation();
            document.getElementById('sideNav').classList.toggle('active');
        };

        window.onclick = () => document.getElementById('sideNav').classList.remove('active');

        // --- Core Wallet Logic ---
        async function connectWallet() {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                user = accounts[0];
                contract = new web3.eth.Contract(ABI, CONTRACT_ADDR);
                usdt = new web3.eth.Contract(ERC20_ABI, USDT_ADDR);
                
                document.getElementById('connectBtn').innerText = user.slice(0,6) + "..." + user.slice(-4);
                initData();
            } else {
                alert("Please install Metamask");
            }
        }

        async function initData() {
            if (!contract) return;
            const stats = await contract.methods.getContractStats().call();
            document.getElementById('statPool').innerText = (stats[4]/1e18).toFixed(2) + " USDT";
            document.getElementById('statUsers').innerText = stats[2] + " Active";
            document.getElementById('statInvested').innerText = (stats[0]/1e18).toFixed(2) + " USDT";
            document.getElementById('statWithdrawn').innerText = (stats[1]/1e18).toFixed(2) + " USDT";
            document.getElementById('statScorch').innerText = (stats[5]/1e18).toFixed(2) + " USDT";

            if (user) loadUserDashboard();
        }

        async function loadUserDashboard() {
            const info = await contract.methods.getUserInfo(user).call();
            const invCount = await contract.methods.getUserInvestments(user).call();

            // Cycle Dashboard
            const cycleBody = document.getElementById('cycleBody');
            cycleBody.innerHTML = "";
            for(let i=0; i < invCount[2]; i++) {
                const d = await contract.methods.getCycleDetails(user, i).call();
                const row = `<tr>
                    <td>${d.claimed ? 'Claimed' : (Date.now()/1000 > d.endTime ? 'Mature' : 'Active')}</td>
                    <td>${(d.amount/1e18).toFixed(2)}</td>
                    <td>${['1 Hari','7 Hari','14 Hari','30 Hari'][d.plan]}</td>
                    <td>${new Date(d.endTime * 1000).toLocaleDateString()}</td>
                    <td>
                        ${!d.claimed && Date.now()/1000 > d.endTime ? 
                        `<button class="btn btn-primary btn-sm" onclick="claimCycle(${i})">Withdraw</button>
                         <button class="btn btn-outline btn-sm" onclick="openRegrow(${i})">Regrow</button>` : '-'}
                    </td>
                </tr>`;
                cycleBody.innerHTML += row;
            }

            // Saving Dashboard
            const savingBody = document.getElementById('savingBody');
            savingBody.innerHTML = "";
            for(let i=0; i < invCount[3]; i++) {
                const s = await contract.methods.getSavingDetails(user, i).call();
                if(!s.active) continue;
                const row = `<tr>
                    <td>Active</td>
                    <td>${(s.amount/1e18).toFixed(2)}</td>
                    <td>${(s.currentPercent/100).toFixed(2)}%</td>
                    <td><button class="btn btn-outline btn-sm" onclick="capitalSaving(${i})">Exit Capital</button></td>
                </tr>`;
                savingBody.innerHTML += row;
            }

            // Referral Updates
            document.getElementById('cycleEarned').innerText = (info[2]/1e18).toFixed(2) + " USDT";
            document.getElementById('savingEarned').innerText = (info[3]/1e18).toFixed(2) + " USDT";
            document.getElementById('cycleTeam').innerText = info[6];
            document.getElementById('savingTeam').innerText = info[6];
        }

        // --- Transaction Logic ---
        async function depositCycle() {
            const amount = document.getElementById('cycleAmount').value;
            const plan = document.querySelector('#cyclePlanSelect .selected').dataset.plan;
            let ref = document.getElementById('cycleRef').value || "0x0000000000000000000000000000000000000000";

            if (amount < 5) return alert("Minimum 5 USDT");
            
            const amWei = web3.utils.toWei(amount, 'ether');
            await usdt.methods.approve(CONTRACT_ADDR, amWei).send({from: user});
            await contract.methods.depositCycle(amWei, plan, ref).send({from: user});
            alert("Deposit Successful!");
            loadUserDashboard();
        }

        async function depositSaving() {
            const amount = document.getElementById('savingAmount').value;
            let ref = document.getElementById('savingRef').value || "0x0000000000000000000000000000000000000000";
            if (amount < 5) return alert("Minimum 5 USDT");
            
            const amWei = web3.utils.toWei(amount, 'ether');
            await usdt.methods.approve(CONTRACT_ADDR, amWei).send({from: user});
            await contract.methods.depositSaving(amWei, ref).send({from: user});
            alert("Saving Deposit Successful!");
            loadUserDashboard();
        }

        async function claimCycle(id) { await contract.methods.claimCycle(id).send({from: user}); loadUserDashboard(); }
        async function claimSaving() { await contract.methods.claimSaving().send({from: user}); loadUserDashboard(); }
        async function capitalSaving(id) { await contract.methods.capitalSaving(id).send({from: user}); loadUserDashboard(); }

        // --- Regrow Logic ---
        function openRegrow(id) {
            document.getElementById('regrowTargetId').value = id;
            document.getElementById('regrowModal').classList.add('active');
        }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }
        async function executeRegrow() {
            const id = document.getElementById('regrowTargetId').value;
            const plan = document.querySelector('#regrowPlanSelect .selected').dataset.plan;
            await contract.methods.regrow(id, plan).send({from: user});
            closeModal('regrowModal');
            loadUserDashboard();
        }

        // UI Interactions
        document.querySelectorAll('.plan-opt').forEach(opt => {
            opt.onclick = () => {
                const parent = opt.parentElement;
                parent.querySelectorAll('.plan-opt').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
            };
        });

        document.querySelectorAll('.faq-q').forEach(q => {
            q.onclick = () => q.parentElement.classList.toggle('active');
        });

        // Referral Link in URL
        const urlParams = new URLSearchParams(window.location.search);
        if(urlParams.get('ref')) {
            document.getElementById('cycleRef').value = urlParams.get('ref');
            document.getElementById('savingRef').value = urlParams.get('ref');
        }

        setInterval(initData, 30000);
        window.onload = initData;
    </script>
</body>
</html>
