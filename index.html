<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auvex Protocol - Autonomous Wealth Automation</title>
    <meta name="description" content="Decentralized asset management via secure algorithmic cycles and liquid savings on Binance Smart Chain">
    <link rel="icon" type="image/x-icon" href="image/logo.png">
    
    <!-- Font & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bignumber.js@9.1.2/bignumber.min.js"></script>

    <style>
        /* ===== VARIABLES ===== */
        :root {
            /* Premium Purple & Dark Theme */
            --bg-deep: #0A0A0F; /* Dark Base (70%) */
            --bg-card: #1A1A24; /* Mid Tone (20%) */
            --bg-card-hover: #232330;
            
            --primary-accent: #8A2BE2; /* Premium Purple */
            --secondary-accent: #9370DB; /* Secondary Purple */
            --highlight-accent: #D8BFD8; /* Luxury Highlight (10%) */
            --text-accent: #E6E6FA; /* Light Lavender */
            
            --text-main: #ffffff;
            --text-muted: #B0B0C0;
            --text-dark: #0A0A0F;

            --gradient-main: linear-gradient(135deg, #8A2BE2 0%, #9370DB 50%, #D8BFD8 100%);
            --gradient-dark: linear-gradient(135deg, #0A0A0F 0%, #1A1A24 100%);
            --gradient-card: linear-gradient(145deg, #1A1A24 0%, #232330 100%);
            --gradient-neon: linear-gradient(135deg, #8A2BE2 0%, #BA55D3 25%, #9370DB 50%, #D8BFD8 75%, #E6E6FA 100%);
            
            --glass-border: 1px solid rgba(138, 43, 226, 0.3);
            --glass-shine: 1px solid rgba(216, 191, 216, 0.2);
            
            --shadow-subtle: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
            --shadow-card: 0 12px 40px 0 rgba(0, 0, 0, 0.4);
            --shadow-elevated: 0 20px 60px rgba(0, 0, 0, 0.6);
            --shadow-deep: 0 0 40px rgba(138, 43, 226, 0.2);
            --shadow-glow: 0 0 20px rgba(138, 43, 226, 0.1);
            --shadow-neon: 0 0 30px rgba(138, 43, 226, 0.3);

            /* Typography */
            --font-body: 'Outfit', sans-serif;
            --font-heading: 'Space Grotesk', sans-serif;

            /* Spacing & Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --radius-full: 50px;
            
            --container-width: 1200px;
            --header-height: 75px;
        }

        /* ===== RESET & BASE ===== */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            outline: none; 
            -webkit-tap-highlight-color: transparent; 
        }

        html { 
            scroll-behavior: smooth; 
            font-size: 14px;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-deep);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(138, 43, 226, 0.08) 0%, transparent 35%),
                radial-gradient(circle at 90% 80%, rgba(216, 191, 216, 0.05) 0%, transparent 35%),
                linear-gradient(135deg, rgba(10, 10, 15, 0.95) 0%, rgba(26, 26, 36, 0.98) 100%);
            background-attachment: fixed;
            color: var(--text-main);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Glassmorphism Effects */
        .glass-card {
            background: linear-gradient(145deg, rgba(26, 26, 36, 0.7), rgba(10, 10, 15, 0.5));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-card), var(--shadow-glow);
        }

        /* Neon Glow Animations */
        @keyframes glow-pulse {
            0%, 100% { box-shadow: var(--shadow-glow); }
            50% { box-shadow: var(--shadow-neon); }
        }

        .neon-glow {
            animation: glow-pulse 3s ease-in-out infinite;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-deep); }
        ::-webkit-scrollbar-thumb { 
            background: var(--gradient-main); 
            border-radius: 4px;
            border: 1px solid var(--bg-deep);
        }
        ::-webkit-scrollbar-thumb:hover { 
            background: var(--secondary-accent); 
        }

        /* Container */
        .container {
            max-width: var(--container-width);
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Typography */
        h1, h2, h3, h4 { 
            font-family: var(--font-heading); 
            color: var(--text-main); 
            line-height: 1.3; 
            letter-spacing: -0.3px;
        }

        .gradient-text {
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: inline-block;
            font-weight: 700;
        }

        .auvex-headline {
            font-family: var(--font-heading);
            font-size: 2.4rem;
            font-weight: 700;
            background: var(--gradient-neon);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
            margin-bottom: 1.2rem;
        }

        .auvex-subheadline {
            font-family: var(--font-body);
            font-size: 1rem;
            color: var(--text-muted);
            font-weight: 300;
            letter-spacing: 0.3px;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
            margin-bottom: 30px !important;
        }

        /* ===== PRELOADER ===== */
        .preloader {
            position: fixed; 
            inset: 0;
            background: linear-gradient(135deg, #0A0A0F 0%, #1A1A24 100%);
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            z-index: 9999;
            transition: opacity 0.6s ease, visibility 0.6s ease;
        }
        .preloader.fade-out { 
            opacity: 0; 
            visibility: hidden; 
        }

        .loader-container {
            position: relative;
            width: 140px;
            height: 140px;
            margin-bottom: 20px;
        }

        .loader {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px solid transparent;
            border-top: 3px solid var(--primary-accent);
            border-right: 3px solid var(--secondary-accent);
            border-bottom: 3px solid var(--highlight-accent);
            animation: spin 1.5s linear infinite;
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.2);
        }

        .loader-inner {
            position: absolute;
            top: 12px;
            left: 12px;
            right: 12px;
            bottom: 12px;
            border-radius: 50%;
            border: 2px solid transparent;
            border-top: 2px solid var(--secondary-accent);
            border-right: 2px solid var(--highlight-accent);
            animation: spin-reverse 1s linear infinite;
        }

        .loader-core {
            position: absolute;
            top: 35px;
            left: 35px;
            right: 35px;
            bottom: 35px;
            border-radius: 50%;
            background: var(--gradient-main);
            animation: pulse-core 2s ease-in-out infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.3);
        }

        .loader-logo {
            width: 45px;
            height: 45px;
            object-fit: contain;
            filter: brightness(1.2);
            animation: pulse-logo 3s ease-in-out infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes spin-reverse {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-360deg); }
        }

        @keyframes pulse-core {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
        }

        @keyframes pulse-logo {
            0%, 100% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        .preloader-text { 
            font-family: var(--font-heading); 
            font-size: 1.8rem; 
            letter-spacing: 3px; 
            font-weight: 700; 
            color: transparent;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 30px rgba(138, 43, 226, 0.3);
            margin-top: 15px;
        }

        /* ===== HEADER & NAVIGATION ===== */
        .header {
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0;
            height: var(--header-height);
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
            z-index: 1000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .header.scrolled {
            height: 65px;
            background: rgba(10, 10, 15, 0.98);
            border-bottom: 1px solid rgba(138, 43, 226, 0.3);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }

        .nav { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            height: 100%; 
        }

        .nav__logo { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            text-decoration: none; 
            transition: transform 0.3s ease;
        }
        .nav__logo:hover { 
            transform: translateY(-1px); 
        }
        .logo { 
            width: 36px;
            height: 36px;
            transition: all 0.4s ease; 
            filter: brightness(1.1);
        }
        .nav__logo:hover .logo { 
            transform: rotate(15deg) scale(1.05); 
        }
        .logo__text { 
            font-size: 1.2rem;
            font-weight: 700; 
            letter-spacing: 1.2px; 
            color: transparent;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            background-clip: text;
            font-family: var(--font-heading); 
        }

        .nav__menu { 
            display: flex; 
            align-items: center; 
            gap: 25px;
        }
        .nav__list { 
            display: flex; 
            list-style: none; 
            gap: 25px;
        }

        .nav__link {
            color: var(--text-muted);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            padding: 5px 0;
            letter-spacing: 0.3px;
        }
        .nav__link:hover, 
        .nav__link.active { 
            color: var(--text-accent); 
        }
        .nav__link::after {
            content: ''; 
            position: absolute; 
            bottom: 0; 
            left: 0;
            width: 0; 
            height: 2px; 
            background: var(--gradient-main);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            border-radius: 1px;
        }
        .nav__link:hover::after, 
        .nav__link.active::after { 
            width: 100%; 
        }

        /* Hamburger Menu */
        .nav__toggle { 
            display: none; 
            font-size: 1.3rem;
            color: var(--text-accent); 
            cursor: pointer; 
            padding: 7px;
            background: rgba(138, 43, 226, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(138, 43, 226, 0.2);
            transition: all 0.3s ease;
            z-index: 1001;
        }
        .nav__toggle:hover { 
            background: rgba(138, 43, 226, 0.2);
            border-color: var(--primary-accent);
            transform: rotate(90deg);
        }

        .mobile-menu {
            position: fixed;
            top: var(--header-height);
            right: -100%;
            width: 280px;
            height: calc(100vh - var(--header-height));
            background: rgba(26, 26, 36, 0.98);
            backdrop-filter: blur(25px);
            border-left: 1px solid rgba(138, 43, 226, 0.3);
            padding: 20px;
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            overflow-y: auto;
            box-shadow: -8px 0 30px rgba(0, 0, 0, 0.6);
        }

        .mobile-menu.active {
            right: 0;
        }

        .mobile-menu ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .mobile-menu a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.95rem;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-radius: var(--radius-lg);
            transition: all 0.3s ease;
            border: 1px solid transparent;
            background: rgba(138, 43, 226, 0.05);
        }

        .mobile-menu a i {
            width: 18px;
            text-align: center;
            color: var(--secondary-accent);
            font-size: 1rem;
        }

        .mobile-menu a:hover,
        .mobile-menu a.active {
            background: rgba(138, 43, 226, 0.15);
            color: var(--text-accent);
            transform: translateX(8px);
            border: 1px solid rgba(138, 43, 226, 0.3);
            box-shadow: 0 4px 12px rgba(138, 43, 226, 0.2);
        }

        /* Wallet Button */
        #connectWallet {
            margin-left: 10px;
        }

        /* ===== BUTTONS ===== */
        .btn {
            display: inline-flex; 
            align-items: center; 
            justify-content: center; 
            gap: 8px;
            padding: 10px 24px;
            border-radius: var(--radius-full);
            font-weight: 600; 
            font-size: 0.85rem;
            font-family: var(--font-body);
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none; 
            position: relative; 
            overflow: hidden; 
            border: none;
            letter-spacing: 0.3px;
            white-space: nowrap;
        }

        .btn--primary {
            background: var(--gradient-main);
            color: white;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
        }
        .btn--primary:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(138, 43, 226, 0.4);
        }

        .btn--outline {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(138, 43, 226, 0.3);
            color: var(--text-main);
            backdrop-filter: blur(10px);
        }
        .btn--outline:hover {
            background: rgba(138, 43, 226, 0.2);
            border-color: var(--primary-accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.2);
        }

        .btn-sm { padding: 8px 18px; font-size: 0.8rem; }
        .btn-lg { padding: 12px 32px; font-size: 0.9rem; }
        .btn-xl { padding: 16px 38px; font-size: 0.95rem; font-weight: 700; }

        /* Button Loading Spinner */
        .btn .loading-spinner {
            display: none;
            animation: spin 1s linear infinite;
            margin-right: 6px;
        }

        .btn.loading {
            pointer-events: none;
            opacity: 0.8;
        }

        .btn.loading .loading-spinner {
            display: inline-block;
        }

        .btn.loading .btn-text {
            margin-left: 6px;
        }

        /* ===== SECTIONS ===== */
        .section { 
            padding-top: 100px;
            padding-bottom: 70px;
            min-height: 100vh;
            display: flex; 
            flex-direction: column;
            justify-content: flex-start;
        }

        .section__header { 
            text-align: center; 
            margin-bottom: 50px;
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
            position: relative;
        }

        .section__title {
            font-size: 2.2rem;
            margin-bottom: 15px;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-accent), var(--text-accent));
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
            text-shadow: 0 8px 25px rgba(138, 43, 226, 0.2);
        }

        .section__subtitle { 
            color: var(--text-muted); 
            font-size: 1rem;
            margin-bottom: 10px;
            line-height: 1.6;
            font-weight: 300;
        }

        /* ===== HOME SECTION ===== */
        #home { 
            padding-top: 140px;
            justify-content: center;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
        }

        #home::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(138, 43, 226, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(216, 191, 216, 0.05) 0%, transparent 40%);
            pointer-events: none;
        }

        .hero__container { 
            display: grid; 
            grid-template-columns: 1.2fr 0.8fr; 
            gap: 50px;
            align-items: center; 
        }

        .badge {
            background: rgba(138, 43, 226, 0.2); 
            border: 1px solid rgba(138, 43, 226, 0.3);
            color: var(--text-accent); 
            padding: 7px 18px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600; 
            letter-spacing: 0.3px; 
            margin-bottom: 20px;
            display: inline-block;
            backdrop-filter: blur(10px);
            box-shadow: 0 3px 12px rgba(138, 43, 226, 0.15);
        }

        .hero__title { 
            font-size: 2.4rem;
            line-height: 1.1; 
            margin-bottom: 15px;
            font-weight: 700; 
        }

        .hero__headline {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--text-accent);
        }

        .hero__description { 
            color: var(--text-muted); 
            font-size: 1rem;
            margin-bottom: 35px;
            max-width: 90%; 
            line-height: 1.6;
        }

        .hero__buttons { 
            display: flex; 
            gap: 15px;
            margin-bottom: 30px;
        }

        /* Stats Card */
        .floating-card {
            padding: 30px;
            border-radius: var(--radius-xl);
            background: var(--gradient-card);
            border: 1px solid rgba(138, 43, 226, 0.3);
            animation: float-hero 8s ease-in-out infinite;
            position: relative;
            width: 100%;
            backdrop-filter: blur(15px);
            box-shadow: var(--shadow-subtle), 0 0 30px rgba(138, 43, 226, 0.15);
        }

        @keyframes float-hero {
            0%, 100% { 
                transform: translateY(0) rotate(0deg); 
            }
            33% { 
                transform: translateY(-10px) rotate(0.5deg); 
            }
            66% { 
                transform: translateY(-20px) rotate(-0.5deg); 
            }
        }

        .card__header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.3);
        }
        .card__header h3 { 
            font-size: 1.2rem;
            font-weight: 600; 
            margin: 0;
            text-align: left;
            flex: 1;
            color: var(--text-accent);
            letter-spacing: 0.3px;
        }

        .live-indicator { 
            display: flex; 
            align-items: center; 
            gap: 5px;
            color: #00cc66; 
            font-weight: 600; 
            font-size: 0.75rem;
            white-space: nowrap;
        }
        .dot { 
            width: 7px;
            height: 7px;
            background: #00cc66; 
            border-radius: 50%; 
            animation: blink 2s infinite; 
            box-shadow: 0 0 7px #00cc66;
        }

        @keyframes blink {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.6; 
                transform: scale(0.8);
            }
        }

        .stat-item { 
            display: flex; 
            justify-content: space-between; 
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05); 
        }
        .stat-item:last-child { 
            border-bottom: none; 
        }
        .stat-item .label { 
            color: var(--text-muted); 
            font-size: 0.85rem;
        }
        .stat-item .value { 
            color: var(--text-accent); 
            font-weight: 600; 
            font-family: var(--font-heading); 
            font-size: 1.05rem;
        }

        /* ===== CYCLE & SAVING SECTIONS ===== */
        .investment-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
            margin-bottom: 50px;
        }

        .investment-form-container,
        .investment-dashboard {
            background: var(--gradient-card);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: var(--radius-xl);
            padding: 30px;
            box-shadow: var(--shadow-card), var(--shadow-glow);
            position: relative;
            overflow: hidden;
        }

        /* ROI Calculator */
        .roi-calculator {
            margin: 20px 0;
            padding: 20px;
            background: rgba(15, 15, 25, 0.5);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .roi-display {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(138, 43, 226, 0.2);
        }

        .roi-item {
            text-align: center;
        }

        .roi-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .roi-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-accent);
        }

        /* Plan Cards */
        .plan-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }

        .plan-option {
            padding: 20px;
            background: rgba(40, 40, 55, 0.8);
            border: 1px solid rgba(138, 43, 226, 0.2);
            border-radius: var(--radius-lg);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .plan-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: 0.6s;
        }

        .plan-option:hover::before {
            left: 100%;
        }

        .plan-option:hover {
            background: rgba(50, 50, 65, 0.9);
            border-color: var(--primary-accent);
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.2);
        }

        .plan-option.selected {
            background: rgba(60, 60, 75, 0.95);
            border-color: var(--primary-accent);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.3);
        }

        .plan-duration {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-accent);
            margin-bottom: 6px;
        }

        .plan-return {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Custom Dropdown */
        .custom-dropdown {
            position: relative;
            width: 100%;
        }

        .dropdown-selected {
            width: 100%; 
            padding: 14px 18px;
            border-radius: var(--radius-lg);
            background: rgba(15, 15, 25, 0.7); 
            border: 1px solid rgba(138, 43, 226, 0.3);
            color: var(--text-main); 
            font-family: var(--font-body); 
            font-size: 0.95rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 48px;
        }

        .dropdown-selected i {
            transition: transform 0.3s ease;
            color: var(--secondary-accent);
        }

        .dropdown-selected.open i {
            transform: rotate(180deg);
        }

        .dropdown-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(26, 26, 36, 0.98);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: var(--radius-lg);
            margin-top: 5px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            z-index: 100;
            backdrop-filter: blur(20px);
            overflow-y: auto;
            box-shadow: 0 8px 35px rgba(0, 0, 0, 0.5);
        }

        .dropdown-options.show {
            max-height: 320px;
        }

        .dropdown-option {
            padding: 12px 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-muted);
            border-bottom: 1px solid rgba(138, 43, 226, 0.1);
        }

        .dropdown-option:hover {
            background: rgba(138, 43, 226, 0.15);
            color: var(--text-accent);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
            text-align: left;
            width: 100%;
            position: relative;
        }

        .form-group label { 
            display: block; 
            margin-bottom: 8px;
            color: var(--text-accent); 
            font-size: 0.9rem;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .form-input {
            width: 100%; 
            padding: 14px 16px;
            border-radius: var(--radius-lg);
            background: rgba(15, 15, 25, 0.7); 
            border: 1px solid rgba(138, 43, 226, 0.3);
            color: var(--text-main); 
            font-family: var(--font-body); 
            font-size: 0.95rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .form-input:focus { 
            border-color: var(--primary-accent); 
            background: rgba(25, 25, 35, 0.8);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.2);
        }

        .form-input:disabled {
            background: rgba(25, 25, 35, 0.5);
            border-color: rgba(138, 43, 226, 0.2);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        /* Qualification Indicators */
        .qualification-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .qualification-achieved {
            background: rgba(0, 204, 102, 0.12);
            color: #00cc66;
            border: 1px solid rgba(0, 204, 102, 0.25);
        }

        .qualification-pending {
            background: rgba(255, 193, 7, 0.12);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.25);
        }

        /* Scrollable Tables for Mobile */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-radius: var(--radius-lg);
            margin: 15px 0;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        /* Active Cycles Dashboard */
        #cyclesTable {
            min-width: 550px;
        }

        #cyclesTable th:nth-child(1),
        #cyclesTable td:nth-child(1) {
            min-width: 90px;
        }
        #cyclesTable th:nth-child(2),
        #cyclesTable td:nth-child(2) {
            min-width: 90px;
        }
        #cyclesTable th:nth-child(3),
        #cyclesTable td:nth-child(3) {
            min-width: 90px;
        }
        #cyclesTable th:nth-child(4),
        #cyclesTable td:nth-child(4) {
            min-width: 130px;
        }
        #cyclesTable th:nth-child(5),
        #cyclesTable td:nth-child(5) {
            min-width: 90px;
        }

        /* Active Savings Dashboard */
        #savingsTable {
            min-width: 550px;
        }

        #savingsTable th:nth-child(1),
        #savingsTable td:nth-child(1) {
            min-width: 90px;
        }
        #savingsTable th:nth-child(2),
        #savingsTable td:nth-child(2) {
            min-width: 90px;
        }
        #savingsTable th:nth-child(3),
        #savingsTable td:nth-child(3) {
            min-width: 70px;
        }
        #savingsTable th:nth-child(4),
        #savingsTable td:nth-child(4) {
            min-width: 110px;
        }

        /* Status Badges */
        .status-badge {
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            letter-spacing: 0.3px;
        }

        .status-active {
            background: rgba(0, 204, 102, 0.12);
            color: #00cc66;
            border: 1px solid rgba(0, 204, 102, 0.25);
            box-shadow: 0 0 10px rgba(0, 204, 102, 0.15);
        }

        .status-ready {
            background: rgba(230, 230, 250, 0.12);
            color: var(--text-accent);
            border: 1px solid rgba(230, 230, 250, 0.25);
            box-shadow: 0 0 10px rgba(230, 230, 250, 0.15);
        }

        .status-exp {
            background: rgba(255, 68, 68, 0.12);
            color: #ff4444;
            border: 1px solid rgba(255, 68, 68, 0.25);
        }

        /* Timer */
        .timer {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: var(--text-accent);
            font-size: 0.85rem;
        }

        /* Referral Link Box */
        .referral-link-box {
            background: rgba(15, 15, 25, 0.5);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: var(--radius-lg);
            padding: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
        }

        .referral-link {
            flex: 1;
            padding: 8px 14px;
            background: rgba(26, 26, 36, 0.5);
            border-radius: var(--radius-md);
            color: var(--text-muted);
            font-family: monospace;
            font-size: 0.85rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .copy-btn {
            padding: 8px 16px;
            background: var(--gradient-main);
            border: none;
            border-radius: var(--radius-md);
            color: white;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(138, 43, 226, 0.2);
        }

        /* Investment Tables */
        .investment-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(15, 15, 25, 0.5);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .investment-table th {
            background: linear-gradient(90deg, rgba(138, 43, 226, 0.2), rgba(147, 112, 219, 0.15));
            color: var(--text-accent);
            padding: 16px 14px;
            text-align: left;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            border-bottom: 2px solid rgba(138, 43, 226, 0.3);
        }

        .investment-table td {
            padding: 16px 14px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.15);
            color: var(--text-muted);
            font-size: 0.9rem;
            vertical-align: middle;
        }

        .investment-table tr:hover {
            background: rgba(138, 43, 226, 0.08);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        /* Referral Levels */
        .referral-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 25px;
        }

        .referral-level {
            background: var(--gradient-card);
            border: 1px solid rgba(138, 43, 226, 0.2);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .referral-level:hover {
            background: linear-gradient(145deg, #232330, #1A1A24);
            border-color: var(--primary-accent);
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.2);
        }

        .level-number {
            width: 36px;
            height: 36px;
            background: var(--gradient-main);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 700;
            color: white;
            font-size: 1rem;
            box-shadow: 0 4px 12px rgba(138, 43, 226, 0.2);
        }

        .level-percent {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-accent);
            margin-bottom: 6px;
            text-shadow: 0 0 12px rgba(230, 230, 250, 0.2);
        }

        .level-requirement {
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.4;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 35px;
        }

        .stat-card {
            background: var(--gradient-card);
            border: 1px solid rgba(138, 43, 226, 0.2);
            border-radius: var(--radius-lg);
            padding: 22px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary-accent);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.2);
        }

        .stat-icon {
            width: 45px;
            height: 45px;
            background: rgba(138, 43, 226, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            color: var(--primary-accent);
            font-size: 1.4rem;
            border: 1px solid rgba(138, 43, 226, 0.3);
        }

        .stat-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--text-accent);
            margin-bottom: 6px;
            text-shadow: 0 0 12px rgba(230, 230, 250, 0.2);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* ===== FAQ SECTION ===== */
        .faq-container {
            max-width: 850px;
            margin: 0 auto;
        }

        .faq-item {
            background: var(--gradient-card);
            border: 1px solid rgba(138, 43, 226, 0.2);
            border-radius: var(--radius-lg);
            margin-bottom: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            border-color: var(--primary-accent);
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.15);
        }

        .faq-question {
            padding: 20px 22px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(138, 43, 226, 0.05);
            transition: all 0.3s ease;
        }

        .faq-question:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .faq-question h3 {
            font-size: 1rem;
            color: var(--text-accent);
            margin: 0;
            flex: 1;
        }

        .faq-icon {
            color: var(--secondary-accent);
            transition: transform 0.3s ease;
            font-size: 1rem;
        }

        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }

        .faq-answer {
            padding: 0 22px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
            background: rgba(15, 15, 25, 0.4);
        }

        .faq-item.active .faq-answer {
            padding: 20px 22px;
            max-height: 500px;
        }

        .faq-answer p {
            color: var(--text-muted);
            line-height: 1.6;
            margin: 0;
        }

        /* ===== POPUP MODALS ===== */
        .popup-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .popup-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--gradient-card);
            border: 1px solid rgba(138, 43, 226, 0.3);
            border-radius: var(--radius-xl);
            padding: 35px;
            width: 90%;
            max-width: 480px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.8) translateY(40px);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-elevated);
        }

        .popup-modal.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-title {
            color: var(--text-accent);
            font-size: 1.5rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .cycle-list {
            max-height: 280px;
            overflow-y: auto;
            margin: 15px 0;
            border-radius: var(--radius-lg);
            border: 1px solid rgba(138, 43, 226, 0.2);
            background: rgba(15, 15, 25, 0.5);
        }

        .cycle-item {
            padding: 14px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cycle-item:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .cycle-item.selected {
            background: rgba(138, 43, 226, 0.15);
            border-left: 3px solid var(--primary-accent);
        }

        .cycle-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cycle-amount {
            font-weight: 600;
            color: var(--text-accent);
            font-size: 1rem;
        }

        .cycle-plan {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .no-cycles {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
        }

        /* ===== ALERTS & NOTIFICATIONS ===== */
        .alert {
            padding: 18px;
            border-radius: var(--radius-lg); 
            display: flex; 
            align-items: center; 
            gap: 12px;
            margin: 0 auto 25px;
            font-size: 0.95rem;
            background: var(--gradient-card);
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(15px);
            width: 100%;
            max-width: 800px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        .alert-warning { 
            background: linear-gradient(145deg, rgba(245, 158, 11, 0.15), rgba(138, 43, 226, 0.1));
            border-color: rgba(245, 158, 11, 0.3); 
            color: #fbbf24; 
        }
        .alert-info { 
            background: linear-gradient(145deg, rgba(138, 43, 226, 0.15), rgba(216, 191, 216, 0.1));
            border-color: rgba(138, 43, 226, 0.3); 
            color: var(--text-accent); 
        }
        .alert-success { 
            background: linear-gradient(145deg, rgba(0, 204, 102, 0.15), rgba(138, 43, 226, 0.1));
            border-color: rgba(0, 204, 102, 0.3); 
            color: #00cc66; 
        }

        /* Premium Notifications */
        .notification {
            position: fixed; 
            top: 90px;
            right: 20px; 
            padding: 16px 22px;
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.15), rgba(216, 191, 216, 0.1), rgba(147, 112, 219, 0.07));
            border: 1px solid rgba(138, 43, 226, 0.4);
            color: white; 
            border-radius: var(--radius-lg); 
            z-index: 3000;
            transform: translateX(120%) scale(0.9); 
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(20px); 
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: flex; 
            align-items: center; 
            gap: 12px;
            max-width: 320px;
            word-break: break-word;
            min-width: 260px;
            border-left: 4px solid var(--primary-accent);
        }
        .notification.show { 
            transform: translateX(0) scale(1); 
        }
        .notification.success { 
            border-left: 4px solid #00cc66;
        }
        .notification.error { 
            border-left: 4px solid #ff4444;
        }
        .notification.info { 
            border-left: 4px solid var(--primary-accent);
        }

        /* ===== POPUPS ===== */
        .popup {
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(15px); 
            z-index: 2000;
            display: flex; 
            justify-content: center; 
            align-items: center;
            opacity: 0; 
            visibility: hidden; 
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .popup.active { 
            opacity: 1; 
            visibility: visible; 
        }

        .popup-content { 
            max-width: 480px;
            width: 90%; 
            padding: 35px;
            text-align: center; 
            transform: scale(0.8) translateY(40px); 
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            background: var(--gradient-card);
            border: 1px solid var(--primary-accent);
            border-radius: var(--radius-xl);
            cursor: default;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-elevated);
        }
        .popup.active .popup-content { 
            transform: scale(1) translateY(0); 
        }

        .popup-icon {
            width: 70px;
            height: 70px;
            background: var(--gradient-main); 
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.8rem;
            color: white;
            margin: 0 auto 20px;
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.3);
        }

        /* ===== FOOTER ===== */
        .footer { 
            border-top: 1px solid rgba(138, 43, 226, 0.2); 
            padding: 70px 0 25px;
            background: linear-gradient(180deg, #0A0A0F 0%, #1A1A24 100%);
            margin-top: auto; 
            position: relative;
            overflow: hidden;
        }

        .footer__content {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .footer__logo { 
            display: flex; 
            align-items: center; 
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center; 
        }
        .footer__logo img { 
            width: 32px;
            height: 32px;
        }
        .footer__logo span { 
            font-size: 1.4rem;
            font-weight: 700; 
            font-family: var(--font-heading); 
            color: transparent;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            background-clip: text;
        }

        .footer__content p {
            color: var(--text-muted); 
            max-width: 600px; 
            margin: 0 auto 25px;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .footer__social { 
            display: flex; 
            gap: 12px;
            margin-top: 25px;
            justify-content: center; 
        }

        .social__link {
            width: 42px;
            height: 42px;
            border-radius: 10px; 
            background: var(--gradient-card);
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: var(--text-muted);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(138, 43, 226, 0.2); 
            text-decoration: none;
            font-size: 1rem;
        }
        .social__link:hover { 
            background: var(--gradient-main); 
            color: white;
            transform: translateY(-3px); 
            border-color: transparent;
            box-shadow: 0 6px 15px rgba(138, 43, 226, 0.3);
        }

        .footer__bottom { 
            margin-top: 50px;
            padding-top: 25px;
            border-top: 1px solid rgba(138, 43, 226, 0.15); 
            text-align: center; 
            color: rgba(255, 255, 255, 0.3); 
            font-size: 0.8rem;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .hero__title, .auvex-headline { font-size: 2.1rem; }
            .section__title { font-size: 2rem; }
            .hero__headline { font-size: 1.6rem; }
        }

        @media (max-width: 968px) {
            .hero__container { 
                grid-template-columns: 1fr; 
                text-align: center; 
                gap: 40px;
            }
            .hero__content { 
                display: flex; 
                flex-direction: column; 
                align-items: center; 
            }
            .hero__title, .auvex-headline { font-size: 2rem; }
            .hero__buttons { 
                justify-content: center; 
                flex-wrap: wrap; 
            }
            .investment-container {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            .plan-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .section {
                padding-top: 90px;
                padding-bottom: 50px;
            }

            .nav__menu { 
                display: none;
            }
            
            .nav__toggle { 
                display: flex; 
                align-items: center;
                justify-content: center;
            }
            
            .section__title { font-size: 1.7rem; }
            .hero__title, .auvex-headline { font-size: 1.7rem; }
            .hero__headline { font-size: 1.4rem; }
            .hero__description { font-size: 0.95rem; }
            
            .hero__buttons {
                flex-direction: column;
                width: 100%;
                max-width: 280px;
            }
            
            .hero__buttons .btn {
                width: 100%;
            }
            
            .plan-options {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons .btn {
                width: 100%;
            }
            
            .referral-levels {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .investment-table {
                display: block;
                overflow-x: auto;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .popup-content {
                padding: 25px 15px;
            }

            /* Center mobile buttons */
            .action-buttons .btn {
                width: 100%;
                justify-content: center;
            }

            /* Center referral withdraw buttons */
            #withdrawCycleReferral,
            #withdrawSavingReferral {
                margin-left: auto;
                margin-right: auto;
                display: block;
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .hero__title, .auvex-headline { font-size: 1.5rem; }
            .section__title { 
                font-size: 1.5rem;
            }
            .hero__headline { font-size: 1.2rem; }
            
            .referral-levels {
                grid-template-columns: 1fr;
            }
            
            .notification {
                min-width: 240px;
                right: 10px;
                left: 10px;
                width: auto;
            }
            
            .modal-content {
                padding: 15px 12px;
            }
            
            .popup-content {
                padding: 20px 12px;
            }
        }

        @media (max-width: 360px) {
            .hero__headline {
                font-size: 1.1rem;
            }
            
            .stat-value {
                font-size: 1.2rem;
            }
            
            .level-percent {
                font-size: 1.1rem;
            }
        }

        /* Checkbox and Radio Button Styling for Modals */
        .cycle-checkbox, .saving-radio {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(138, 43, 226, 0.4);
            border-radius: 4px;
            background: rgba(15, 15, 25, 0.7);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            appearance: none;
            -webkit-appearance: none;
        }

        .cycle-checkbox:checked, .saving-radio:checked {
            background: var(--primary-accent);
            border-color: var(--primary-accent);
        }

        .cycle-checkbox:checked::after {
            content: '';
            position: absolute;
            color: white;
            font-size: 12px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .saving-radio {
            border-radius: 50%;
        }

        .saving-radio:checked::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader">
        <div class="loader-container">
            <div class="loader"></div>
            <div class="loader-inner"></div>
            <div class="loader-core">
                <img src="image/logo.png" alt="AUVEX" class="loader-logo">
            </div>
        </div>
        <div class="preloader-text">AUVEX</div>
    </div>

    <!-- Header -->
    <header class="header">
        <nav class="nav container">
            <!-- Logo AUVEX -->
            <a href="#home" class="nav__logo">
                <img src="image/logo.png" alt="AUVEX" class="logo" onerror="this.style.display='none'; this.nextElementSibling.style.marginLeft='0'">
                <div class="logo__text">AUVEX</div>
            </a>

            <!-- Desktop Menu -->
            <div class="nav__menu">
                <ul class="nav__list">
                    <li class="nav__item"><a class="nav__link active" data-section="home">Home</a></li>
                    <li class="nav__item"><a class="nav__link" data-section="cycle">Cycle</a></li>
                    <li class="nav__item"><a class="nav__link" data-section="saving">Saving</a></li>
                    <li class="nav__item"><a class="nav__link" data-section="faq">FAQ</a></li>
                </ul>

                <button class="btn btn--primary btn-sm" id="connectWallet">
                    <i class="fas fa-wallet"></i>
                    Connect Wallet
                </button>
            </div>

            <!-- Hamburger Menu Toggle -->
            <div class="nav__toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>

            <!-- Mobile Menu -->
            <div class="mobile-menu" id="mobile-menu">
                <ul>
                    <li><a href="#home" data-section="home" class="active"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#cycle" data-section="cycle"><i class="fas fa-sync-alt"></i> Cycle</a></li>
                    <li><a href="#saving" data-section="saving"><i class="fas fa-piggy-bank"></i> Saving</a></li>
                    <li><a href="#faq" data-section="faq"><i class="fas fa-question-circle"></i> FAQ</a></li>
                    <li>
                        <button class="btn btn--primary" id="connectWalletMobile" style="width: 100%; margin-top: 15px;">
                            <i class="fas fa-wallet"></i>
                            Connect Wallet
                        </button>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Home Section -->
        <section class="section" id="home">
            <div class="container">
                <div class="hero__container">
                    <div class="hero__content">
                        <div class="badge">
                            <i class="fas fa-robot"></i> Autonomous Wealth Automation
                        </div>
                        <h1 class="auvex-headline">Where Capital Meets Code Integrity</h1>
                        <p class="auvex-subheadline">
                            Immutable smart contracts executing investments and rewards with precision, transparency and on-chain integrity
                        </p>
                        <div class="hero__buttons">
                            <button class="btn btn--primary btn-lg" data-section="cycle">
                                <i class="fas fa-sync-alt"></i>
                                Start Cycle
                            </button>
                            <button class="btn btn--outline btn-lg" data-section="saving">
                                <i class="fas fa-piggy-bank"></i>
                                Start Saving
                            </button>
                        </div>
                    </div>
                    <div class="hero__image">
                        <div class="floating-card">
                            <div class="card__header">
                                <h3>Real-Time Statistics</h3>
                                <div class="live-indicator">
                                    <span class="dot"></span>
                                    Live
                                </div>
                            </div>
                            <div class="card__content">
                                <div class="stat-item">
                                    <span class="label">Liquidity</span>
                                    <span class="value" id="statLiquidity">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Total Users</span>
                                    <span class="value" id="statTotalUsers">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Total Investment</span>
                                    <span class="value" id="statTotalInvest">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Paid Out</span>
                                    <span class="value" id="statTotalPaid">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Scorch Referral Pool</span>
                                    <span class="value" id="statScorchReferral">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Cycle Section -->
        <section class="section" id="cycle" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h1 class="auvex-headline">Cycle Investment</h1>
                    <p class="auvex-subheadline">Execute short-term yield cycles with fixed duration and guaranteed returns</p>
                </div>

                <div class="alert alert-warning" id="cycleWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet!</span>
                </div>

                <div class="investment-container" id="cycleContainer" style="display: none;">
                    <!-- Cycle Investment Form -->
                    <div class="investment-form-container">
                        <h3 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.3rem;">Start Cycle Investment</h3>
                        
                        <div class="form-group">
                            <label>Select Duration</label>
                            <div class="custom-dropdown" id="cycleDropdown">
                                <div class="dropdown-selected">
                                    <span>Select Plan</span>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="dropdown-options">
                                    <div class="dropdown-option" data-plan="0" data-min="5">
                                        <div class="plan-duration">1 Day Cycle</div>
                                        <div class="plan-return">100.3% Return</div>
                                        <small style="font-size: 0.75rem; color: var(--secondary-accent);">Min: 5 USDT</small>
                                    </div>
                                    <div class="dropdown-option" data-plan="1" data-min="10">
                                        <div class="plan-duration">7 Day Cycle</div>
                                        <div class="plan-return">103.0% Return</div>
                                        <small style="font-size: 0.75rem; color: var(--secondary-accent);">Min: 10 USDT</small>
                                    </div>
                                    <div class="dropdown-option" data-plan="2" data-min="15">
                                        <div class="plan-duration">14 Day Cycle</div>
                                        <div class="plan-return">106.0% Return</div>
                                        <small style="font-size: 0.75rem; color: var(--secondary-accent);">Min: 15 USDT</small>
                                    </div>
                                    <div class="dropdown-option" data-plan="3" data-min="20">
                                        <div class="plan-duration">30 Day Cycle</div>
                                        <div class="plan-return">112.0% Return</div>
                                        <small style="font-size: 0.75rem; color: var(--secondary-accent);">Min: 20 USDT</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cycleAmount">Amount (USDT)</label>
                            <input type="number" id="cycleAmount" class="form-input" placeholder="0.00" min="5" step="1">
                            <div class="amount-range" id="cycleAmountRange" style="font-size: 0.8rem; color: var(--text-muted); margin-top: 5px;">
                                Minimum 5 USDT
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cycleReferrer">Upline (Auto-filled)</label>
                            <input type="text" id="cycleReferrer" class="form-input" placeholder="0x..." disabled>
                            <small class="form-hint" style="color: var(--text-muted); font-size: 0.8rem; display: block; margin-top: 5px;">
                                Automatically filled from URL or previous referral
                            </small>
                        </div>

                        <!-- ROI Calculator -->
                        <div class="roi-calculator" id="cycleRoiCalculator" style="display: none;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="color: var(--text-accent); font-weight: 600;">Estimated Returns</span>
                                <span id="cycleRoiPercent" style="color: #00cc66; font-weight: 700;">0%</span>
                            </div>
                            <div class="roi-display">
                                <div class="roi-item">
                                    <div class="roi-label">Investment</div>
                                    <div class="roi-value" id="cycleRoiInvestment">0 USDT</div>
                                </div>
                                <div class="roi-item">
                                    <div class="roi-label">Profit</div>
                                    <div class="roi-value" id="cycleRoiProfit">0 USDT</div>
                                </div>
                                <div class="roi-item">
                                    <div class="roi-label">Total Return</div>
                                    <div class="roi-value" id="cycleRoiTotal">0 USDT</div>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn--primary btn-lg" id="confirmCycle" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-sync-alt"></i> 
                            <span class="btn-text">Confirm Cycle Investment</span>
                        </button>
                    </div>

                    <!-- Cycle Dashboard -->
                    <div class="investment-dashboard">
                        <h3 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.3rem;">Active Cycles Dashboard</h3>
                        
                        <div class="alert alert-info" id="noCyclesAlert" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <span>No active cycles found!</span>
                        </div>

                        <div class="table-responsive">
                            <table class="investment-table" id="cyclesTable" style="display: none;">
                                <thead>
                                    <tr>
                                        <th>Status</th>
                                        <th>Amount</th>
                                        <th>Duration</th>
                                        <th>End Time</th>
                                        <th>Total Return</th>
                                    </tr>
                                </thead>
                                <tbody id="cyclesTableBody">
                                    <!-- Cycles will be loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn--primary" id="withdrawCycle">
                                <i class="fas fa-hand-holding-usd"></i> 
                                <span class="btn-text">Withdraw Cycle</span>
                            </button>
                            <button class="btn btn--outline" id="regrowCycle">
                                <i class="fas fa-sync-alt"></i> 
                                <span class="btn-text">Regrow Cycle</span>
                            </button>
                        </div>

                        <!-- Cycle Referral Program -->
                        <div style="margin-top: 35px; padding-top: 25px; border-top: 1px solid rgba(138, 43, 226, 0.3);">
                            <h4 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.2rem;">Cycle Referral Program</h4>
                            
                            <!-- Referral Link Box -->
                            <div class="referral-link-box">
                                <div class="referral-link" id="cycleReferralLink">Connect wallet to generate link</div>
                                <button class="copy-btn" id="copyCycleReferral">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-coins"></i></div>
                                    <div class="stat-value" id="cycleTotalEarned">0 USDT</div>
                                    <div class="stat-label">Referral Earnings</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-layer-group"></i></div>
                                    <div class="stat-value" id="cycleLevelAchieved">0</div>
                                    <div class="stat-label">Qualified Levels</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                                    <div class="stat-value" id="cycleTotalTeam">0</div>
                                    <div class="stat-label">Direct Referrals</div>
                                </div>
                            </div>

                            <button class="btn btn--outline btn-lg" id="withdrawCycleReferral" style="margin-top: 20px; width: 100%;">
                                <i class="fas fa-hand-holding-usd"></i> 
                                <span class="btn-text">Withdraw Referral Rewards</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Cycle Referral Levels -->
                <div class="content-container" style="margin-top: 35px;">
                    <h3 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.3rem;">Cycle Referral Levels</h3>
                    <div class="referral-levels">
                        <div class="referral-level" id="cycleLevel1">
                            <div class="level-number">1</div>
                            <div class="level-percent">15%</div>
                            <div class="level-requirement">Requires 20 USDT active stake</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                        <div class="referral-level" id="cycleLevel2">
                            <div class="level-number">2</div>
                            <div class="level-percent">7%</div>
                            <div class="level-requirement">+1 downline at level 1</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                        <div class="referral-level" id="cycleLevel3">
                            <div class="level-number">3</div>
                            <div class="level-percent">2%</div>
                            <div class="level-requirement">+3 downlines at level 1</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                        <div class="referral-level" id="cycleLevel4">
                            <div class="level-number">4</div>
                            <div class="level-percent">1%</div>
                            <div class="level-requirement">+5 downlines at level 1</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Saving Section -->
        <section class="section" id="saving" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h1 class="auvex-headline">Saving Investment</h1>
                    <p class="auvex-subheadline">Dynamic daily yields with flexible capital withdrawal options</p>
                </div>

                <div class="alert alert-warning" id="savingWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet!</span>
                </div>

                <div class="investment-container" id="savingContainer" style="display: none;">
                    <!-- Saving Investment Form -->
                    <div class="investment-form-container">
                        <h3 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.3rem;">Start Saving Investment</h3>
                        
                        <div class="form-group">
                            <label for="savingAmount">Amount (USDT)</label>
                            <input type="number" id="savingAmount" class="form-input" placeholder="0.00" min="5" step="1">
                            <div class="amount-range" id="savingAmountRange" style="font-size: 0.8rem; color: var(--text-muted); margin-top: 5px;">
                                Minimum 5 USDT
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="savingReferrer">Upline (Auto-filled)</label>
                            <input type="text" id="savingReferrer" class="form-input" placeholder="0x..." disabled>
                            <small class="form-hint" style="color: var(--text-muted); font-size: 0.8rem; display: block; margin-top: 5px;">
                                Automatically filled from URL or previous referral
                            </small>
                        </div>

                        <!-- ROI Calculator -->
                        <div class="roi-calculator" id="savingRoiCalculator">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="color: var(--text-accent); font-weight: 600;">Daily Earnings</span>
                                <span id="savingRoiPercent" style="color: #00cc66; font-weight: 700;">0.3-0.8%</span>
                            </div>
                            <div class="roi-display">
                                <div class="roi-item">
                                    <div class="roi-label">Daily</div>
                                    <div class="roi-value" id="savingRoiDaily">0 USDT</div>
                                </div>
                                <div class="roi-item">
                                    <div class="roi-label">Weekly</div>
                                    <div class="roi-value" id="savingRoiWeekly">0 USDT</div>
                                </div>
                                <div class="roi-item">
                                    <div class="roi-label">Monthly</div>
                                    <div class="roi-value" id="savingRoiMonthly">0 USDT</div>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn--primary btn-lg" id="confirmSaving" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-piggy-bank"></i> 
                            <span class="btn-text">Confirm Saving Investment</span>
                        </button>
                    </div>

                    <!-- Saving Dashboard -->
                    <div class="investment-dashboard">
                        <h3 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.3rem;">Active Savings Dashboard</h3>
                        
                        <div class="alert alert-info" id="noSavingsAlert" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <span>No active savings found!</span>
                        </div>

                        <div class="table-responsive">
                            <table class="investment-table" id="savingsTable" style="display: none;">
                                <thead>
                                    <tr>
                                        <th>Status</th>
                                        <th>Amount</th>
                                        <th>Daily ROI</th>
                                        <th>Accumulated</th>
                                    </tr>
                                </thead>
                                <tbody id="savingsTableBody">
                                    <!-- Savings will be loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn--primary" id="withdrawSaving">
                                <i class="fas fa-hand-holding-usd"></i> 
                                <span class="btn-text">Withdraw Earnings</span>
                            </button>
                            <button class="btn btn--outline" id="withdrawCapitalSaving">
                                <i class="fas fa-university"></i> 
                                <span class="btn-text">Withdraw Capital</span>
                            </button>
                        </div>

                        <!-- Saving Referral Program -->
                        <div style="margin-top: 35px; padding-top: 25px; border-top: 1px solid rgba(138, 43, 226, 0.3);">
                            <h4 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.2rem;">Saving Referral Program</h4>
                            
                            <!-- Referral Link Box -->
                            <div class="referral-link-box">
                                <div class="referral-link" id="savingReferralLink">Connect wallet to generate link</div>
                                <button class="copy-btn" id="copySavingReferral">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-coins"></i></div>
                                    <div class="stat-value" id="savingTotalEarned">0 USDT</div>
                                    <div class="stat-label">Referral Earnings</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-layer-group"></i></div>
                                    <div class="stat-value" id="savingLevelAchieved">0</div>
                                    <div class="stat-label">Qualified Levels</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                                    <div class="stat-value" id="savingTotalTeam">0</div>
                                    <div class="stat-label">Direct Referrals</div>
                                </div>
                            </div>

                            <button class="btn btn--outline btn-lg" id="withdrawSavingReferral" style="margin-top: 20px; width: 100%;">
                                <i class="fas fa-hand-holding-usd"></i> 
                                <span class="btn-text">Withdraw Referral Rewards</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Saving Referral Levels -->
                <div class="content-container" style="margin-top: 35px;">
                    <h3 style="margin-bottom: 20px; color: var(--text-accent); font-size: 1.3rem;">Saving Referral Levels</h3>
                    <div class="referral-levels">
                        <div class="referral-level" id="savingLevel1">
                            <div class="level-number">1</div>
                            <div class="level-percent">20%</div>
                            <div class="level-requirement">10 USDT active stake</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                        <div class="referral-level" id="savingLevel2">
                            <div class="level-number">2</div>
                            <div class="level-percent">15%</div>
                            <div class="level-requirement">20 USDT active stake</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                        <div class="referral-level" id="savingLevel3">
                            <div class="level-number">3</div>
                            <div class="level-percent">8%</div>
                            <div class="level-requirement">30 USDT active stake</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                        <div class="referral-level" id="savingLevel4">
                            <div class="level-number">4</div>
                            <div class="level-percent">4%</div>
                            <div class="level-requirement">40 USDT active stake</div>
                            <div class="qualification-badge qualification-pending" style="margin-top: 8px;">
                                <i class="fas fa-clock"></i> Not Qualified
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="section" id="faq" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h1 class="auvex-headline">Frequently Asked Questions</h1>
                    <p class="auvex-subheadline">Everything you need to know about Auvex Protocol</p>
                </div>

                <div class="faq-container">
                    <!-- FAQ Items remain the same as original code -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What is Auvex Protocol?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Auvex Protocol is a DeFi platform based on smart contracts that provides structured investment mechanisms through Cycle Investment, Saving Investment, and Referral Rewards, with all processes running automatically and on-chain.</p>
                        </div>
                    </div>
                    <!-- ... other FAQ items ... -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__brand">
                    <div class="footer__logo">
                        <img src="image/logo.png" alt="" class="logo" onerror="this.style.display='none'">
                        <span>AUVEX</span>
                    </div>
                    <p>
                        Immutable smart contracts executing investments and rewards with precision, transparency and on-chain integrity
                    </p>
                    <div class="footer__social">
                        <a href="https://t.me/AuvexProtocol" class="social__link" target="_blank"><i class="fab fa-telegram-plane"></i></a>
                        <a href="https://x.com/AuvexProtocol" class="social__link" target="_blank"><i class="fab fa-twitter"></i></a>
                        <a href="https://bscscan.com/address/0x43059c580fAB3553CE52b7F73c09a4caeE1a1F4c" target="_blank" class="social__link"><i class="fas fa-file-contract"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2025 Auvex Protocol. All Rights Reserved</p>
            </div>
        </div>
    </footer>

    <!-- Popups & Modals -->
    <!-- Success Popup -->
    <div class="popup" id="successPopup">
        <div class="popup-content">
            <div class="popup-icon"><i class="fas fa-check"></i></div>
            <h2 style="color: var(--text-accent); margin-bottom: 12px;">Deposit Successful!</h2>
            <p style="color: var(--text-muted); margin: 8px 0 20px; font-size: 0.95rem;">Your investment is now active and earning returns</p>
            <div class="action-buttons" style="justify-content: center;">
                <button class="btn btn--primary btn-lg" id="goToDashboard">
                    <i class="fas fa-tachometer-alt"></i> Go to Dashboard
                </button>
            </div>
        </div>
    </div>

    <!-- Withdraw Cycle Modal -->
    <div class="popup-modal" id="withdrawCycleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Withdraw Cycle</h2>
                <p style="color: var(--text-muted);">Select cycles to withdraw</p>
            </div>
            <div class="modal-body">
                <div class="cycle-list" id="withdrawCycleList">
                    <!-- Cycle list will be loaded here -->
                </div>
                <div id="noEndedCyclesMessage" class="no-cycles" style="display: none;">
                    <i class="fas fa-info-circle" style="font-size: 1.8rem; margin-bottom: 12px; color: var(--text-muted);"></i>
                    <p>No cycles ready for withdrawal</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--primary" id="confirmWithdrawCycles">
                    <span class="btn-text">Confirm Withdrawal</span>
                </button>
                <button class="btn btn--outline" id="closeWithdrawCycleModal">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Regrow Cycle Modal -->
    <div class="popup-modal" id="regrowCycleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Regrow Cycle</h2>
                <p style="color: var(--text-muted);">Select cycle and new plan</p>
            </div>
            <div class="modal-body">
                <div class="cycle-list" id="regrowCycleList">
                    <!-- Cycle list will be loaded here -->
                </div>
                <div id="noEndedCyclesRegrowMessage" class="no-cycles" style="display: none;">
                    <i class="fas fa-info-circle" style="font-size: 1.8rem; margin-bottom: 12px; color: var(--text-muted);"></i>
                    <p>No cycles available for regrow</p>
                </div>
                
                <div style="margin-top: 20px;">
                    <label style="color: var(--text-accent); font-weight: 600; margin-bottom: 8px; display: block;">Select New Duration</label>
                    <div class="custom-dropdown" id="regrowPlanDropdown">
                        <div class="dropdown-selected">
                            <span>Select Plan</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option" data-plan="0">
                                <div class="plan-duration">1 Day</div>
                                <div class="plan-return">100.3% Return</div>
                            </div>
                            <div class="dropdown-option" data-plan="1">
                                <div class="plan-duration">7 Days</div>
                                <div class="plan-return">103.0% Return</div>
                            </div>
                            <div class="dropdown-option" data-plan="2">
                                <div class="plan-duration">14 Days</div>
                                <div class="plan-return">106.0% Return</div>
                            </div>
                            <div class="dropdown-option" data-plan="3">
                                <div class="plan-duration">30 Days</div>
                                <div class="plan-return">112.0% Return</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--primary" id="confirmRegrowModal">
                    <span class="btn-text">Confirm Regrow</span>
                </button>
                <button class="btn btn--outline" id="closeRegrowCycleModal">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Withdraw Capital Modal -->
    <div class="popup-modal" id="withdrawCapitalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Withdraw Capital</h2>
                <p style="color: var(--text-muted);">Select saving to withdraw capital</p>
            </div>
            <div class="modal-body">
                <div class="cycle-list" id="withdrawCapitalList">
                    <!-- Saving list will be loaded here -->
                </div>
                <div id="noActiveSavingsMessage" class="no-cycles" style="display: none;">
                    <i class="fas fa-info-circle" style="font-size: 1.8rem; margin-bottom: 12px; color: var(--text-muted);"></i>
                    <p>No active savings found!</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--primary" id="confirmWithdrawCapital">
                    <span class="btn-text">Confirm Capital Withdrawal</span>
                </button>
                <button class="btn btn--outline" id="closeWithdrawCapitalModal">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // ===== CONFIGURATION =====
        const CONTRACT_ADDRESS = '0x43059c580fAB3553CE52b7F73c09a4caeE1a1F4c';
        const USDT_ADDRESS = '0x55d398326f99059fF775485246999027B3197955';
        const BSC_RPC = 'https://bsc-dataseed.binance.org/';
        const BSC_CHAIN_ID = '0x38';

        // Full ABI from your smart contract
        const CONTRACT_ABI = [
            {"inputs":[{"internalType":"address","name":"_usdtAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"CapitalWithdrawn","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"profit","type":"uint256"}],"name":"CycleClaimed","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"planType","type":"uint8"},{"indexed":false,"internalType":"address","name":"referrer","type":"address"}],"name":"NewDeposit","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"}],"name":"OwnershipRenounced","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newBalance","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"changePercent","type":"uint256"}],"name":"PoolAdjusted","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"referrer","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"planType","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"}],"name":"ReferralRewardPaid","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"oldCycleId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newCycleId","type":"uint256"}],"name":"RegrowExecuted","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"SavingClaimed","type":"event"},
            {"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ScorchReferralWithdrawn","type":"event"},
            {"inputs":[],"name":"ADMIN_FEE_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"ADMIN_FICTITIOUS_DEPOSIT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"ADMIN_REWARD_INTERVAL","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"ADMIN_WALLET","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_DURATIONS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_REF_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_REF_REQUIREMENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"MIN_DEPOSIT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"SAVING_ADJUSTMENT_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"SAVING_MAX_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"SAVING_MIN_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"SAVING_REF_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"SAVING_REF_REQUIREMENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"TIME_STEP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"adminAccumulatedRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"adminLastRewardTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"savingId","type":"uint256"}],"name":"capitalSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"claimCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"claimSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"contractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"cycleInvestments","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"plan","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"bool","name":"claimed","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint8","name":"plan","type":"uint8"},{"internalType":"address","name":"referrer","type":"address"}],"name":"depositCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"referrer","type":"address"}],"name":"depositSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"downlines","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"getContractDashboard","outputs":[{"components":[{"internalType":"uint256","name":"globalTotalInvested","type":"uint256"},{"internalType":"uint256","name":"globalTotalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"globalTotalUsers","type":"uint256"},{"internalType":"uint256","name":"globalContractBalance","type":"uint256"},{"internalType":"uint256","name":"globalPoolBalance","type":"uint256"},{"internalType":"uint256","name":"globalScorchPool","type":"uint256"},{"internalType":"uint256","name":"availableLiquidity","type":"uint256"},{"internalType":"uint256","name":"utilizationRate","type":"uint256"},{"internalType":"uint256","name":"dailyVolume","type":"uint256"},{"internalType":"uint256","name":"averageInvestment","type":"uint256"},{"internalType":"uint256","name":"poolGrowth7d","type":"uint256"},{"internalType":"uint256","name":"poolGrowth30d","type":"uint256"}],"internalType":"struct Auvex.ContractDashboard","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"getCyclePlanInfo","outputs":[{"components":[{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"percentage","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"minInvestment","type":"uint256"}],"internalType":"struct Auvex.CyclePlanInfo[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"userAddress","type":"address"}],"name":"getInvestmentSummary","outputs":[{"components":[{"internalType":"uint256","name":"totalCycleInvestment","type":"uint256"},{"internalType":"uint256","name":"totalSavingInvestment","type":"uint256"},{"internalType":"uint256","name":"totalActiveInvestment","type":"uint256"},{"internalType":"uint256","name":"totalPendingRewards","type":"uint256"},{"internalType":"uint256","name":"totalAccruedProfits","type":"uint256"},{"internalType":"uint256","name":"averageDailyEarnings","type":"uint256"},{"internalType":"uint256","name":"roiPercentage","type":"uint256"}],"internalType":"struct Auvex.InvestmentSummary","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"getSavingPlanInfo","outputs":[{"components":[{"internalType":"uint256","name":"minPercent","type":"uint256"},{"internalType":"uint256","name":"maxPercent","type":"uint256"},{"internalType":"uint256","name":"adjustmentPercent","type":"uint256"},{"internalType":"uint256","name":"minInvestment","type":"uint256"},{"internalType":"string","name":"description","type":"string"}],"internalType":"struct Auvex.SavingPlanInfo","name":"","type":"tuple"}],"stateMutability":"pure","type":"function"},
            {"inputs":[{"internalType":"address","name":"userAddress","type":"address"}],"name":"getUserCycleInvestments","outputs":[{"components":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"plan","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"},{"internalType":"uint256","name":"profit","type":"uint256"},{"internalType":"bool","name":"claimed","type":"bool"},{"internalType":"bool","name":"claimable","type":"bool"}],"internalType":"struct Auvex.CycleInvestmentInfo[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"userAddress","type":"address"}],"name":"getUserDashboard","outputs":[{"components":[{"internalType":"address","name":"userReferrer","type":"address"},{"internalType":"uint256","name":"userReferrals","type":"uint256"},{"internalType":"uint256","name":"userTotalInvested","type":"uint256"},{"internalType":"uint256","name":"userTotalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"netProfit","type":"uint256"},{"internalType":"uint256","name":"activeInvestment","type":"uint256"},{"internalType":"bool","name":"isUserActive","type":"bool"},{"internalType":"uint256","name":"cycleRewards","type":"uint256"},{"internalType":"uint256","name":"savingRewards","type":"uint256"},{"internalType":"uint256","name":"totalAvailableRewards","type":"uint256"},{"internalType":"uint256","name":"activeCycles","type":"uint256"},{"internalType":"uint256","name":"activeSavings","type":"uint256"},{"internalType":"uint256","name":"totalCycles","type":"uint256"},{"internalType":"uint256","name":"totalSavings","type":"uint256"},{"internalType":"uint256","name":"nextSavingClaimTime","type":"uint256"},{"internalType":"uint256","name":"savingClaimCooldown","type":"uint256"},{"internalType":"bool","name":"canClaimSaving","type":"bool"},{"internalType":"uint256","name":"cycleQualificationLevel","type":"uint256"},{"internalType":"uint256","name":"savingQualificationLevel","type":"uint256"}],"internalType":"struct Auvex.UserDashboardInfo","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"userAddress","type":"address"}],"name":"getUserReferralInfo","outputs":[{"components":[{"internalType":"address[]","name":"directDownlines","type":"address[]"},{"internalType":"uint256[]","name":"downlineLevels","type":"uint256[]"},{"internalType":"uint256[]","name":"downlineInvestments","type":"uint256[]"},{"internalType":"uint256","name":"totalReferralEarnings","type":"uint256"},{"internalType":"uint256","name":"qualifiedCycleLevels","type":"uint256"},{"internalType":"uint256","name":"qualifiedSavingLevels","type":"uint256"},{"internalType":"uint256[]","name":"cycleLevelQualifications","type":"uint256[]"},{"internalType":"uint256[]","name":"savingLevelQualifications","type":"uint256[]"}],"internalType":"struct Auvex.ReferralInfo","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"userAddress","type":"address"}],"name":"getUserSavingInvestments","outputs":[{"components":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"currentPercent","type":"uint256"},{"internalType":"uint256","name":"dailyReward","type":"uint256"},{"internalType":"uint256","name":"lastPayout","type":"uint256"},{"internalType":"uint256","name":"nextPayout","type":"uint256"},{"internalType":"uint256","name":"accumulatedReward","type":"uint256"},{"internalType":"bool","name":"active","type":"bool"}],"internalType":"struct Auvex.SavingInvestmentInfo[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"isRenounced","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"poolBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"poolSnapshots","outputs":[{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"uint256","name":"poolBalance","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"qualifiedDownlineCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"},{"internalType":"uint8","name":"newPlan","type":"uint8"}],"name":"regrow","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"rewardCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"rewardSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"savingInvestments","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"currentPercent","type":"uint256"},{"internalType":"uint256","name":"lastPayout","type":"uint256"},{"internalType":"bool","name":"active","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"scorchReferralPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"totalInvestedGlobal","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"totalUsers","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"totalWithdrawnGlobal","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"usdt","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"users","outputs":[{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256","name":"referrals","type":"uint256"},{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"cycleRewards","type":"uint256"},{"internalType":"uint256","name":"savingRewards","type":"uint256"},{"internalType":"uint256","name":"lastSavingClaim","type":"uint256"},{"internalType":"uint256","name":"activeInvestment","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"withdrawScorchReferral","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"stateMutability":"payable","type":"receive"}
        ];

        const USDT_ABI = [
            {"constant": false, "inputs": [{"name": "_spender", "type": "address"}, {"name": "_value", "type": "uint256"}], "name": "approve", "outputs": [{"name": "", "type": "bool"}], "type": "function"}, 
            {"constant": true, "inputs": [{"name": "_owner", "type": "address"}], "name": "balanceOf", "outputs": [{"name": "balance", "type": "uint256"}], "type": "function"}, 
            {"constant": true, "inputs": [{"name": "_owner", "type": "address"}, {"name": "_spender", "type": "address"}], "name": "allowance", "outputs": [{"name": "", "type": "uint256"}], "type": "function"}, 
            {"constant": true, "inputs": [], "name": "decimals", "outputs": [{"name": "", "type": "uint8"}], "type": "function"},
            {"constant": false, "inputs": [{"name": "_to", "type": "address"}, {"name": "_value", "type": "uint256"}], "name": "transfer", "outputs": [{"name": "", "type": "bool"}], "type": "function"}
        ];

        // ===== GLOBAL VARIABLES =====
        let web3;
        let contract;
        let usdtContract;
        let userAccount = null;
        let referralAddress = null;
        let selectedCyclePlan = null;
        let selectedRegrowPlan = null;
        let selectedCycleForRegrow = null;
        let selectedCycleForWithdraw = [];
        let selectedSavingForWithdraw = null;
        let userCycles = [];
        let userSavings = [];
        let userInfo = null;
        let savingDataInterval = null;
        let currentCycleMinAmount = 5;

        // ===== DOM ELEMENTS =====
        const preloader = document.querySelector('.preloader');
        const navToggle = document.getElementById('nav-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        const connectWalletBtn = document.getElementById('connectWallet');
        const connectWalletMobile = document.getElementById('connectWalletMobile');
        const notification = document.getElementById('notification');
        const successPopup = document.getElementById('successPopup');
        const withdrawCycleModal = document.getElementById('withdrawCycleModal');
        const regrowCycleModal = document.getElementById('regrowCycleModal');
        const withdrawCapitalModal = document.getElementById('withdrawCapitalModal');
        const goToDashboardBtn = document.getElementById('goToDashboard');

        const sections = {
            home: document.getElementById('home'),
            cycle: document.getElementById('cycle'),
            saving: document.getElementById('saving'),
            faq: document.getElementById('faq')
        };

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            checkPreloader();
            checkURLForReferral();
            setupFAQ();
            setupDropdowns();
            setupModalDropdowns();
            setupROICalculators();
            
            // Auto-connect if previously connected
            if (localStorage.getItem('walletConnected') === 'true' && typeof window.ethereum !== 'undefined') {
                window.ethereum.request({ method: 'eth_accounts' }).then(accounts => {
                    if (accounts.length > 0) {
                        userAccount = accounts[0];
                        connectWallet();
                    }
                });
            }
        });

        async function initializeApp() {
            try {
                // Initialize Web3 with BSC RPC
                web3 = new Web3(new Web3.providers.HttpProvider(BSC_RPC));
                contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                
                // Load initial stats
                await loadContractStats();
                
                // Start stats auto-refresh
                setInterval(loadContractStats, 30000); // Refresh every 30 seconds
                
            } catch (error) {
                console.error('Initialization error:', error);
                showNotification('Initializing application...', 'info');
            }
        }

        async function loadContractStats() {
            if (!contract) return;
            
            try {
                const dashboard = await contract.methods.getContractDashboard().call();
                
                const formatUSDT = (weiValue) => {
                    const value = parseFloat(web3.utils.fromWei(weiValue, 'ether'));
                    return value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                };
                
                // Update home stats with new dashboard structure
                document.getElementById('statLiquidity').textContent = `${formatUSDT(dashboard.availableLiquidity)} USDT`;
                document.getElementById('statTotalUsers').textContent = `${parseInt(dashboard.globalTotalUsers).toLocaleString('en-US')} Users`;
                document.getElementById('statTotalInvest').textContent = `${formatUSDT(dashboard.globalTotalInvested)} USDT`;
                document.getElementById('statTotalPaid').textContent = `${formatUSDT(dashboard.globalTotalWithdrawn)} USDT`;
                document.getElementById('statScorchReferral').textContent = `${formatUSDT(dashboard.globalScorchPool)} USDT`;
                
            } catch (error) {
                console.error('Error loading contract stats:', error);
            }
        }

        // ===== DROPDOWN FUNCTIONS =====
        function setupDropdowns() {
            // Cycle dropdown
            const cycleDropdown = document.getElementById('cycleDropdown');
            const cycleSelected = cycleDropdown.querySelector('.dropdown-selected');
            const cycleOptions = cycleDropdown.querySelector('.dropdown-options');
            const cycleOptionItems = cycleDropdown.querySelectorAll('.dropdown-option');
            
            cycleSelected.addEventListener('click', () => {
                cycleSelected.classList.toggle('open');
                cycleOptions.classList.toggle('show');
            });
            
            cycleOptionItems.forEach(option => {
                option.addEventListener('click', () => {
                    const planDuration = option.querySelector('.plan-duration').textContent;
                    const planReturn = option.querySelector('.plan-return').textContent;
                    const plan = option.getAttribute('data-plan');
                    currentCycleMinAmount = parseInt(option.getAttribute('data-min')) || 5;
                    
                    cycleSelected.innerHTML = `
                        <span>${planDuration} - ${planReturn}</span>
                        <i class="fas fa-chevron-down"></i>
                    `;
                    selectedCyclePlan = plan;
                    
                    // Update minimum amount display
                    document.getElementById('cycleAmountRange').innerHTML = 
                        `Minimum: ${currentCycleMinAmount} USDT`;
                    
                    // Show ROI calculator
                    updateCycleROICalculator();
                    
                    cycleSelected.classList.remove('open');
                    cycleOptions.classList.remove('show');
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!cycleDropdown.contains(e.target)) {
                    cycleSelected.classList.remove('open');
                    cycleOptions.classList.remove('show');
                }
            });
        }

        function setupModalDropdowns() {
            // Regrow plan dropdown in modal
            const regrowPlanDropdown = document.getElementById('regrowPlanDropdown');
            if (regrowPlanDropdown) {
                const regrowPlanSelected = regrowPlanDropdown.querySelector('.dropdown-selected');
                const regrowPlanOptions = regrowPlanDropdown.querySelector('.dropdown-options');
                const regrowPlanOptionItems = regrowPlanDropdown.querySelectorAll('.dropdown-option');
                
                regrowPlanSelected.addEventListener('click', () => {
                    regrowPlanSelected.classList.toggle('open');
                    regrowPlanOptions.classList.toggle('show');
                });
                
                regrowPlanOptionItems.forEach(option => {
                    option.addEventListener('click', () => {
                        const planDuration = option.querySelector('.plan-duration').textContent;
                        const planReturn = option.querySelector('.plan-return').textContent;
                        const plan = option.getAttribute('data-plan');
                        
                        regrowPlanSelected.innerHTML = `
                            <span>${planDuration} - ${planReturn}</span>
                            <i class="fas fa-chevron-down"></i>
                        `;
                        selectedRegrowPlan = plan;
                        
                        regrowPlanSelected.classList.remove('open');
                        regrowPlanOptions.classList.remove('show');
                    });
                });
            }
        }

        // ===== ROI CALCULATORS =====
        function setupROICalculators() {
            // Cycle ROI calculator
            document.getElementById('cycleAmount').addEventListener('input', updateCycleROICalculator);
            
            // Saving ROI calculator
            document.getElementById('savingAmount').addEventListener('input', updateSavingROICalculator);
        }

        function updateCycleROICalculator() {
            const amountInput = document.getElementById('cycleAmount');
            const amount = parseFloat(amountInput.value);
            
            if (isNaN(amount) || amount < currentCycleMinAmount || !selectedCyclePlan) {
                document.getElementById('cycleRoiCalculator').style.display = 'none';
                return;
            }
            
            const planPercentages = [1003, 1030, 1060, 1120]; // From contract: 100.3%, 103.0%, etc
            const selectedPlan = parseInt(selectedCyclePlan);
            const percentage = planPercentages[selectedPlan] / 10; // Convert to percentage
            
            const totalReturn = (amount * percentage) / 100;
            const profit = totalReturn - amount;
            
            document.getElementById('cycleRoiCalculator').style.display = 'block';
            document.getElementById('cycleRoiPercent').textContent = `${percentage.toFixed(1)}%`;
            document.getElementById('cycleRoiInvestment').textContent = `${amount.toFixed(2)} USDT`;
            document.getElementById('cycleRoiProfit').textContent = `${profit.toFixed(2)} USDT`;
            document.getElementById('cycleRoiTotal').textContent = `${totalReturn.toFixed(2)} USDT`;
        }

        function updateSavingROICalculator() {
            const amount = parseFloat(document.getElementById('savingAmount').value);
            
            if (isNaN(amount) || amount < 5) return;
            
            // Saving interest: 0.3% to 0.8% daily
            const minDaily = (amount * 0.3) / 100;
            const maxDaily = (amount * 0.8) / 100;
            
            document.getElementById('savingRoiDaily').textContent = `${minDaily.toFixed(4)}-${maxDaily.toFixed(4)} USDT`;
            document.getElementById('savingRoiWeekly').textContent = `${(minDaily * 7).toFixed(4)}-${(maxDaily * 7).toFixed(4)} USDT`;
            document.getElementById('savingRoiMonthly').textContent = `${(minDaily * 30).toFixed(4)}-${(maxDaily * 30).toFixed(4)} USDT`;
        }

        // ===== MODAL FUNCTIONS =====
        function showModal(modal) {
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hideModal(modal) {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // ===== WALLET CONNECTION =====
        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                return showNotification('No wallet detected! Please install MetaMask or Trust Wallet.', 'error');
            }
            
            try {
                // Switch to Web3 provider with user's wallet
                web3 = new Web3(window.ethereum);
                contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                usdtContract = new web3.eth.Contract(USDT_ABI, USDT_ADDRESS);

                // Check and switch to BSC network
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                if (chainId !== BSC_CHAIN_ID) {
                    try {
                        await window.ethereum.request({ 
                            method: 'wallet_switchEthereumChain', 
                            params: [{ chainId: BSC_CHAIN_ID }] 
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await window.ethereum.request({ 
                                method: 'wallet_addEthereumChain', 
                                params: [{ 
                                    chainId: BSC_CHAIN_ID, 
                                    chainName: 'Binance Smart Chain', 
                                    nativeCurrency: { 
                                        name: 'BNB', 
                                        symbol: 'BNB', 
                                        decimals: 18 
                                    }, 
                                    rpcUrls: [BSC_RPC], 
                                    blockExplorerUrls: ['https://bscscan.com/'] 
                                }] 
                            });
                        } else {
                            throw switchError;
                        }
                    }
                }
                
                // Request accounts
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                if (accounts.length > 0) {
                    userAccount = accounts[0];
                    localStorage.setItem('walletConnected', 'true');
                    updateWalletUI();
                    await loadUserData();
                    updateReferralLinks();
                    showNotification('Wallet connected successfully!', 'success');
                }
            } catch (error) {
                console.error('Error connecting wallet:', error);
                showNotification('Failed to connect wallet: ' + error.message, 'error');
            }
        }

        function updateWalletUI() {
            if (userAccount) {
                const shortAddress = `${userAccount.substring(0, 6)}...${userAccount.substring(userAccount.length - 4)}`;
                connectWalletBtn.innerHTML = `<i class="fas fa-wallet"></i> ${shortAddress}`;
                if (connectWalletMobile) {
                    connectWalletMobile.innerHTML = `<i class="fas fa-wallet"></i> ${shortAddress}`;
                }
                hideWalletAlerts();
            } else {
                connectWalletBtn.innerHTML = `<i class="fas fa-wallet"></i> Connect Wallet`;
                if (connectWalletMobile) {
                    connectWalletMobile.innerHTML = `<i class="fas fa-wallet"></i> Connect Wallet`;
                }
                showWalletAlerts();
            }
        }

        function updateReferralLinks() {
            if (userAccount) {
                const baseUrl = window.location.origin + window.location.pathname;
                const cycleReferralLink = `${baseUrl}?ref=${userAccount}`;
                const savingReferralLink = `${baseUrl}?ref=${userAccount}`;
                
                document.getElementById('cycleReferralLink').textContent = cycleReferralLink;
                document.getElementById('savingReferralLink').textContent = savingReferralLink;
            }
        }

        function showWalletAlerts() {
            document.getElementById('cycleWalletAlert').style.display = 'flex';
            document.getElementById('savingWalletAlert').style.display = 'flex';
            
            document.getElementById('cycleContainer').style.display = 'none';
            document.getElementById('savingContainer').style.display = 'none';
        }

        function hideWalletAlerts() {
            document.getElementById('cycleWalletAlert').style.display = 'none';
            document.getElementById('savingWalletAlert').style.display = 'none';
            
            document.getElementById('cycleContainer').style.display = 'grid';
            document.getElementById('savingContainer').style.display = 'grid';
        }

        // ===== EVENT LISTENERS =====
        function setupEventListeners() {
            // Mobile menu toggle
            navToggle.addEventListener('click', () => {
                mobileMenu.classList.toggle('active');
            });

            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (mobileMenu.classList.contains('active') && 
                    !mobileMenu.contains(e.target) && 
                    !navToggle.contains(e.target)) {
                    mobileMenu.classList.remove('active');
                }
            });

            // Navigation
            document.querySelectorAll('.nav__link, .mobile-menu a, button[data-section]').forEach(el => {
                el.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetElement = e.target.closest('[data-section]');
                    if (targetElement) {
                        const sectionName = targetElement.getAttribute('data-section');
                        showSection(sectionName);
                        mobileMenu.classList.remove('active');
                    }
                });
            });

            // Wallet connections
            connectWalletBtn.addEventListener('click', connectWallet);
            if (connectWalletMobile) {
                connectWalletMobile.addEventListener('click', connectWallet);
            }

            // Copy referral links
            document.getElementById('copyCycleReferral').addEventListener('click', () => {
                const link = document.getElementById('cycleReferralLink').textContent;
                navigator.clipboard.writeText(link).then(() => {
                    showNotification('Cycle referral link copied to clipboard!', 'success');
                });
            });

            document.getElementById('copySavingReferral').addEventListener('click', () => {
                const link = document.getElementById('savingReferralLink').textContent;
                navigator.clipboard.writeText(link).then(() => {
                    showNotification('Saving referral link copied to clipboard!', 'success');
                });
            });

            // Cycle investment
            document.getElementById('confirmCycle').addEventListener('click', confirmCycleInvestment);
            document.getElementById('cycleAmount').addEventListener('input', validateCycleAmount);
            
            // Cycle actions
            document.getElementById('withdrawCycle').addEventListener('click', openWithdrawCycleModal);
            document.getElementById('regrowCycle').addEventListener('click', openRegrowCycleModal);
            document.getElementById('withdrawCycleReferral').addEventListener('click', withdrawCycleReferral);
            
            // Saving investment
            document.getElementById('confirmSaving').addEventListener('click', confirmSavingInvestment);
            document.getElementById('savingAmount').addEventListener('input', validateSavingAmount);
            
            // Saving actions
            document.getElementById('withdrawSaving').addEventListener('click', withdrawSavingRewards);
            document.getElementById('withdrawCapitalSaving').addEventListener('click', openWithdrawCapitalModal);
            document.getElementById('withdrawSavingReferral').addEventListener('click', withdrawSavingReferral);
            
            // Modal buttons
            document.getElementById('closeWithdrawCycleModal').addEventListener('click', () => hideModal(withdrawCycleModal));
            document.getElementById('closeRegrowCycleModal').addEventListener('click', () => hideModal(regrowCycleModal));
            document.getElementById('closeWithdrawCapitalModal').addEventListener('click', () => hideModal(withdrawCapitalModal));
            
            document.getElementById('confirmWithdrawCycles').addEventListener('click', confirmWithdrawCycles);
            document.getElementById('confirmRegrowModal').addEventListener('click', confirmRegrowModal);
            document.getElementById('confirmWithdrawCapital').addEventListener('click', confirmWithdrawCapital);
            
            // Success popup
            goToDashboardBtn.addEventListener('click', () => {
                hidePopup(successPopup);
                showSection('cycle');
            });

            // Close popups on outside click
            successPopup.addEventListener('click', (e) => {
                if (e.target === successPopup) hidePopup(successPopup);
            });
            withdrawCycleModal.addEventListener('click', (e) => {
                if (e.target === withdrawCycleModal) hideModal(withdrawCycleModal);
            });
            regrowCycleModal.addEventListener('click', (e) => {
                if (e.target === regrowCycleModal) hideModal(regrowCycleModal);
            });
            withdrawCapitalModal.addEventListener('click', (e) => {
                if (e.target === withdrawCapitalModal) hideModal(withdrawCapitalModal);
            });

            // Window scroll for header effect
            window.addEventListener('scroll', handleScroll);
            
            // Listen for account changes
            if (window.ethereum) {
                window.ethereum.on('accountsChanged', (accounts) => {
                    if (accounts.length > 0) {
                        userAccount = accounts[0];
                        localStorage.setItem('walletConnected', 'true');
                        updateWalletUI();
                        loadUserData();
                        updateReferralLinks();
                        showNotification('Account changed', 'info');
                    } else {
                        userAccount = null;
                        localStorage.removeItem('walletConnected');
                        updateWalletUI();
                        showWalletAlerts();
                    }
                });

                window.ethereum.on('chainChanged', () => {
                    window.location.reload();
                });
            }
        }

        // ===== UTILITY FUNCTIONS =====
        function handleScroll() {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        }

        function checkPreloader() {
            setTimeout(() => {
                preloader.classList.add('fade-out');
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 600);
            }, 1500);
        }

        function checkURLForReferral() {
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            if (ref && web3.utils.isAddress(ref)) {
                referralAddress = ref;
                document.getElementById('cycleReferrer').value = ref;
                document.getElementById('savingReferrer').value = ref;
            }
        }

        function setupFAQ() {
            document.querySelectorAll('.faq-question').forEach(question => {
                question.addEventListener('click', () => {
                    const faqItem = question.parentElement;
                    const isActive = faqItem.classList.contains('active');
                    
                    // Close all FAQ items
                    document.querySelectorAll('.faq-item').forEach(item => {
                        item.classList.remove('active');
                        const icon = item.querySelector('.faq-icon');
                        if (icon) icon.style.transform = 'rotate(0deg)';
                    });
                    
                    // Open clicked item if it wasn't active
                    if (!isActive) {
                        faqItem.classList.add('active');
                        const icon = question.querySelector('.faq-icon');
                        if (icon) icon.style.transform = 'rotate(180deg)';
                    }
                });
            });
        }

        function showSection(sectionName) {
            // Hide all sections
            Object.values(sections).forEach(section => {
                section.style.display = 'none';
            });

            // Show selected section
            if (sections[sectionName]) {
                sections[sectionName].style.display = 'flex';
                
                // Start/stop real-time updates based on section
                if (sectionName === 'saving') {
                    startSavingRealTimeUpdates();
                } else {
                    stopSavingRealTimeUpdates();
                }
                
                // Update active nav link
                document.querySelectorAll('.nav__link').forEach(link => {
                    link.classList.remove('active');
                });
                document.querySelectorAll('.mobile-menu a').forEach(link => {
                    link.classList.remove('active');
                });
                
                const desktopLink = document.querySelector(`[data-section="${sectionName}"]`);
                const mobileLink = document.querySelector(`.mobile-menu a[data-section="${sectionName}"]`);
                
                if (desktopLink) desktopLink.classList.add('active');
                if (mobileLink) mobileLink.classList.add('active');
                
                // Scroll to top of section
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function startSavingRealTimeUpdates() {
            if (savingDataInterval) {
                clearInterval(savingDataInterval);
            }
            savingDataInterval = setInterval(updateSavingRealTimeData, 5000); // Update every 5 seconds
        }

        function stopSavingRealTimeUpdates() {
            if (savingDataInterval) {
                clearInterval(savingDataInterval);
                savingDataInterval = null;
            }
        }

        async function updateSavingRealTimeData() {
            if (!userAccount || !contract || sections.saving.style.display === 'none') {
                return;
            }

            try {
                const savingInvestments = await contract.methods.getUserSavingInvestments(userAccount).call();
                
                if (savingInvestments.length === 0) return;
                
                const tbody = document.getElementById('savingsTableBody');
                if (!tbody) return;
                
                const rows = tbody.querySelectorAll('tr');
                
                for (let i = 0; i < savingInvestments.length && i < rows.length; i++) {
                    const investment = savingInvestments[i];
                    const isActive = investment.active;
                    
                    if (isActive) {
                        const currentPercent = parseFloat(investment.currentPercent) / 10; // Convert to percentage
                        const accumulatedReward = parseFloat(web3.utils.fromWei(investment.accumulatedReward, 'ether'));
                        
                        // Update the table row
                        const cells = rows[i].querySelectorAll('td');
                        if (cells.length >= 4) {
                            // Update ROI (index 2)
                            cells[2].textContent = `${currentPercent.toFixed(2)}%`;
                            
                            // Update Accumulated (index 3)
                            cells[3].textContent = `${accumulatedReward.toFixed(4)} USDT`;
                        }
                    }
                }
            } catch (error) {
                console.error('Error updating real-time saving data:', error);
            }
        }

        function showNotification(message, type = 'info') {
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        function showPopup(popup) {
            popup.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hidePopup(popup) {
            popup.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showButtonLoading(button, isLoading) {
            const btnText = button.querySelector('.btn-text');
            if (!btnText) return;
            
            if (isLoading) {
                button.classList.add('loading');
                button.innerHTML = `<i class="fas fa-spinner fa-spin loading-spinner"></i> Processing...`;
                button.disabled = true;
            } else {
                button.classList.remove('loading');
                button.disabled = false;
                // Restore original content based on button ID
                const buttonTexts = {
                    'confirmCycle': '<i class="fas fa-sync-alt"></i> <span class="btn-text">Confirm Cycle Investment</span>',
                    'confirmSaving': '<i class="fas fa-piggy-bank"></i> <span class="btn-text">Confirm Saving Investment</span>',
                    'withdrawCycle': '<i class="fas fa-hand-holding-usd"></i> <span class="btn-text">Withdraw Cycle</span>',
                    'regrowCycle': '<i class="fas fa-sync-alt"></i> <span class="btn-text">Regrow Cycle</span>',
                    'withdrawCycleReferral': '<i class="fas fa-hand-holding-usd"></i> <span class="btn-text">Withdraw Referral Rewards</span>',
                    'withdrawSaving': '<i class="fas fa-hand-holding-usd"></i> <span class="btn-text">Withdraw Earnings</span>',
                    'withdrawCapitalSaving': '<i class="fas fa-university"></i> <span class="btn-text">Withdraw Capital</span>',
                    'withdrawSavingReferral': '<i class="fas fa-hand-holding-usd"></i> <span class="btn-text">Withdraw Referral Rewards</span>',
                    'confirmWithdrawCycles': '<span class="btn-text">Confirm Withdrawal</span>',
                    'confirmRegrowModal': '<span class="btn-text">Confirm Regrow</span>',
                    'confirmWithdrawCapital': '<span class="btn-text">Confirm Capital Withdrawal</span>'
                };
                
                button.innerHTML = buttonTexts[button.id] || button.innerHTML;
            }
        }

        // ===== VALIDATION FUNCTIONS =====
        function validateCycleAmount() {
            const amount = parseFloat(document.getElementById('cycleAmount').value);
            const minAmount = currentCycleMinAmount || 5;
            
            if (isNaN(amount) || amount < minAmount) {
                document.getElementById('cycleAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('cycleAmountRange').style.color = '#ff4444';
                return false;
            } else {
                document.getElementById('cycleAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('cycleAmountRange').style.color = 'var(--text-muted)';
                return true;
            }
        }

        function validateSavingAmount() {
            const amount = parseFloat(document.getElementById('savingAmount').value);
            const minAmount = 5;
            
            if (isNaN(amount) || amount < minAmount) {
                document.getElementById('savingAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('savingAmountRange').style.color = '#ff4444';
                return false;
            } else {
                document.getElementById('savingAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('savingAmountRange').style.color = 'var(--text-muted)';
                return true;
            }
        }

        // ===== MODAL OPEN FUNCTIONS =====
        async function openWithdrawCycleModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            selectedCycleForWithdraw = [];
            
            try {
                const cycles = await contract.methods.getUserCycleInvestments(userAccount).call();
                
                const cycleList = document.getElementById('withdrawCycleList');
                const noCyclesMessage = document.getElementById('noEndedCyclesMessage');
                
                cycleList.innerHTML = '';
                
                if (cycles.length === 0) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                    showModal(withdrawCycleModal);
                    return;
                }
                
                let hasReadyCycles = false;
                const planNames = ['1 Day', '7 Days', '14 Days', '30 Days'];
                
                cycles.forEach((cycle, index) => {
                    if (cycle.claimable && !cycle.claimed) {
                        hasReadyCycles = true;
                        
                        const amount = parseFloat(web3.utils.fromWei(cycle.amount, 'ether')).toFixed(2);
                        const totalReturn = parseFloat(web3.utils.fromWei(cycle.totalReturn, 'ether')).toFixed(2);
                        const planName = planNames[parseInt(cycle.plan)] || 'Unknown';
                        
                        const cycleItem = document.createElement('div');
                        cycleItem.className = 'cycle-item';
                        cycleItem.dataset.cycleId = index;
                        cycleItem.innerHTML = `
                            <div class="cycle-info">
                                <div>
                                    <div class="cycle-amount">${amount} USDT</div>
                                    <div class="cycle-plan">${planName} (Return: ${totalReturn} USDT)</div>
                                </div>
                                <div>
                                    <input type="checkbox" class="cycle-checkbox" data-cycle-id="${index}">
                                </div>
                            </div>
                        `;
                        
                        cycleList.appendChild(cycleItem);
                    }
                });
                
                if (!hasReadyCycles) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                } else {
                    cycleList.style.display = 'block';
                    noCyclesMessage.style.display = 'none';
                }
                
                // Add event listeners to checkboxes
                document.querySelectorAll('.cycle-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const cycleId = e.target.getAttribute('data-cycle-id');
                        if (e.target.checked) {
                            selectedCycleForWithdraw.push(cycleId);
                            e.target.closest('.cycle-item').classList.add('selected');
                        } else {
                            const index = selectedCycleForWithdraw.indexOf(cycleId);
                            if (index > -1) {
                                selectedCycleForWithdraw.splice(index, 1);
                            }
                            e.target.closest('.cycle-item').classList.remove('selected');
                        }
                    });
                });
                
                showModal(withdrawCycleModal);
                
            } catch (error) {
                console.error('Error loading cycles:', error);
                showNotification('Error loading cycles. Please try again.', 'error');
            }
        }

        async function openRegrowCycleModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            selectedCycleForRegrow = null;
            selectedRegrowPlan = null;
            
            // Reset dropdown
            const regrowPlanDropdown = document.getElementById('regrowPlanDropdown');
            if (regrowPlanDropdown) {
                const regrowPlanSelected = regrowPlanDropdown.querySelector('.dropdown-selected');
                regrowPlanSelected.innerHTML = `<span>Select Plan</span><i class="fas fa-chevron-down"></i>`;
            }
            
            try {
                const cycles = await contract.methods.getUserCycleInvestments(userAccount).call();
                
                const cycleList = document.getElementById('regrowCycleList');
                const noCyclesMessage = document.getElementById('noEndedCyclesRegrowMessage');
                
                cycleList.innerHTML = '';
                
                if (cycles.length === 0) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                    showModal(regrowCycleModal);
                    return;
                }
                
                let hasReadyCycles = false;
                const planNames = ['1 Day', '7 Days', '14 Days', '30 Days'];
                
                cycles.forEach((cycle, index) => {
                    if (cycle.claimable && !cycle.claimed) {
                        hasReadyCycles = true;
                        
                        const amount = parseFloat(web3.utils.fromWei(cycle.amount, 'ether')).toFixed(2);
                        const totalReturn = parseFloat(web3.utils.fromWei(cycle.totalReturn, 'ether')).toFixed(2);
                        const planName = planNames[parseInt(cycle.plan)] || 'Unknown';
                        
                        const cycleItem = document.createElement('div');
                        cycleItem.className = 'cycle-item';
                        cycleItem.dataset.cycleId = index;
                        cycleItem.innerHTML = `
                            <div class="cycle-info">
                                <div>
                                    <div class="cycle-amount">${amount} USDT</div>
                                    <div class="cycle-plan">${planName} (Return: ${totalReturn} USDT)</div>
                                </div>
                                <div>
                                    <input type="radio" name="regrowSelect" class="saving-radio" data-cycle-id="${index}">
                                </div>
                            </div>
                        `;
                        
                        cycleList.appendChild(cycleItem);
                    }
                });
                
                if (!hasReadyCycles) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                } else {
                    cycleList.style.display = 'block';
                    noCyclesMessage.style.display = 'none';
                }
                
                // Add event listeners to radio buttons
                document.querySelectorAll('.saving-radio[name="regrowSelect"]').forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        if (e.target.checked) {
                            selectedCycleForRegrow = e.target.getAttribute('data-cycle-id');
                            // Add selected class to parent item
                            document.querySelectorAll('#regrowCycleList .cycle-item').forEach(item => {
                                item.classList.remove('selected');
                            });
                            e.target.closest('.cycle-item').classList.add('selected');
                        }
                    });
                });
                
                showModal(regrowCycleModal);
                
            } catch (error) {
                console.error('Error loading cycles:', error);
                showNotification('Error loading cycles. Please try again.', 'error');
            }
        }

        async function openWithdrawCapitalModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            selectedSavingForWithdraw = null;
            
            try {
                const savings = await contract.methods.getUserSavingInvestments(userAccount).call();
                
                const savingList = document.getElementById('withdrawCapitalList');
                const noSavingsMessage = document.getElementById('noActiveSavingsMessage');
                
                savingList.innerHTML = '';
                
                if (savings.length === 0) {
                    savingList.style.display = 'none';
                    noSavingsMessage.style.display = 'block';
                    showModal(withdrawCapitalModal);
                    return;
                }
                
                let hasActiveSavings = false;
                
                savings.forEach((saving, index) => {
                    if (saving.active) {
                        hasActiveSavings = true;
                        
                        const amount = parseFloat(web3.utils.fromWei(saving.amount, 'ether')).toFixed(2);
                        const accumulated = parseFloat(web3.utils.fromWei(saving.accumulatedReward, 'ether')).toFixed(4);
                        
                        const savingItem = document.createElement('div');
                        savingItem.className = 'cycle-item';
                        savingItem.dataset.savingId = index;
                        savingItem.innerHTML = `
                            <div class="cycle-info">
                                <div>
                                    <div class="cycle-amount">${amount} USDT</div>
                                    <div class="cycle-plan">Accumulated: ${accumulated} USDT</div>
                                </div>
                                <div>
                                    <input type="radio" name="savingSelect" class="saving-radio" data-saving-id="${index}">
                                </div>
                            </div>
                        `;
                        
                        savingList.appendChild(savingItem);
                    }
                });
                
                if (!hasActiveSavings) {
                    savingList.style.display = 'none';
                    noSavingsMessage.style.display = 'block';
                } else {
                    savingList.style.display = 'block';
                    noSavingsMessage.style.display = 'none';
                }
                
                // Add event listeners to radio buttons
                document.querySelectorAll('.saving-radio[name="savingSelect"]').forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        if (e.target.checked) {
                            selectedSavingForWithdraw = e.target.getAttribute('data-saving-id');
                            // Add selected class to parent item
                            document.querySelectorAll('#withdrawCapitalList .cycle-item').forEach(item => {
                                item.classList.remove('selected');
                            });
                            e.target.closest('.cycle-item').classList.add('selected');
                        }
                    });
                });
                
                showModal(withdrawCapitalModal);
                
            } catch (error) {
                console.error('Error loading savings:', error);
                showNotification('Error loading savings. Please try again.', 'error');
            }
        }

        // ===== BLOCKCHAIN INTERACTION FUNCTIONS =====
        async function loadUserData() {
            if (!userAccount || !contract) return;
            
            try {
                // Load user dashboard info
                const dashboard = await contract.methods.getUserDashboard(userAccount).call();
                
                // Update referral fields
                if (referralAddress) {
                    document.getElementById('cycleReferrer').value = referralAddress;
                    document.getElementById('savingReferrer').value = referralAddress;
                } else if (dashboard.userReferrer !== '0x0000000000000000000000000000000000000000') {
                    document.getElementById('cycleReferrer').value = dashboard.userReferrer;
                    document.getElementById('savingReferrer').value = dashboard.userReferrer;
                }
                
                // Update stats
                const formatUSDT = (weiValue) => {
                    const value = parseFloat(web3.utils.fromWei(weiValue, 'ether'));
                    return value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                };
                
                document.getElementById('cycleTotalEarned').textContent = `${formatUSDT(dashboard.cycleRewards)} USDT`;
                document.getElementById('cycleTotalTeam').textContent = dashboard.userReferrals;
                document.getElementById('cycleLevelAchieved').textContent = dashboard.cycleQualificationLevel;
                
                document.getElementById('savingTotalEarned').textContent = `${formatUSDT(dashboard.savingRewards)} USDT`;
                document.getElementById('savingTotalTeam').textContent = dashboard.userReferrals;
                document.getElementById('savingLevelAchieved').textContent = dashboard.savingQualificationLevel;
                
                // Update qualification badges
                updateQualificationBadges(dashboard);
                
                // Load cycles and savings
                await loadUserCycles();
                await loadUserSavings();
                
            } catch (error) {
                console.error('Error loading user data:', error);
                showNotification('Error loading user data. Please refresh the page.', 'error');
            }
        }

        function updateQualificationBadges(dashboard) {
            // Update cycle qualification badges
            for (let i = 1; i <= 4; i++) {
                const levelElement = document.getElementById(`cycleLevel${i}`);
                if (levelElement) {
                    const badge = levelElement.querySelector('.qualification-badge');
                    if (badge) {
                        if (dashboard.cycleQualificationLevel >= i) {
                            badge.className = 'qualification-badge qualification-achieved';
                            badge.innerHTML = '<i class="fas fa-check-circle"></i> Qualified';
                        } else {
                            badge.className = 'qualification-badge qualification-pending';
                            badge.innerHTML = '<i class="fas fa-clock"></i> Not Qualified';
                        }
                    }
                }
            }
            
            // Update saving qualification badges
            for (let i = 1; i <= 4; i++) {
                const levelElement = document.getElementById(`savingLevel${i}`);
                if (levelElement) {
                    const badge = levelElement.querySelector('.qualification-badge');
                    if (badge) {
                        if (dashboard.savingQualificationLevel >= i) {
                            badge.className = 'qualification-badge qualification-achieved';
                            badge.innerHTML = '<i class="fas fa-check-circle"></i> Qualified';
                        } else {
                            badge.className = 'qualification-badge qualification-pending';
                            badge.innerHTML = '<i class="fas fa-clock"></i> Not Qualified';
                        }
                    }
                }
            }
        }

        async function loadUserCycles() {
            if (!userAccount || !contract) return;
            
            try {
                const cycles = await contract.methods.getUserCycleInvestments(userAccount).call();
                
                if (cycles.length === 0) {
                    document.getElementById('noCyclesAlert').style.display = 'flex';
                    document.getElementById('cyclesTable').style.display = 'none';
                    return;
                }
                
                document.getElementById('noCyclesAlert').style.display = 'none';
                document.getElementById('cyclesTable').style.display = 'table';
                
                const tbody = document.getElementById('cyclesTableBody');
                tbody.innerHTML = '';
                
                const planNames = ['1 Day', '7 Days', '14 Days', '30 Days'];
                
                cycles.forEach((cycle, index) => {
                    const isClaimed = cycle.claimed;
                    const claimable = cycle.claimable;
                    const endTime = parseInt(cycle.endTime);
                    const now = Math.floor(Date.now() / 1000);
                    
                    const totalReturn = parseFloat(web3.utils.fromWei(cycle.totalReturn, 'ether')).toFixed(2);
                    const planName = planNames[parseInt(cycle.plan)] || 'Unknown';
                    const amount = parseFloat(web3.utils.fromWei(cycle.amount, 'ether')).toFixed(2);
                    
                    // Calculate time left or show Ready
                    let timeDisplay = '';
                    let status = 'Active';
                    let statusClass = 'status-active';
                    
                    if (isClaimed) {
                        status = 'Claimed';
                        statusClass = 'status-exp';
                        timeDisplay = 'Claimed';
                    } else if (claimable) {
                        status = 'Ready';
                        statusClass = 'status-ready';
                        timeDisplay = 'Ready';
                    } else {
                        // Calculate countdown timer
                        const timeLeft = endTime - now;
                        if (timeLeft <= 0) {
                            status = 'Ready';
                            statusClass = 'status-ready';
                            timeDisplay = 'Ready';
                        } else {
                            const days = Math.floor(timeLeft / (24 * 60 * 60));
                            const hours = Math.floor((timeLeft % (24 * 60 * 60)) / (60 * 60));
                            const minutes = Math.floor((timeLeft % (60 * 60)) / 60);
                            const seconds = timeLeft % 60;
                            
                            timeDisplay = `${days}d ${hours}h ${minutes}m ${seconds}s`;
                            
                            // Update timer every second
                            setTimeout(() => {
                                updateCycleTimer(index, endTime);
                            }, 1000);
                        }
                    }
                    
                    const row = document.createElement('tr');
                    row.id = `cycle-row-${index}`;
                    row.innerHTML = `
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                        <td>${amount} USDT</td>
                        <td>${planName}</td>
                        <td><span class="timer" id="cycle-timer-${index}">${timeDisplay}</span></td>
                        <td>${totalReturn} USDT</td>
                    `;
                    tbody.appendChild(row);
                });
                
            } catch (error) {
                console.error('Error loading cycles:', error);
                showNotification('Error loading cycles. Please refresh the page.', 'error');
            }
        }

        function updateCycleTimer(cycleId, endTime) {
            const timerElement = document.getElementById(`cycle-timer-${cycleId}`);
            if (!timerElement) return;
            
            const now = Math.floor(Date.now() / 1000);
            const timeLeft = endTime - now;
            
            if (timeLeft <= 0) {
                timerElement.textContent = 'Ready';
                // Update status to Ready
                const row = document.getElementById(`cycle-row-${cycleId}`);
                if (row) {
                    const statusBadge = row.querySelector('.status-badge');
                    if (statusBadge) {
                        statusBadge.textContent = 'Ready';
                        statusBadge.className = 'status-badge status-ready';
                    }
                }
                return;
            }
            
            const days = Math.floor(timeLeft / (24 * 60 * 60));
            const hours = Math.floor((timeLeft % (24 * 60 * 60)) / (60 * 60));
            const minutes = Math.floor((timeLeft % (60 * 60)) / 60);
            const seconds = timeLeft % 60;
            
            timerElement.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            
            // Update every second
            setTimeout(() => {
                updateCycleTimer(cycleId, endTime);
            }, 1000);
        }

        async function loadUserSavings() {
            if (!userAccount || !contract) return;
            
            try {
                const savings = await contract.methods.getUserSavingInvestments(userAccount).call();
                
                if (savings.length === 0) {
                    document.getElementById('noSavingsAlert').style.display = 'flex';
                    document.getElementById('savingsTable').style.display = 'none';
                    return;
                }
                
                document.getElementById('noSavingsAlert').style.display = 'none';
                document.getElementById('savingsTable').style.display = 'table';
                
                const tbody = document.getElementById('savingsTableBody');
                tbody.innerHTML = '';
                
                savings.forEach((saving, index) => {
                    const isActive = saving.active;
                    
                    const amount = parseFloat(web3.utils.fromWei(saving.amount, 'ether')).toFixed(2);
                    const percent = parseFloat(saving.currentPercent) / 10;
                    const accumulated = parseFloat(web3.utils.fromWei(saving.accumulatedReward, 'ether')).toFixed(4);
                    
                    const status = isActive ? 'Active' : 'Inactive';
                    const statusClass = isActive ? 'status-active' : 'status-exp';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                        <td>${amount} USDT</td>
                        <td>${percent.toFixed(2)}%</td>
                        <td>${accumulated} USDT</td>
                    `;
                    tbody.appendChild(row);
                });
                
            } catch (error) {
                console.error('Error loading savings:', error);
                showNotification('Error loading savings. Please refresh the page.', 'error');
            }
        }

        async function confirmCycleInvestment() {
            if (!userAccount || !contract || !usdtContract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const amount = parseFloat(document.getElementById('cycleAmount').value);
            if (isNaN(amount) || amount < currentCycleMinAmount) {
                showNotification(`Minimum investment is ${currentCycleMinAmount} USDT!`, 'error');
                return;
            }
            
            if (!selectedCyclePlan) {
                showNotification('Please select a plan!', 'error');
                return;
            }
            
            const confirmCycleBtn = document.getElementById('confirmCycle');
            showButtonLoading(confirmCycleBtn, true);
            
            try {
                const amountInWei = web3.utils.toWei(amount.toString(), 'ether');
                const referrer = document.getElementById('cycleReferrer').value || '0x0000000000000000000000000000000000000000';
                
                // Check allowance and approve if needed
                const allowance = await usdtContract.methods.allowance(userAccount, CONTRACT_ADDRESS).call();
                if (BigInt(allowance) < BigInt(amountInWei)) {
                    showNotification('Approving USDT...', 'info');
                    const approveTx = await usdtContract.methods.approve(CONTRACT_ADDRESS, web3.utils.toWei((amount * 1000).toString(), 'ether')).send({ 
                        from: userAccount,
                        gas: 100000 
                    });
                    if (!approveTx.status) {
                        throw new Error('USDT approval failed');
                    }
                }
                
                showNotification('Processing Cycle Investment...', 'info');
                const tx = await contract.methods.depositCycle(amountInWei, selectedCyclePlan, referrer).send({ 
                    from: userAccount,
                    gas: 500000 
                });
                
                if (tx.status) {
                    showNotification('Cycle investment successful!', 'success');
                    showPopup(successPopup);
                    await loadUserData();
                    await loadContractStats();
                    // Reset form
                    document.getElementById('cycleAmount').value = '';
                    selectedCyclePlan = null;
                    document.getElementById('cycleDropdown').querySelector('.dropdown-selected').innerHTML = '<span>Select Plan</span><i class="fas fa-chevron-down"></i>';
                    document.getElementById('cycleRoiCalculator').style.display = 'none';
                } else {
                    throw new Error('Transaction failed');
                }
                
            } catch (error) {
                console.error('Cycle investment error:', error);
                showNotification('Transaction failed: ' + (error.message || 'Unknown error'), 'error');
            } finally {
                showButtonLoading(confirmCycleBtn, false);
            }
        }

        async function confirmSavingInvestment() {
            if (!userAccount || !contract || !usdtContract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const amount = parseFloat(document.getElementById('savingAmount').value);
            if (isNaN(amount) || amount < 5) {
                showNotification('Minimum investment is 5 USDT!', 'error');
                return;
            }
            
            const confirmSavingBtn = document.getElementById('confirmSaving');
            showButtonLoading(confirmSavingBtn, true);
            
            try {
                const amountInWei = web3.utils.toWei(amount.toString(), 'ether');
                const referrer = document.getElementById('savingReferrer').value || '0x0000000000000000000000000000000000000000';
                
                // Check allowance and approve if needed
                const allowance = await usdtContract.methods.allowance(userAccount, CONTRACT_ADDRESS).call();
                if (BigInt(allowance) < BigInt(amountInWei)) {
                    showNotification('Approving USDT...', 'info');
                    const approveTx = await usdtContract.methods.approve(CONTRACT_ADDRESS, web3.utils.toWei((amount * 1000).toString(), 'ether')).send({ 
                        from: userAccount,
                        gas: 100000 
                    });
                    if (!approveTx.status) {
                        throw new Error('USDT approval failed');
                    }
                }
                
                showNotification('Processing Saving Investment...', 'info');
                const tx = await contract.methods.depositSaving(amountInWei, referrer).send({ 
                    from: userAccount,
                    gas: 500000 
                });
                
                if (tx.status) {
                    showNotification('Saving investment successful!', 'success');
                    showPopup(successPopup);
                    await loadUserData();
                    await loadContractStats();
                    // Reset form
                    document.getElementById('savingAmount').value = '';
                } else {
                    throw new Error('Transaction failed');
                }
                
            } catch (error) {
                console.error('Saving investment error:', error);
                showNotification('Transaction failed: ' + (error.message || 'Unknown error'), 'error');
            } finally {
                showButtonLoading(confirmSavingBtn, false);
            }
        }

        async function confirmWithdrawCycles() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            if (selectedCycleForWithdraw.length === 0) {
                showNotification('Please select at least one cycle to withdraw', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmWithdrawCycles');
            showButtonLoading(confirmBtn, true);
            
            try {
                showNotification('Withdrawing cycles...', 'info');
                
                // Withdraw each selected cycle
                let successCount = 0;
                for (const cycleId of selectedCycleForWithdraw) {
                    try {
                        const tx = await contract.methods.claimCycle(cycleId).send({ 
                            from: userAccount,
                            gas: 200000 
                        });
                        if (tx.status) {
                            successCount++;
                        }
                    } catch (error) {
                        console.error(`Error withdrawing cycle ${cycleId}:`, error);
                    }
                }
                
                if (successCount > 0) {
                    showNotification(`Successfully withdrew ${successCount} cycle(s)!`, 'success');
                } else {
                    showNotification('Failed to withdraw cycles', 'error');
                }
                
                hideModal(withdrawCycleModal);
                await loadUserData();
                await loadContractStats();
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdraw failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmBtn, false);
            }
        }

        async function confirmRegrowModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            if (selectedCycleForRegrow === null) {
                showNotification('Please select a cycle to regrow', 'error');
                return;
            }
            
            if (selectedRegrowPlan === null) {
                showNotification('Please select a new plan for regrow', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmRegrowModal');
            showButtonLoading(confirmBtn, true);
            
            try {
                showNotification('Processing regrow...', 'info');
                const tx = await contract.methods.regrow(selectedCycleForRegrow, selectedRegrowPlan).send({ 
                    from: userAccount,
                    gas: 300000 
                });
                
                if (tx.status) {
                    showNotification('Regrow successful!', 'success');
                    hideModal(regrowCycleModal);
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Regrow failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Regrow failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmBtn, false);
            }
        }

        async function confirmWithdrawCapital() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            if (selectedSavingForWithdraw === null) {
                showNotification('Please select a saving to withdraw capital from', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmWithdrawCapital');
            showButtonLoading(confirmBtn, true);
            
            try {
                showNotification('Withdrawing capital...', 'info');
                const tx = await contract.methods.capitalSaving(selectedSavingForWithdraw).send({ 
                    from: userAccount,
                    gas: 200000 
                });
                
                if (tx.status) {
                    showNotification('Capital withdrawn successfully!', 'success');
                    hideModal(withdrawCapitalModal);
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Capital withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmBtn, false);
            }
        }

        async function withdrawSavingRewards() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const withdrawBtn = document.getElementById('withdrawSaving');
            showButtonLoading(withdrawBtn, true);
            
            try {
                showNotification('Withdrawing saving rewards...', 'info');
                const tx = await contract.methods.claimSaving().send({ 
                    from: userAccount,
                    gas: 200000 
                });
                
                if (tx.status) {
                    showNotification('Saving rewards withdrawn successfully!', 'success');
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(withdrawBtn, false);
            }
        }

        async function withdrawCycleReferral() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const withdrawBtn = document.getElementById('withdrawCycleReferral');
            showButtonLoading(withdrawBtn, true);
            
            try {
                showNotification('Withdrawing cycle referral rewards...', 'info');
                const tx = await contract.methods.rewardCycle().send({ 
                    from: userAccount,
                    gas: 200000 
                });
                
                if (tx.status) {
                    showNotification('Cycle referral rewards withdrawn successfully!', 'success');
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(withdrawBtn, false);
            }
        }

        async function withdrawSavingReferral() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const withdrawBtn = document.getElementById('withdrawSavingReferral');
            showButtonLoading(withdrawBtn, true);
            
            try {
                showNotification('Withdrawing saving referral rewards...', 'info');
                const tx = await contract.methods.rewardSaving().send({ 
                    from: userAccount,
                    gas: 200000 
                });
                
                if (tx.status) {
                    showNotification('Saving referral rewards withdrawn successfully!', 'success');
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(withdrawBtn, false);
            }
        }

        // Initialize with home section
        showSection('home');
    </script>
</body>
</html>
