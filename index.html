<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auvex Protocol - Autonomous Wealth Automation</title>
    <meta name="description" content="Decentralized asset management via secure algorithmic cycles and liquid savings on Binance Smart Chain">
    <link rel="icon" type="image/x-icon" href="image/logo.png">
    
    <!-- Font & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bignumber.js@9.1.2/bignumber.min.js"></script>

    <style>
        /* ===== VARIABLES ===== */
        :root {
            /* Dark Burnt Orange to Amber to Soft Gold Palette - More Dark & Elegant */
            --bg-deep: #0A0603;
            --bg-card: rgba(20, 12, 6, 0.9);
            --bg-card-hover: rgba(30, 18, 9, 0.95);
            
            --primary-accent: #D45D00;
            --secondary-accent: #FF8C42;
            --gold-glow: #E8B54D;
            --amber: #CC7A00;
            --dark-orange: #B34D00;
            --burnt-orange: #8B3A00;
            
            --text-main: #ffffff;
            --text-muted: #d4ccc0;
            --text-dark: #0f0a06;

            --gradient-main: linear-gradient(135deg, #8B3A00 0%, #D45D00 50%, #FF6B35 100%);
            --gradient-gold: linear-gradient(135deg, #D45D00 0%, #E8B54D 50%, #FFD166 100%);
            --gradient-dark: linear-gradient(180deg, #140C06 0%, #0A0603 100%);
            --gradient-burnt: linear-gradient(135deg, #5A2500 0%, #8B3A00 50%, #D45D00 100%);
            
            --glass-border: 1px solid rgba(139, 58, 0, 0.3);
            --glass-shine: 1px solid rgba(232, 181, 77, 0.15);
            
            --shadow-subtle: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
            --shadow-card: 0 10px 40px 0 rgba(0, 0, 0, 0.7);
            --shadow-elevated: 0 25px 70px rgba(0, 0, 0, 0.9);
            --shadow-deep: 0 0 50px rgba(90, 37, 0, 0.4);

            /* Typography */
            --font-body: 'Outfit', sans-serif;
            --font-heading: 'Space Grotesk', sans-serif;

            /* Spacing & Radius */
            --radius-sm: 10px;
            --radius-md: 14px;
            --radius-lg: 20px;
            --radius-xl: 30px;
            --radius-full: 100px;
            
            --container-width: 1200px;
            --header-height: 85px;
        }

        /* ===== RESET & BASE ===== */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            outline: none; 
            -webkit-tap-highlight-color: transparent; 
        }

        html { 
            scroll-behavior: smooth; 
            font-size: 16px; 
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-deep);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(139, 58, 0, 0.1) 0%, transparent 30%),
                radial-gradient(circle at 90% 80%, rgba(212, 93, 0, 0.08) 0%, transparent 30%),
                linear-gradient(135deg, rgba(10, 6, 3, 0.95) 0%, rgba(20, 12, 6, 0.98) 100%);
            background-attachment: fixed;
            color: var(--text-main);
            line-height: 1.7;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-deep); }
        ::-webkit-scrollbar-thumb { 
            background: var(--gradient-burnt); 
            border-radius: 4px;
            border: 1px solid var(--bg-deep);
        }
        ::-webkit-scrollbar-thumb:hover { 
            background: var(--gradient-main); 
        }

        /* Container */
        .container {
            max-width: var(--container-width);
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Typography */
        h1, h2, h3, h4 { 
            font-family: var(--font-heading); 
            color: var(--text-main); 
            line-height: 1.2; 
            letter-spacing: -0.5px;
        }

        .gradient-text {
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: inline-block;
            font-weight: 700;
        }

        .auvex-headline {
            font-family: var(--font-heading);
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #E8B54D 0%, #CC7A00 50%, #D45D00 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.1;
            margin-bottom: 20px;
        }

        .auvex-subheadline {
            font-family: var(--font-body);
            font-size: 1.2rem;
            color: var(--text-muted);
            font-weight: 300;
            letter-spacing: 0.5px;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* ===== PRELOADER ===== */
        .preloader {
            position: fixed; 
            inset: 0;
            background: linear-gradient(135deg, #0A0603 0%, #140C06 100%);
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            z-index: 9999;
            transition: opacity 0.6s ease, visibility 0.6s ease;
        }
        .preloader.fade-out { 
            opacity: 0; 
            visibility: hidden; 
        }

        .loader-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin-bottom: 30px;
        }

        .loader {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px solid transparent;
            border-top: 3px solid var(--primary-accent);
            border-right: 3px solid var(--secondary-accent);
            border-bottom: 3px solid var(--gold-glow);
            animation: spin 1.5s linear infinite;
        }

        .loader-inner {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border-radius: 50%;
            border: 2px solid transparent;
            border-top: 2px solid var(--secondary-accent);
            border-right: 2px solid var(--gold-glow);
            animation: spin-reverse 1s linear infinite;
        }

        .loader-core {
            position: absolute;
            top: 25px;
            left: 25px;
            right: 25px;
            bottom: 25px;
            border-radius: 50%;
            background: var(--gradient-burnt);
            animation: pulse-core 2s ease-in-out infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes spin-reverse {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-360deg); }
        }

        @keyframes pulse-core {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        .preloader-text { 
            font-family: var(--font-heading); 
            font-size: 2.2rem; 
            letter-spacing: 4px; 
            font-weight: 800; 
            color: transparent;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 30px rgba(232, 181, 77, 0.3);
        }

        /* ===== HEADER & NAVIGATION ===== */
        .header {
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0;
            height: var(--header-height);
            background: rgba(10, 6, 3, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(139, 58, 0, 0.2);
            z-index: 1000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .header.scrolled {
            height: 70px;
            background: rgba(10, 6, 3, 0.95);
            border-bottom: 1px solid rgba(212, 93, 0, 0.2);
        }

        .nav { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            height: 100%; 
        }

        .nav__logo { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            text-decoration: none; 
            transition: transform 0.3s ease;
        }
        .nav__logo:hover { 
            transform: translateY(-1px); 
        }
        .logo { 
            width: 40px; 
            height: 40px; 
            transition: all 0.4s ease; 
        }
        .nav__logo:hover .logo { 
            transform: rotate(15deg) scale(1.05); 
        }
        .logo__text { 
            font-size: 1.4rem; 
            font-weight: 800; 
            letter-spacing: 1px; 
            color: transparent;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            background-clip: text;
            font-family: var(--font-heading); 
        }

        .nav__menu { 
            display: flex; 
            align-items: center; 
            gap: 30px; 
        }
        .nav__list { 
            display: flex; 
            list-style: none; 
            gap: 30px; 
        }

        .nav__link {
            color: var(--text-muted);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            padding: 8px 0;
        }
        .nav__link:hover, 
        .nav__link.active { 
            color: var(--gold-glow); 
        }
        .nav__link::after {
            content: ''; 
            position: absolute; 
            bottom: 0; 
            left: 0;
            width: 0; 
            height: 2px; 
            background: var(--gradient-gold);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            border-radius: 2px;
        }
        .nav__link:hover::after, 
        .nav__link.active::after { 
            width: 100%; 
        }

        /* Hamburger Menu */
        .nav__toggle { 
            display: none; 
            font-size: 1.6rem; 
            color: var(--gold-glow); 
            cursor: pointer; 
            padding: 10px;
            background: rgba(139, 58, 0, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(212, 93, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 1001;
        }
        .nav__toggle:hover { 
            background: rgba(212, 93, 0, 0.1);
            border-color: var(--primary-accent);
        }

        .mobile-menu {
            position: fixed;
            top: var(--header-height);
            right: -100%;
            width: 300px;
            height: calc(100vh - var(--header-height));
            background: rgba(20, 12, 6, 0.98);
            backdrop-filter: blur(25px);
            border-left: 1px solid rgba(139, 58, 0, 0.3);
            padding: 30px;
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            overflow-y: auto;
        }

        .mobile-menu.active {
            right: 0;
        }

        .mobile-menu ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .mobile-menu a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 1.1rem;
            padding: 12px 18px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-radius: var(--radius-md);
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .mobile-menu a i {
            width: 24px;
            text-align: center;
            color: var(--amber);
        }

        .mobile-menu a:hover,
        .mobile-menu a.active {
            background: rgba(212, 93, 0, 0.1);
            color: var(--gold-glow);
            transform: translateX(8px);
            border: 1px solid rgba(212, 93, 0, 0.2);
        }

        /* Wallet Button */
        #connectWallet {
            margin-left: 15px;
        }

        /* ===== BUTTONS ===== */
        .btn {
            display: inline-flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px;
            padding: 14px 30px;
            border-radius: var(--radius-full);
            font-weight: 600; 
            font-size: 0.95rem; 
            font-family: var(--font-body);
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none; 
            position: relative; 
            overflow: hidden; 
            border: none;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .btn--primary {
            background: var(--gradient-main);
            color: white;
            box-shadow: 0 4px 15px rgba(212, 93, 0, 0.3);
        }
        .btn--primary:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(212, 93, 0, 0.4);
        }

        .btn--outline {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 93, 0, 0.3);
            color: var(--text-main);
            backdrop-filter: blur(10px);
        }
        .btn--outline:hover {
            background: rgba(212, 93, 0, 0.15);
            border-color: var(--primary-accent);
            transform: translateY(-2px);
        }

        .btn-sm { padding: 10px 20px; font-size: 0.9rem; }
        .btn-lg { padding: 16px 40px; font-size: 1.05rem; }
        .btn-xl { padding: 20px 45px; font-size: 1.1rem; font-weight: 700; }

        /* Button Loading Spinner */
        .btn .loading-spinner {
            display: none;
            animation: spin 1s linear infinite;
        }

        .btn.loading {
            position: relative;
            color: transparent;
        }

        .btn.loading .loading-spinner {
            display: inline-block;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            color: white;
        }

        /* ===== SECTIONS ===== */
        .section { 
            padding-top: 120px; 
            padding-bottom: 80px; 
            min-height: 100vh;
            display: flex; 
            flex-direction: column;
            justify-content: flex-start;
        }

        .section__header { 
            text-align: center; 
            margin-bottom: 60px; 
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
            position: relative;
        }

        .section__title {
            font-size: 3rem; 
            margin-bottom: 20px; 
            font-weight: 800;
            background: linear-gradient(to right, #D45D00, #E8B54D);
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent;
        }

        .section__subtitle { 
            color: var(--text-muted); 
            font-size: 1.1rem; 
            margin-bottom: 10px;
            line-height: 1.6;
            font-weight: 300;
        }

        /* ===== HOME SECTION ===== */
        #home { 
            padding-top: 160px; 
            justify-content: center;
            min-height: 100vh;
            position: relative;
            overflow: hidden;
        }

        #home::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 58, 0, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(212, 93, 0, 0.06) 0%, transparent 40%);
            pointer-events: none;
        }

        .hero__container { 
            display: grid; 
            grid-template-columns: 1.2fr 0.8fr; 
            gap: 60px; 
            align-items: center; 
        }

        .badge {
            background: rgba(139, 58, 0, 0.2); 
            border: 1px solid rgba(212, 93, 0, 0.3);
            color: #E8B54D; 
            padding: 8px 20px; 
            border-radius: var(--radius-full);
            font-size: 0.85rem; 
            font-weight: 600; 
            letter-spacing: 0.5px; 
            margin-bottom: 25px; 
            display: inline-block;
            backdrop-filter: blur(10px);
        }

        .hero__title { 
            font-size: 3.5rem; 
            line-height: 1.1; 
            margin-bottom: 25px; 
            font-weight: 800; 
        }

        .hero__headline {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--gold-glow);
        }

        .hero__description { 
            color: var(--text-muted); 
            font-size: 1.1rem; 
            margin-bottom: 40px; 
            max-width: 90%; 
            line-height: 1.7;
        }

        .hero__buttons { 
            display: flex; 
            gap: 20px; 
            margin-bottom: 40px; 
        }

        /* Added spacing between text and buttons */
        .auvex-subheadline {
            margin-bottom: 35px !important;
        }

        /* Stats Card */
        .floating-card {
            padding: 35px; 
            border-radius: var(--radius-xl);
            background: linear-gradient(160deg, rgba(30, 18, 9, 0.9) 0%, rgba(20, 12, 6, 0.95) 100%);
            border: 1px solid rgba(139, 58, 0, 0.3);
            animation: float-hero 8s ease-in-out infinite;
            position: relative;
            width: 100%;
            backdrop-filter: blur(15px);
            box-shadow: var(--shadow-subtle);
        }

        @keyframes float-hero {
            0%, 100% { 
                transform: translateY(0) rotate(0deg); 
            }
            33% { 
                transform: translateY(-10px) rotate(0.5deg); 
            }
            66% { 
                transform: translateY(-20px) rotate(-0.5deg); 
            }
        }

        .card__header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 25px; 
            padding-bottom: 15px; 
            border-bottom: 1px solid rgba(139, 58, 0, 0.3);
        }
        .card__header h3 { 
            font-size: 1.4rem; 
            font-weight: 700; 
            margin: 0;
            text-align: left;
            flex: 1;
            color: var(--gold-glow);
        }

        .live-indicator { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            color: #00cc66; 
            font-weight: 700; 
            font-size: 0.85rem; 
            white-space: nowrap;
        }
        .dot { 
            width: 8px; 
            height: 8px; 
            background: #00cc66; 
            border-radius: 50%; 
            animation: blink 2s infinite; 
        }

        @keyframes blink {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.6; 
                transform: scale(0.8);
            }
        }

        .stat-item { 
            display: flex; 
            justify-content: space-between; 
            padding: 16px 0; 
            border-bottom: 1px solid rgba(255, 255, 255, 0.05); 
        }
        .stat-item:last-child { 
            border-bottom: none; 
        }
        .stat-item .label { 
            color: var(--text-muted); 
            font-size: 0.95rem; 
        }
        .stat-item .value { 
            color: var(--gold-glow); 
            font-weight: 700; 
            font-family: var(--font-heading); 
            font-size: 1.2rem; 
        }

        /* ===== CYCLE & SAVING SECTIONS ===== */
        .investment-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 60px;
        }

        .investment-form-container {
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.95), rgba(20, 12, 6, 0.98));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(139, 58, 0, 0.3);
            border-radius: var(--radius-xl);
            padding: 35px;
            box-shadow: var(--shadow-card);
            position: relative;
            overflow: hidden;
        }

        .investment-dashboard {
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.95), rgba(20, 12, 6, 0.98));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(139, 58, 0, 0.3);
            border-radius: var(--radius-xl);
            padding: 35px;
            box-shadow: var(--shadow-card);
            position: relative;
            overflow: hidden;
        }

        /* Plan Cards */
        .plan-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .plan-option {
            padding: 22px;
            background: linear-gradient(145deg, rgba(40, 25, 12, 0.8), rgba(30, 18, 9, 0.9));
            border: 1px solid rgba(139, 58, 0, 0.2);
            border-radius: var(--radius-lg);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .plan-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: 0.6s;
        }

        .plan-option:hover::before {
            left: 100%;
        }

        .plan-option:hover {
            background: linear-gradient(145deg, rgba(50, 30, 14, 0.9), rgba(40, 25, 12, 0.95));
            border-color: var(--primary-accent);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(139, 58, 0, 0.2);
        }

        .plan-option.selected {
            background: linear-gradient(145deg, rgba(60, 35, 16, 0.95), rgba(50, 30, 14, 0.98));
            border-color: var(--primary-accent);
            box-shadow: 0 0 20px rgba(212, 93, 0, 0.3);
        }

        .plan-duration {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--gold-glow);
            margin-bottom: 8px;
        }

        .plan-return {
            font-size: 1rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Custom Dropdown - FIXED */
        .custom-dropdown {
            position: relative;
            width: 100%;
        }

        .dropdown-selected {
            width: 100%; 
            padding: 16px 20px; 
            border-radius: var(--radius-md);
            background: rgba(15, 10, 5, 0.7); 
            border: 1px solid rgba(139, 58, 0, 0.3);
            color: var(--text-main); 
            font-family: var(--font-body); 
            font-size: 1.05rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 54px;
        }

        .dropdown-selected i {
            transition: transform 0.3s ease;
            color: var(--amber);
        }

        .dropdown-selected.open i {
            transform: rotate(180deg);
        }

        .dropdown-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(20, 12, 6, 0.98);
            border: 1px solid rgba(139, 58, 0, 0.3);
            border-radius: var(--radius-md);
            margin-top: 5px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            z-index: 100;
            backdrop-filter: blur(20px);
            overflow-y: auto;
        }

        .dropdown-options.show {
            max-height: 350px;
        }

        .dropdown-option {
            padding: 14px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-muted);
        }

        .dropdown-option:hover {
            background: rgba(212, 93, 0, 0.1);
            color: var(--gold-glow);
        }

        /* Forms */
        .form-group {
            margin-bottom: 25px;
            text-align: left;
            width: 100%;
            position: relative;
        }

        .form-group label { 
            display: block; 
            margin-bottom: 10px; 
            color: var(--gold-glow); 
            font-size: 0.95rem; 
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .form-input {
            width: 100%; 
            padding: 16px 18px; 
            border-radius: var(--radius-md);
            background: rgba(15, 10, 5, 0.7); 
            border: 1px solid rgba(139, 58, 0, 0.3);
            color: var(--text-main); 
            font-family: var(--font-body); 
            font-size: 1.05rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .form-input:focus { 
            border-color: var(--primary-accent); 
            background: rgba(25, 15, 5, 0.8);
            box-shadow: 0 0 15px rgba(212, 93, 0, 0.2);
        }

        .form-input:disabled {
            background: rgba(25, 15, 5, 0.5);
            border-color: rgba(139, 58, 0, 0.2);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        /* Scrollable Tables for Mobile */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-radius: var(--radius-md);
            margin: 20px 0;
        }

        /* Active Cycles Dashboard */
        #cyclesTable {
            min-width: 600px;
        }

        #cyclesTable th:nth-child(1),
        #cyclesTable td:nth-child(1) {
            min-width: 100px;
        }
        #cyclesTable th:nth-child(2),
        #cyclesTable td:nth-child(2) {
            min-width: 100px;
        }
        #cyclesTable th:nth-child(3),
        #cyclesTable td:nth-child(3) {
            min-width: 100px;
        }
        #cyclesTable th:nth-child(4),
        #cyclesTable td:nth-child(4) {
            min-width: 150px;
        }
        #cyclesTable th:nth-child(5),
        #cyclesTable td:nth-child(5) {
            min-width: 100px;
        }

        /* Active Savings Dashboard */
        #savingsTable {
            min-width: 600px;
        }

        #savingsTable th:nth-child(1),
        #savingsTable td:nth-child(1) {
            min-width: 100px;
        }
        #savingsTable th:nth-child(2),
        #savingsTable td:nth-child(2) {
            min-width: 100px;
        }
        #savingsTable th:nth-child(3),
        #savingsTable td:nth-child(3) {
            min-width: 80px;
        }
        #savingsTable th:nth-child(4),
        #savingsTable td:nth-child(4) {
            min-width: 120px;
        }

        /* Status Badges */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-active {
            background: rgba(0, 204, 102, 0.1);
            color: #00cc66;
            border: 1px solid rgba(0, 204, 102, 0.2);
        }

        .status-ready {
            background: rgba(232, 181, 77, 0.1);
            color: var(--gold-glow);
            border: 1px solid rgba(232, 181, 77, 0.2);
        }

        .status-exp {
            background: rgba(255, 68, 68, 0.1);
            color: #ff4444;
            border: 1px solid rgba(255, 68, 68, 0.2);
        }

        /* Timer */
        .timer {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: var(--gold-glow);
            font-size: 0.9rem;
        }

        /* Referral Link Box */
        .referral-link-box {
            background: rgba(15, 10, 5, 0.5);
            border: 1px solid rgba(139, 58, 0, 0.3);
            border-radius: var(--radius-md);
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .referral-link {
            flex: 1;
            padding: 10px 15px;
            background: rgba(20, 12, 6, 0.5);
            border-radius: var(--radius-sm);
            color: var(--text-muted);
            font-family: monospace;
            font-size: 0.9rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .copy-btn {
            padding: 10px 20px;
            background: var(--gradient-main);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            transform: translateY(-1px);
        }

        /* Investment Tables */
        .investment-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            background: rgba(15, 10, 5, 0.5);
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        .investment-table th {
            background: linear-gradient(90deg, rgba(139, 58, 0, 0.2), rgba(212, 93, 0, 0.1));
            color: var(--gold-glow);
            padding: 18px 15px;
            text-align: left;
            font-weight: 700;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid rgba(139, 58, 0, 0.3);
        }

        .investment-table td {
            padding: 18px 15px;
            border-bottom: 1px solid rgba(139, 58, 0, 0.1);
            color: var(--text-muted);
            font-size: 0.95rem;
            vertical-align: middle;
        }

        .investment-table tr:hover {
            background: rgba(212, 93, 0, 0.05);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        /* Referral Levels */
        .referral-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .referral-level {
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.9), rgba(20, 12, 6, 0.95));
            border: 1px solid rgba(139, 58, 0, 0.2);
            border-radius: var(--radius-lg);
            padding: 22px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .referral-level:hover {
            background: linear-gradient(145deg, rgba(40, 25, 12, 0.95), rgba(30, 18, 9, 0.98));
            border-color: var(--primary-accent);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(139, 58, 0, 0.2);
        }

        .level-number {
            width: 40px;
            height: 40px;
            background: var(--gradient-main);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-weight: 800;
            color: white;
            font-size: 1.1rem;
        }

        .level-percent {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--gold-glow);
            margin-bottom: 8px;
        }

        .level-requirement {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.4;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.95), rgba(20, 12, 6, 0.98));
            border: 1px solid rgba(139, 58, 0, 0.2);
            border-radius: var(--radius-lg);
            padding: 25px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-accent);
            box-shadow: 0 10px 30px rgba(139, 58, 0, 0.2);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            background: rgba(139, 58, 0, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: var(--primary-accent);
            font-size: 1.6rem;
            border: 1px solid rgba(139, 58, 0, 0.3);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gold-glow);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.95rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* ===== POPUP MODALS ===== */
        .popup-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .popup-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.98), rgba(20, 12, 6, 0.99));
            border: 1px solid rgba(139, 58, 0, 0.3);
            border-radius: var(--radius-xl);
            padding: 40px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.8) translateY(50px);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .popup-modal.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            color: var(--gold-glow);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .modal-body {
            margin-bottom: 30px;
        }

        .modal-footer {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .cycle-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            border-radius: var(--radius-md);
            border: 1px solid rgba(139, 58, 0, 0.2);
            background: rgba(15, 10, 5, 0.5);
        }

        .cycle-item {
            padding: 15px;
            border-bottom: 1px solid rgba(139, 58, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cycle-item:hover {
            background: rgba(212, 93, 0, 0.1);
        }

        .cycle-item.selected {
            background: rgba(212, 93, 0, 0.15);
            border-left: 3px solid var(--primary-accent);
        }

        .cycle-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cycle-amount {
            font-weight: 600;
            color: var(--gold-glow);
        }

        .cycle-plan {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .no-cycles {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
        }

        /* ===== ALERTS & NOTIFICATIONS ===== */
        .alert {
            padding: 20px; 
            border-radius: var(--radius-lg); 
            display: flex; 
            align-items: center; 
            gap: 15px;
            margin: 0 auto 30px; 
            font-size: 1.05rem;
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.95), rgba(20, 12, 6, 0.98));
            border: 1px solid rgba(139, 58, 0, 0.3);
            backdrop-filter: blur(15px);
            width: 100%;
            max-width: 800px;
        }
        .alert-warning { 
            background: linear-gradient(145deg, rgba(245, 158, 11, 0.15), rgba(139, 58, 0, 0.1));
            border-color: rgba(245, 158, 11, 0.3); 
            color: #fbbf24; 
        }
        .alert-info { 
            background: linear-gradient(145deg, rgba(212, 93, 0, 0.15), rgba(139, 58, 0, 0.1));
            border-color: rgba(212, 93, 0, 0.3); 
            color: var(--primary-accent); 
        }

        /* Premium Notifications */
        .notification {
            position: fixed; 
            top: 100px; 
            right: 20px; 
            padding: 18px 25px;
            background: linear-gradient(135deg, rgba(139, 58, 0, 0.15), rgba(212, 93, 0, 0.1), rgba(232, 181, 77, 0.05));
            border: 1px solid rgba(139, 58, 0, 0.4);
            color: white; 
            border-radius: var(--radius-lg); 
            z-index: 3000;
            transform: translateX(120%) scale(0.9); 
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(20px); 
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: flex; 
            align-items: center; 
            gap: 15px;
            max-width: 350px;
            word-break: break-word;
            min-width: 280px;
            border-left: 4px solid var(--primary-accent);
        }
        .notification.show { 
            transform: translateX(0) scale(1); 
        }
        .notification.success { 
            background: linear-gradient(135deg, rgba(139, 58, 0, 0.15), rgba(212, 93, 0, 0.1), rgba(232, 181, 77, 0.05));
            border-left: 4px solid #00cc66;
        }
        .notification.error { 
            background: linear-gradient(135deg, rgba(139, 58, 0, 0.15), rgba(212, 93, 0, 0.1), rgba(232, 181, 77, 0.05));
            border-left: 4px solid #ff4444;
        }
        .notification.info { 
            background: linear-gradient(135deg, rgba(139, 58, 0, 0.15), rgba(212, 93, 0, 0.1), rgba(232, 181, 77, 0.05));
            border-left: 4px solid var(--primary-accent);
        }

        /* ===== POPUPS ===== */
        .popup {
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(15px); 
            z-index: 2000;
            display: flex; 
            justify-content: center; 
            align-items: center;
            opacity: 0; 
            visibility: hidden; 
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .popup.active { 
            opacity: 1; 
            visibility: visible; 
        }

        .popup-content { 
            max-width: 500px; 
            width: 90%; 
            padding: 40px; 
            text-align: center; 
            transform: scale(0.8) translateY(50px); 
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.98), rgba(20, 12, 6, 0.99));
            border: 1px solid var(--primary-accent);
            border-radius: var(--radius-xl);
            cursor: default;
            position: relative;
            overflow: hidden;
        }
        .popup.active .popup-content { 
            transform: scale(1) translateY(0); 
        }

        .popup-icon {
            width: 80px; 
            height: 80px; 
            background: var(--gradient-gold); 
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 2rem; 
            color: white;
            margin: 0 auto 25px; 
        }

        /* ===== FOOTER ===== */
        .footer { 
            border-top: 1px solid rgba(139, 58, 0, 0.2); 
            padding: 80px 0 30px; 
            background: linear-gradient(180deg, #0A0603 0%, #140C06 100%);
            margin-top: auto; 
            position: relative;
            overflow: hidden;
        }

        .footer__content {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .footer__logo { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            margin-bottom: 25px; 
            justify-content: center; 
        }
        .footer__logo img { 
            width: 35px; 
            height: 35px; 
        }
        .footer__logo span { 
            font-size: 1.6rem; 
            font-weight: 800; 
            font-family: var(--font-heading); 
            color: transparent;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            background-clip: text;
        }

        .footer__content p {
            color: var(--text-muted); 
            max-width: 600px; 
            margin: 0 auto 30px; 
            line-height: 1.7;
            font-size: 1.05rem;
        }

        .footer__social { 
            display: flex; 
            gap: 15px; 
            margin-top: 30px; 
            justify-content: center; 
        }

        .social__link {
            width: 45px; 
            height: 45px; 
            border-radius: 12px; 
            background: linear-gradient(145deg, rgba(30, 18, 9, 0.9), rgba(20, 12, 6, 0.95));
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: var(--text-muted);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            border: 1px solid rgba(139, 58, 0, 0.2); 
            text-decoration: none;
            font-size: 1.1rem;
        }
        .social__link:hover { 
            background: var(--gradient-main); 
            color: white;
            transform: translateY(-3px); 
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(212, 93, 0, 0.3);
        }

        .footer__bottom { 
            margin-top: 60px; 
            padding-top: 30px; 
            border-top: 1px solid rgba(139, 58, 0, 0.1); 
            text-align: center; 
            color: rgba(255, 255, 255, 0.4); 
            font-size: 0.85rem; 
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .hero__title, .auvex-headline { font-size: 3rem; }
            .section__title { font-size: 2.5rem; }
            .hero__headline { font-size: 2rem; }
        }

        @media (max-width: 968px) {
            .hero__container { 
                grid-template-columns: 1fr; 
                text-align: center; 
                gap: 50px; 
            }
            .hero__content { 
                display: flex; 
                flex-direction: column; 
                align-items: center; 
            }
            .hero__title, .auvex-headline { font-size: 2.5rem; }
            .hero__buttons { 
                justify-content: center; 
                flex-wrap: wrap; 
            }
            .investment-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            .plan-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .section {
                padding-top: 100px; 
                padding-bottom: 60px;
            }

            .nav__menu { 
                display: none;
            }
            
            .nav__toggle { 
                display: flex; 
                align-items: center;
                justify-content: center;
            }
            
            .section__title { font-size: 2rem; }
            .hero__title, .auvex-headline { font-size: 2rem; }
            .hero__headline { font-size: 1.7rem; }
            .hero__description { font-size: 1rem; }
            
            .hero__buttons {
                flex-direction: column;
                width: 100%;
                max-width: 300px;
            }
            
            .hero__buttons .btn {
                width: 100%;
            }
            
            .plan-options {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons .btn {
                width: 100%;
            }
            
            .referral-levels {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .investment-table {
                display: block;
                overflow-x: auto;
            }
            
            .content-container {
                padding: 25px;
            }
            
            .popup-content {
                padding: 30px 20px;
            }
            
            .modal-content {
                padding: 25px;
            }
        }

        @media (max-width: 480px) {
            .hero__title, .auvex-headline { font-size: 1.8rem; }
            .section__title { 
                font-size: 1.7rem; 
            }
            .hero__headline { font-size: 1.5rem; }
            
            .referral-levels {
                grid-template-columns: 1fr;
            }
            
            .content-container {
                padding: 20px 15px;
            }
            
            .popup-content {
                padding: 25px 15px;
            }
            
            .notification {
                min-width: 250px;
                right: 10px;
                left: 10px;
                width: auto;
            }
        }

        @media (max-width: 360px) {
            .hero__headline {
                font-size: 1.4rem;
            }
            
            .stat-value {
                font-size: 1.4rem;
            }
            
            .level-percent {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader">
        <div class="loader-container">
            <div class="loader"></div>
            <div class="loader-inner"></div>
            <div class="loader-core"></div>
        </div>
        <div class="preloader-text">AUVEX</div>
    </div>

    <!-- Header -->
    <header class="header">
        <nav class="nav container">
            <!-- Logo AUVEX -->
            <a href="#home" class="nav__logo">
                <img src="image/logo.png" alt="AUVEX" class="logo" onerror="this.style.display='none'; this.nextElementSibling.style.marginLeft='0'">
                <div class="logo__text">AUVEX</div>
            </a>

            <!-- Desktop Menu -->
            <div class="nav__menu">
                <ul class="nav__list">
                    <li class="nav__item"><a class="nav__link active" data-section="home">Home</a></li>
                    <li class="nav__item"><a class="nav__link" data-section="cycle">Cycle</a></li>
                    <li class="nav__item"><a class="nav__link" data-section="saving">Saving</a></li>
                    <li class="nav__item"><a class="nav__link" data-section="faq">FAQ</a></li>
                </ul>

                <button class="btn btn--primary btn-sm" id="connectWallet">
                    <i class="fas fa-wallet"></i>
                    Connect Wallet
                </button>
            </div>

            <!-- Hamburger Menu Toggle -->
            <div class="nav__toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>

            <!-- Mobile Menu -->
            <div class="mobile-menu" id="mobile-menu">
                <ul>
                    <li><a href="#home" data-section="home" class="active"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#cycle" data-section="cycle"><i class="fas fa-sync-alt"></i> Cycle</a></li>
                    <li><a href="#saving" data-section="saving"><i class="fas fa-piggy-bank"></i> Saving</a></li>
                    <li><a href="#faq" data-section="faq"><i class="fas fa-question-circle"></i> FAQ</a></li>
                    <li>
                        <button class="btn btn--primary" id="connectWalletMobile" style="width: 100%; margin-top: 20px;">
                            <i class="fas fa-wallet"></i>
                            Connect Wallet
                        </button>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Home Section -->
        <section class="section" id="home">
            <div class="container">
                <div class="hero__container">
                    <div class="hero__content">
                        <div class="badge">
                            <i class="fas fa-robot"></i> Autonomous Wealth Automation
                        </div>
                        <h1 class="auvex-headline">Where Capital Meets Code Integrity</h1>
                        <p class="auvex-subheadline">
                            Immutable smart contracts executing investments and rewards with precision, transparency and on-chain integrity
                        </p>
                        <div class="hero__buttons">
                            <button class="btn btn--primary btn-lg" data-section="cycle">
                                <i class="fas fa-sync-alt"></i>
                                Start Cycle
                            </button>
                            <button class="btn btn--outline btn-lg" data-section="saving">
                                <i class="fas fa-piggy-bank"></i>
                                Start Saving
                            </button>
                        </div>
                    </div>
                    <div class="hero__image">
                        <div class="floating-card">
                            <div class="card__header">
                                <h3>Statistics</h3>
                                <div class="live-indicator">
                                    <span class="dot"></span>
                                    Live
                                </div>
                            </div>
                            <div class="card__content">
                                <div class="stat-item">
                                    <span class="label">Liquidity</span>
                                    <span class="value" id="statLiquidity">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Users</span>
                                    <span class="value" id="statTotalUsers">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Investment</span>
                                    <span class="value" id="statTotalInvest">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Paid Out</span>
                                    <span class="value" id="statTotalPaid">Loading...</span>
                                </div>
                                <div class="stat-item">
                                    <span class="label">Scorch Referral</span>
                                    <span class="value" id="statScorchReferral">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Cycle Section -->
        <section class="section" id="cycle" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h1 class="auvex-headline">Cycle Investment</h1>
                    <p class="auvex-subheadline">Execute short-term yield cycles with fixed duration and guaranteed returns</p>
                </div>

                <div class="alert alert-warning" id="cycleWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet!</span>
                </div>

                <div class="investment-container" id="cycleContainer" style="display: none;">
                    <!-- Cycle Investment Form -->
                    <div class="investment-form-container">
                        <h3 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.6rem;">Start Cycle Investment</h3>
                        
                        <div class="form-group">
                            <label>Select Duration</label>
                            <div class="custom-dropdown" id="cycleDropdown">
                                <div class="dropdown-selected">
                                    <span>Select...</span>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                <div class="dropdown-options">
                                    <div class="dropdown-option" data-plan="0">
                                        <div class="plan-duration">1 Day</div>
                                        <div class="plan-return">100.5% Return</div>
                                    </div>
                                    <div class="dropdown-option" data-plan="1">
                                        <div class="plan-duration">7 Days</div>
                                        <div class="plan-return">105% Return</div>
                                    </div>
                                    <div class="dropdown-option" data-plan="2">
                                        <div class="plan-duration">14 Days</div>
                                        <div class="plan-return">110% Return</div>
                                    </div>
                                    <div class="dropdown-option" data-plan="3">
                                        <div class="plan-duration">30 Days</div>
                                        <div class="plan-return">125% Return</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cycleAmount">Amount (USDT)</label>
                            <input type="number" id="cycleAmount" class="form-input" placeholder="5" min="0.00" step="1">
                            <div class="amount-range" id="cycleAmountRange" style="font-size: 0.85rem; color: var(--text-muted); margin-top: 6px;">
                                Minimum 5 USDT
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="cycleReferrer">Upline</label>
                            <input type="text" id="cycleReferrer" class="form-input" placeholder="0x..." disabled>
                            <small class="form-hint" style="color: var(--text-muted); font-size: 0.85rem; display: block; margin-top: 6px;">
                                Filled automatically if available
                            </small>
                        </div>

                        <button class="btn btn--primary btn-lg" id="confirmCycle" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-sync-alt"></i> Confirm
                        </button>
                    </div>

                    <!-- Cycle Dashboard -->
                    <div class="investment-dashboard">
                        <h3 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.6rem;">Active Cycles Dashboard</h3>
                        
                        <div class="alert alert-info" id="noCyclesAlert" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <span>No active cycles found!</span>
                        </div>

                        <div class="table-responsive">
                            <table class="investment-table" id="cyclesTable" style="display: none;">
                                <thead>
                                    <tr>
                                        <th>Status</th>
                                        <th>Amount</th>
                                        <th>Plan</th>
                                        <th>End Time</th>
                                        <th>Earned</th>
                                    </tr>
                                </thead>
                                <tbody id="cyclesTableBody">
                                    <!-- Cycles will be loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn--primary" id="withdrawCycle">
                                <i class="fas fa-download"></i> Withdraw Cycle
                            </button>
                            <button class="btn btn--outline" id="regrowCycle">
                                <i class="fas fa-sync-alt"></i> Regrow Cycle
                            </button>
                        </div>

                        <!-- Cycle Referral Program -->
                        <div style="margin-top: 40px; padding-top: 30px; border-top: 1px solid rgba(139, 58, 0, 0.3);">
                            <h4 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.4rem;">Cycle Referral Program</h4>
                            
                            <!-- Referral Link Box -->
                            <div class="referral-link-box">
                                <div class="referral-link" id="cycleReferralLink">Loading...</div>
                                <button class="copy-btn" id="copyCycleReferral">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-coins"></i></div>
                                    <div class="stat-value" id="cycleTotalEarned">0 USDT</div>
                                    <div class="stat-label">Total Earned</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-layer-group"></i></div>
                                    <div class="stat-value" id="cycleLevelAchieved">0</div>
                                    <div class="stat-label">Level Achieved</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                                    <div class="stat-value" id="cycleTotalTeam">0</div>
                                    <div class="stat-label">Total Team</div>
                                </div>
                            </div>

                            <button class="btn btn--outline btn-lg" id="withdrawCycleReferral" style="margin-top: 25px;">
                                <i class="fas fa-download"></i> Withdraw Referral
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Cycle Referral Levels -->
                <div class="content-container" style="margin-top: 40px;">
                    <h3 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.6rem;">Cycle Referral Levels</h3>
                    <div class="referral-levels">
                        <div class="referral-level">
                            <div class="level-number">1</div>
                            <div class="level-percent">15%</div>
                            <div class="level-requirement">Requires active personal stake of 20 USDT in any plan</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">2</div>
                            <div class="level-percent">7%</div>
                            <div class="level-requirement">Requires 1 downline at level 1 with 20 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">3</div>
                            <div class="level-percent">2%</div>
                            <div class="level-requirement">Requires 3 downlines at level 1 with 20 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">4</div>
                            <div class="level-percent">1%</div>
                            <div class="level-requirement">Requires 5 downlines at level 1 with 20 USDT active stake</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Saving Section -->
        <section class="section" id="saving" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h1 class="auvex-headline">Saving Investment</h1>
                    <p class="auvex-subheadline">Dynamic daily yields with flexible capital withdrawal options</p>
                </div>

                <div class="alert alert-warning" id="savingWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet!</span>
                </div>

                <div class="investment-container" id="savingContainer" style="display: none;">
                    <!-- Saving Investment Form -->
                    <div class="investment-form-container">
                        <h3 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.6rem;">Start Saving Investment</h3>
                        
                        <div class="form-group">
                            <label for="savingAmount">Amount (USDT)</label>
                            <input type="number" id="savingAmount" class="form-input" placeholder="5" min="0.00" step="1">
                            <div class="amount-range" id="savingAmountRange" style="font-size: 0.85rem; color: var(--text-muted); margin-top: 6px;">
                                Minimum 5 USDT
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="savingReferrer">Upline</label>
                            <input type="text" id="savingReferrer" class="form-input" placeholder="0x..." disabled>
                            <small class="form-hint" style="color: var(--text-muted); font-size: 0.85rem; display: block; margin-top: 6px;">
                                Filled automatically if available
                            </small>
                        </div>

                        <button class="btn btn--primary btn-lg" id="confirmSaving" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-piggy-bank"></i> Confirm
                        </button>
                    </div>

                    <!-- Saving Dashboard -->
                    <div class="investment-dashboard">
                        <h3 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.6rem;">Active Savings Dashboard</h3>
                        
                        <div class="alert alert-info" id="noSavingsAlert" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <span>No active savings found!</span>
                        </div>

                        <div class="table-responsive">
                            <table class="investment-table" id="savingsTable" style="display: none;">
                                <thead>
                                    <tr>
                                        <th>Status</th>
                                        <th>Amount</th>
                                        <th>ROI %</th>
                                        <th>Earned</th>
                                    </tr>
                                </thead>
                                <tbody id="savingsTableBody">
                                    <!-- Savings will be loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn--primary" id="withdrawSaving">
                                <i class="fas fa-download"></i> Withdraw Saving
                            </button>
                            <button class="btn btn--outline" id="withdrawCapitalSaving">
                                <i class="fas fa-university"></i> Withdraw Capital
                            </button>
                        </div>

                        <!-- Saving Referral Program -->
                        <div style="margin-top: 40px; padding-top: 30px; border-top: 1px solid rgba(139, 58, 0, 0.3);">
                            <h4 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.4rem;">Saving Referral Program</h4>
                            
                            <!-- Referral Link Box -->
                            <div class="referral-link-box">
                                <div class="referral-link" id="savingReferralLink">Loading...</div>
                                <button class="copy-btn" id="copySavingReferral">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-coins"></i></div>
                                    <div class="stat-value" id="savingTotalEarned">0 USDT</div>
                                    <div class="stat-label">Total Earned</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-layer-group"></i></div>
                                    <div class="stat-value" id="savingLevelAchieved">0</div>
                                    <div class="stat-label">Level Achieved</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                                    <div class="stat-value" id="savingTotalTeam">0</div>
                                    <div class="stat-label">Total Team</div>
                                </div>
                            </div>

                            <button class="btn btn--outline btn-lg" id="withdrawSavingReferral" style="margin-top: 25px;">
                                <i class="fas fa-download"></i> Withdraw Referral
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Saving Referral Levels -->
                <div class="content-container" style="margin-top: 40px;">
                    <h3 style="margin-bottom: 25px; color: var(--gold-glow); font-size: 1.6rem;">Saving Referral Levels</h3>
                    <div class="referral-levels">
                        <div class="referral-level">
                            <div class="level-number">1</div>
                            <div class="level-percent">20%</div>
                            <div class="level-requirement">10 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">2</div>
                            <div class="level-percent">15%</div>
                            <div class="level-requirement">20 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">3</div>
                            <div class="level-percent">8%</div>
                            <div class="level-requirement">30 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">4</div>
                            <div class="level-percent">4%</div>
                            <div class="level-requirement">40 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">5</div>
                            <div class="level-percent">2%</div>
                            <div class="level-requirement">50 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">6</div>
                            <div class="level-percent">2%</div>
                            <div class="level-requirement">60 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">7</div>
                            <div class="level-percent">1%</div>
                            <div class="level-requirement">70 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">8</div>
                            <div class="level-percent">1%</div>
                            <div class="level-requirement">80 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">9</div>
                            <div class="level-percent">1%</div>
                            <div class="level-requirement">90 USDT active stake</div>
                        </div>
                        <div class="referral-level">
                            <div class="level-number">10</div>
                            <div class="level-percent">1%</div>
                            <div class="level-requirement">100 USDT active stake</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="section" id="faq" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h1 class="auvex-headline">Frequently Asked Questions</h1>
                    <p class="auvex-subheadline">Everything you need to know about Auvex Protocol</p>
                </div>

                <div class="faq-container">
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What is Auvex Protocol?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Auvex Protocol is a DeFi platform based on smart contracts that provides structured investment mechanisms through Cycle Investment, Saving Investment, and Referral Rewards, with all processes running automatically and on-chain.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Is Auvex Protocol non-custodial?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Yes. All funds are managed directly by the smart contract, not by individuals or centralized parties. Users have full control over their investments according to contract rules.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Has the Auvex smart contract been audited?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Yes. The Auvex smart contract has undergone comprehensive manual audit and is declared PASSED  Fully Correct, with no critical, high, or medium issues identified.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Does Auvex Protocol have an admin or owner?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Yes. Auvex Protocol has an admin with limited role that can only withdraw bonuses from the Scorch Referral Pool to support community sustainability. The admin does not have access to change the contract, manage user funds, or modify investment mechanisms.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Can the smart contract be upgraded or changed?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>No. Auvex Protocol is immutable. There are no proxy, upgrade, or parameter change functions after contract deployment.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What token is used in Auvex Protocol?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Auvex Protocol is designed to operate using standard ERC-20 tokens, such as USDT, which follows conventional ERC-20 transfer mechanisms.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How does the Cycle Investment system work?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Users deposit into a cycle with a specific duration. After the cycle ends, users can claim principal + profit according to terms set in the smart contract.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What is Saving Investment?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Saving Investment allows users to earn daily rewards that can be claimed periodically, with flexibility to withdraw capital anytime according to contract rules.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Are rewards guaranteed to be available?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>All rewards and withdrawals are limited by pool liquidity. The smart contract only allows payments if funds are available, ensuring the system remains safe and consistent.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How does the referral mechanism work in Auvex Protocol?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Referral rewards are distributed through a multi-level system with specific qualification requirements. Only referrals meeting the criteria can receive rewards.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Do referral rewards create token inflation?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>No. Referral rewards do not mint new tokens. All rewards come from existing pools and are subject to contract balance checks.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Is Auvex Protocol safe from reentrancy attacks?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Yes. All sensitive functions are protected with ReentrancyGuard, making it safe from reentrancy and nested-call attacks.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Can users withdraw other people's funds?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>No. Each withdrawal can only be performed by the owner of the related investment, and is verified directly by the smart contract.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Is there risk of data or reward manipulation?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>No. All reward calculations, referrals, and pool operations are performed deterministically and transparently within the smart contract, without external inputs that can be manipulated.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Where can I verify data and transactions?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>All Auvex Protocol activity can be verified directly through blockchain explorers, including transactions, contract balances, and smart contract function executions.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What is the minimum investment amount?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>The minimum investment amount is 5 USDT for both Cycle and Saving investments.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How are referral rewards distributed?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Cycle referral rewards are calculated from profits (15%, 7%, 2%, 1% across 4 levels). Saving referral rewards are calculated from withdrawn rewards (20%, 15%, 8%, 4%, 2%, 2%, 1%, 1%, 1%, 1% across 10 levels).</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What happens if referral qualification requirements are not met?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>If qualification requirements are not met, referral rewards are redirected to the Scorch Referral Pool to maintain protocol sustainability.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Can I withdraw my capital from Saving Investment anytime?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Yes, you can withdraw your capital from Saving Investment anytime, provided the pool has sufficient liquidity. The investment becomes inactive after capital withdrawal.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__brand">
                    <div class="footer__logo">
                        <img src="image/logo.png" alt="" class="logo" onerror="this.style.display='none'">
                        <span>AUVEX</span>
                    </div>
                    <p>
                        Immutable smart contracts executing investments and rewards with precision, transparency and on-chain integrity
                    </p>
                    <div class="footer__social">
                        <a href="https://t.me/AuvexProtocol" class="social__link" target="_blank"><i class="fab fa-telegram-plane"></i></a>
                        <a href="https://x.com/AuvexProtocol" class="social__link" target="_blank"><i class="fab fa-twitter"></i></a>
                        <a href="https://bscscan.com/address/0x7F33CbE48a617192c9A8AA490708BF547f1488AD" target="_blank" class="social__link"><i class="fas fa-file-contract"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2025 All Rights Reserved</p>
            </div>
        </div>
    </footer>

    <!-- Popups -->
    <div class="popup" id="successPopup">
        <div class="popup-content">
            <div class="popup-icon"><i class="fas fa-check"></i></div>
            <h2 style="color: var(--gold-glow); margin-bottom: 15px;">Deposit Successful!</h2>
            <p style="color: var(--text-muted); margin: 10px 0 25px; font-size: 1.05rem;">Your investment is now active and earning returns</p>
            <div class="action-buttons" style="justify-content: center;">
                <button class="btn btn--primary btn-lg" id="goToDashboard">
                    <i class="fas fa-tachometer-alt"></i> Go to Dashboard
                </button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="popup-modal" id="withdrawCycleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Withdraw Cycle</h2>
                <p style="color: var(--text-muted);">Select to withdraw</p>
            </div>
            <div class="modal-body">
                <div class="cycle-list" id="withdrawCycleList">
                    <!-- Cycle list will be loaded here -->
                </div>
                <div id="noEndedCyclesMessage" class="no-cycles" style="display: none;">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px; color: var(--text-muted);"></i>
                    <p>There is no cycle ending!</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--primary" id="confirmWithdrawCycles">Confirm</button>
                <button class="btn btn--outline" id="closeWithdrawCycleModal">Cancel</button>
            </div>
        </div>
    </div>

    <div class="popup-modal" id="regrowCycleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Regrow Cycle</h2>
                <p style="color: var(--text-muted);">Select to regrow</p>
            </div>
            <div class="modal-body">
                <div class="cycle-list" id="regrowCycleList">
                    <!-- Cycle list will be loaded here -->
                </div>
                <div id="noEndedCyclesRegrowMessage" class="no-cycles" style="display: none;">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px; color: var(--text-muted);"></i>
                    <p>There is no cycle ending!</p>
                </div>
                
                <div style="margin-top: 25px;">
                    <label style="color: var(--gold-glow); font-weight: 600; margin-bottom: 10px; display: block;">Select Duration</label>
                    <div class="custom-dropdown" id="regrowPlanDropdown">
                        <div class="dropdown-selected">
                            <span>Select...</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option" data-plan="0">
                                <div class="plan-duration">1 Day</div>
                                <div class="plan-return">100.5% Return</div>
                            </div>
                            <div class="dropdown-option" data-plan="1">
                                <div class="plan-duration">7 Days</div>
                                <div class="plan-return">105% Return</div>
                            </div>
                            <div class="dropdown-option" data-plan="2">
                                <div class="plan-duration">14 Days</div>
                                <div class="plan-return">110% Return</div>
                            </div>
                            <div class="dropdown-option" data-plan="3">
                                <div class="plan-duration">30 Days</div>
                                <div class="plan-return">125% Return</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--primary" id="confirmRegrowModal">Confirm</button>
                <button class="btn btn--outline" id="closeRegrowCycleModal">Cancel</button>
            </div>
        </div>
    </div>

    <div class="popup-modal" id="withdrawCapitalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Withdraw Capital</h2>
                <p style="color: var(--text-muted);">Select to withdraw capital</p>
            </div>
            <div class="modal-body">
                <div class="cycle-list" id="withdrawCapitalList">
                    <!-- Saving list will be loaded here -->
                </div>
                <div id="noActiveSavingsMessage" class="no-cycles" style="display: none;">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px; color: var(--text-muted);"></i>
                    <p>No active savings found!</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn--primary" id="confirmWithdrawCapital">Confirm</button>
                <button class="btn btn--outline" id="closeWithdrawCapitalModal">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // ===== CONFIGURATION =====
        const CONTRACT_ADDRESS = '0x7F33CbE48a617192c9A8AA490708BF547f1488AD';
        const USDT_ADDRESS = '0x55d398326f99059fF775485246999027B3197955';
        const BSC_RPC = 'https://bsc-dataseed1.binance.org/';

        const CONTRACT_ABI = [{"inputs":[{"internalType":"address","name":"_usdtAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"CapitalWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"profit","type":"uint256"}],"name":"CycleClaimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"planType","type":"uint8"},{"indexed":false,"internalType":"address","name":"referrer","type":"address"}],"name":"NewDeposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"}],"name":"OwnershipRenounced","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newBalance","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"changePercent","type":"uint256"}],"name":"PoolAdjusted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"referrer","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint8","name":"planType","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"}],"name":"ReferralRewardPaid","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"oldCycleId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newCycleId","type":"uint256"}],"name":"RegrowExecuted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"SavingClaimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ScorchReferralWithdrawn","type":"event"},{"inputs":[],"name":"ADMIN_FEE_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ADMIN_FICTITIOUS_DEPOSIT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ADMIN_REWARD_INTERVAL","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ADMIN_WALLET","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_DURATIONS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_REF_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"CYCLE_REF_REQUIREMENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MIN_DEPOSIT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SAVING_ADJUSTMENT_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SAVING_MAX_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SAVING_MIN_PERCENT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"SAVING_REF_PERCENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"SAVING_REF_REQUIREMENTS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"TIME_STEP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"adminAccumulatedRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"adminLastRewardTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"savingId","type":"uint256"}],"name":"capitalSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"claimCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"claimSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"contractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"cycleInvestments","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"plan","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"bool","name":"claimed","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint8","name":"plan","type":"uint8"},{"internalType":"address","name":"referrer","type":"address"}],"name":"depositCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"address","name":"referrer","type":"address"}],"name":"depositSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"downlines","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getContractStats","outputs":[{"internalType":"uint256","name":"totalInvested_","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn_","type":"uint256"},{"internalType":"uint256","name":"totalUsers_","type":"uint256"},{"internalType":"uint256","name":"contractBalance_","type":"uint256"},{"internalType":"uint256","name":"poolBalance_","type":"uint256"},{"internalType":"uint256","name":"scorchPool_","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"getCycleDetails","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"plan","type":"uint256"},{"internalType":"uint256","name":"startTime","type":"uint256"},{"internalType":"uint256","name":"endTime","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"},{"internalType":"uint256","name":"profit","type":"uint256"},{"internalType":"bool","name":"claimed","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"}],"name":"getCycleProfitDetails","outputs":[{"internalType":"uint256","name":"profitPer8Hours","type":"uint256"},{"internalType":"uint256","name":"timeLeft","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint256","name":"savingId","type":"uint256"}],"name":"getSavingDetails","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"currentPercent","type":"uint256"},{"internalType":"uint256","name":"dailyReward","type":"uint256"},{"internalType":"bool","name":"active","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserInfo","outputs":[{"internalType":"uint256","name":"totalInvested_","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn_","type":"uint256"},{"internalType":"uint256","name":"cycleRewards_","type":"uint256"},{"internalType":"uint256","name":"savingRewards_","type":"uint256"},{"internalType":"uint256","name":"activeInvestment_","type":"uint256"},{"internalType":"address","name":"referrer_","type":"address"},{"internalType":"uint256","name":"referrals_","type":"uint256"},{"internalType":"bool","name":"isActive_","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserInvestments","outputs":[{"internalType":"uint256","name":"activeCycles","type":"uint256"},{"internalType":"uint256","name":"activeSavings","type":"uint256"},{"internalType":"uint256","name":"totalCycles","type":"uint256"},{"internalType":"uint256","name":"totalSavings","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"isRenounced","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"poolBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"poolSnapshots","outputs":[{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"uint256","name":"poolBalance","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"qualifiedDownlineCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"cycleId","type":"uint256"},{"internalType":"uint8","name":"newPlan","type":"uint8"}],"name":"regrow","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardCycle","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"rewardSaving","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"savingInvestments","outputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"currentPercent","type":"uint256"},{"internalType":"uint256","name":"lastPayout","type":"uint256"},{"internalType":"bool","name":"active","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"scorchReferralPool","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalInvested","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalUsers","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalWithdrawn","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"usdt","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"users","outputs":[{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256","name":"referrals","type":"uint256"},{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"cycleRewards","type":"uint256"},{"internalType":"uint256","name":"savingRewards","type":"uint256"},{"internalType":"uint256","name":"lastSavingClaim","type":"uint256"},{"internalType":"uint256","name":"activeInvestment","type":"uint256"},{"internalType":"bool","name":"isActive","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdrawScorchReferral","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}];

        const USDT_ABI = [
            {"constant": false, "inputs": [{"name": "_spender", "type": "address"}, {"name": "_value", "type": "uint256"}], "name": "approve", "outputs": [{"name": "", "type": "bool"}], "type": "function"}, 
            {"constant": true, "inputs": [{"name": "_owner", "type": "address"}], "name": "balanceOf", "outputs": [{"name": "balance", "type": "uint256"}], "type": "function"}, 
            {"constant": true, "inputs": [{"name": "_owner", "type": "address"}, {"name": "_spender", "type": "address"}], "name": "allowance", "outputs": [{"name": "", "type": "uint256"}], "type": "function"}, 
            {"constant": true, "inputs": [], "name": "decimals", "outputs": [{"name": "", "type": "uint8"}], "type": "function"}
        ];

        // ===== GLOBAL VARIABLES =====
        let web3;
        let contract;
        let usdtContract;
        let userAccount = null;
        let referralAddress = null;
        let selectedCyclePlan = null;
        let selectedRegrowPlan = null;
        let selectedCycleForRegrow = null;
        let selectedCycleForWithdraw = [];
        let selectedSavingForWithdraw = null;
        let userCycles = [];
        let userSavings = [];
        let userInfo = null;

        // ===== DOM ELEMENTS =====
        const preloader = document.querySelector('.preloader');
        const navToggle = document.getElementById('nav-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        const connectWalletBtn = document.getElementById('connectWallet');
        const connectWalletMobile = document.getElementById('connectWalletMobile');
        const notification = document.getElementById('notification');
        const successPopup = document.getElementById('successPopup');
        const withdrawCycleModal = document.getElementById('withdrawCycleModal');
        const regrowCycleModal = document.getElementById('regrowCycleModal');
        const withdrawCapitalModal = document.getElementById('withdrawCapitalModal');
        const goToDashboardBtn = document.getElementById('goToDashboard');

        const sections = {
            home: document.getElementById('home'),
            cycle: document.getElementById('cycle'),
            saving: document.getElementById('saving'),
            faq: document.getElementById('faq')
        };

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            checkPreloader();
            checkURLForReferral();
            setupFAQ();
            setupDropdowns();
            setupModalDropdowns();
            
            // Check if wallet is already connected
            if (typeof window.ethereum !== 'undefined') {
                window.ethereum.request({ method: 'eth_accounts' }).then(accounts => {
                    if (accounts.length > 0) {
                        userAccount = accounts[0];
                        connectWallet();
                    }
                });
            }
        });

        async function initializeApp() {
            try {
                // Initialize Web3 with BSC RPC
                web3 = new Web3(new Web3.providers.HttpProvider(BSC_RPC));
                contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                
                // Load initial stats
                await loadContractStats();
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error initializing application', 'error');
            }
        }

        async function loadContractStats() {
            if (!contract) return;
            
            try {
                const stats = await contract.methods.getContractStats().call();
                
                const formatUSDT = (weiValue) => {
                    const value = parseFloat(web3.utils.fromWei(weiValue, 'ether'));
                    return value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                };
                
                // Update home stats
                document.getElementById('statLiquidity').textContent = `${formatUSDT(stats.poolBalance_)} USDT`;
                document.getElementById('statTotalUsers').textContent = `${parseInt(stats.totalUsers_).toLocaleString('en-US')} Active`;
                document.getElementById('statTotalInvest').textContent = `${formatUSDT(stats.totalInvested_)} USDT`;
                document.getElementById('statTotalPaid').textContent = `${formatUSDT(stats.totalWithdrawn_)} USDT`;
                document.getElementById('statScorchReferral').textContent = `${formatUSDT(stats.scorchPool_)} USDT`;
                
            } catch (error) {
                console.error('Error loading contract stats:', error);
            }
        }

        // ===== DROPDOWN FUNCTIONS =====
        function setupDropdowns() {
            // Cycle dropdown
            const cycleDropdown = document.getElementById('cycleDropdown');
            const cycleSelected = cycleDropdown.querySelector('.dropdown-selected');
            const cycleOptions = cycleDropdown.querySelector('.dropdown-options');
            const cycleOptionItems = cycleDropdown.querySelectorAll('.dropdown-option');
            
            cycleSelected.addEventListener('click', () => {
                cycleSelected.classList.toggle('open');
                cycleOptions.classList.toggle('show');
            });
            
            cycleOptionItems.forEach(option => {
                option.addEventListener('click', () => {
                    const planDuration = option.querySelector('.plan-duration').textContent;
                    const planReturn = option.querySelector('.plan-return').textContent;
                    const plan = option.getAttribute('data-plan');
                    
                    cycleSelected.innerHTML = `
                        <span>${planDuration} - ${planReturn}</span>
                        <i class="fas fa-chevron-down"></i>
                    `;
                    selectedCyclePlan = plan;
                    
                    cycleSelected.classList.remove('open');
                    cycleOptions.classList.remove('show');
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!cycleDropdown.contains(e.target)) {
                    cycleSelected.classList.remove('open');
                    cycleOptions.classList.remove('show');
                }
            });
        }

        function setupModalDropdowns() {
            // Regrow plan dropdown in modal
            const regrowPlanDropdown = document.getElementById('regrowPlanDropdown');
            if (!regrowPlanDropdown) return;
            
            const regrowPlanSelected = regrowPlanDropdown.querySelector('.dropdown-selected');
            const regrowPlanOptions = regrowPlanDropdown.querySelector('.dropdown-options');
            const regrowPlanOptionItems = regrowPlanDropdown.querySelectorAll('.dropdown-option');
            
            regrowPlanSelected.addEventListener('click', () => {
                regrowPlanSelected.classList.toggle('open');
                regrowPlanOptions.classList.toggle('show');
            });
            
            regrowPlanOptionItems.forEach(option => {
                option.addEventListener('click', () => {
                    const planDuration = option.querySelector('.plan-duration').textContent;
                    const planReturn = option.querySelector('.plan-return').textContent;
                    const plan = option.getAttribute('data-plan');
                    
                    regrowPlanSelected.innerHTML = `
                        <span>${planDuration} - ${planReturn}</span>
                        <i class="fas fa-chevron-down"></i>
                    `;
                    selectedRegrowPlan = plan;
                    
                    regrowPlanSelected.classList.remove('open');
                    regrowPlanOptions.classList.remove('show');
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!regrowPlanDropdown.contains(e.target)) {
                    regrowPlanSelected.classList.remove('open');
                    regrowPlanOptions.classList.remove('show');
                }
            });
        }

        // ===== MODAL FUNCTIONS =====
        function showModal(modal) {
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hideModal(modal) {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // ===== WALLET CONNECTION =====
        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                return showNotification('No wallet detected!', 'error');
            }
            
            try {
                // Switch to Web3 provider with user's wallet
                web3 = new Web3(window.ethereum);
                contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                usdtContract = new web3.eth.Contract(USDT_ABI, USDT_ADDRESS);

                // Check and switch to BSC network
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                if (chainId !== '0x38') { // BSC Mainnet chainId
                    try {
                        await window.ethereum.request({ 
                            method: 'wallet_switchEthereumChain', 
                            params: [{ chainId: '0x38' }] 
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await window.ethereum.request({ 
                                method: 'wallet_addEthereumChain', 
                                params: [{ 
                                    chainId: '0x38', 
                                    chainName: 'Binance Smart Chain', 
                                    nativeCurrency: { 
                                        name: 'BNB', 
                                        symbol: 'BNB', 
                                        decimals: 18 
                                    }, 
                                    rpcUrls: ['https://bsc-dataseed.binance.org/'], 
                                    blockExplorerUrls: ['https://bscscan.com/'] 
                                }] 
                            });
                        } else {
                            throw switchError;
                        }
                    }
                }
                
                // Request accounts
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                if (accounts.length > 0) {
                    userAccount = accounts[0];
                    updateWalletUI();
                    await loadUserData();
                    updateReferralLinks();
                    showNotification('Wallet connected!', 'success');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Failed to connect wallet: ' + error.message, 'error');
            }
        }

        function updateWalletUI() {
            if (userAccount) {
                const shortAddress = `${userAccount.substring(0, 6)}...${userAccount.substring(userAccount.length - 4)}`;
                connectWalletBtn.innerHTML = `<i class="fas fa-wallet"></i> ${shortAddress}`;
                if (connectWalletMobile) {
                    connectWalletMobile.innerHTML = `<i class="fas fa-wallet"></i> ${shortAddress}`;
                }
                hideWalletAlerts();
            } else {
                connectWalletBtn.innerHTML = `<i class="fas fa-wallet"></i> Connect Wallet`;
                if (connectWalletMobile) {
                    connectWalletMobile.innerHTML = `<i class="fas fa-wallet"></i> Connect Wallet`;
                }
                showWalletAlerts();
            }
        }

        function updateReferralLinks() {
            if (userAccount) {
                const baseUrl = window.location.origin + window.location.pathname;
                const cycleReferralLink = `${baseUrl}?ref=${userAccount}`;
                const savingReferralLink = `${baseUrl}?ref=${userAccount}`;
                
                document.getElementById('cycleReferralLink').textContent = cycleReferralLink;
                document.getElementById('savingReferralLink').textContent = savingReferralLink;
            }
        }

        function showWalletAlerts() {
            // Show alerts
            document.getElementById('cycleWalletAlert').style.display = 'flex';
            document.getElementById('savingWalletAlert').style.display = 'flex';
            
            // Hide containers
            document.getElementById('cycleContainer').style.display = 'none';
            document.getElementById('savingContainer').style.display = 'none';
        }

        function hideWalletAlerts() {
            // Hide alerts
            document.getElementById('cycleWalletAlert').style.display = 'none';
            document.getElementById('savingWalletAlert').style.display = 'none';
            
            // Show containers
            document.getElementById('cycleContainer').style.display = 'grid';
            document.getElementById('savingContainer').style.display = 'grid';
        }

        // ===== EVENT LISTENERS =====
        function setupEventListeners() {
            // Mobile menu toggle
            navToggle.addEventListener('click', () => {
                mobileMenu.classList.toggle('active');
            });

            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (mobileMenu.classList.contains('active') && 
                    !mobileMenu.contains(e.target) && 
                    !navToggle.contains(e.target)) {
                    mobileMenu.classList.remove('active');
                }
            });

            // Navigation
            document.querySelectorAll('.nav__link, .mobile-menu a, button[data-section]').forEach(el => {
                el.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetElement = e.target.closest('[data-section]');
                    if (targetElement) {
                        const sectionName = targetElement.getAttribute('data-section');
                        showSection(sectionName);
                        mobileMenu.classList.remove('active');
                    }
                });
            });

            // Wallet connections
            connectWalletBtn.addEventListener('click', connectWallet);
            if (connectWalletMobile) {
                connectWalletMobile.addEventListener('click', connectWallet);
            }

            // Copy referral links
            document.getElementById('copyCycleReferral').addEventListener('click', () => {
                const link = document.getElementById('cycleReferralLink').textContent;
                navigator.clipboard.writeText(link).then(() => {
                    showNotification('Copied to clipboard!', 'success');
                });
            });

            document.getElementById('copySavingReferral').addEventListener('click', () => {
                const link = document.getElementById('savingReferralLink').textContent;
                navigator.clipboard.writeText(link).then(() => {
                    showNotification('Copied to clipboard!', 'success');
                });
            });

            // Cycle investment
            document.getElementById('confirmCycle').addEventListener('click', confirmCycleInvestment);
            document.getElementById('cycleAmount').addEventListener('input', validateCycleAmount);
            
            // Cycle actions
            document.getElementById('withdrawCycle').addEventListener('click', openWithdrawCycleModal);
            document.getElementById('regrowCycle').addEventListener('click', openRegrowCycleModal);
            document.getElementById('withdrawCycleReferral').addEventListener('click', withdrawCycleReferral);
            
            // Saving investment
            document.getElementById('confirmSaving').addEventListener('click', confirmSavingInvestment);
            document.getElementById('savingAmount').addEventListener('input', validateSavingAmount);
            
            // Saving actions
            document.getElementById('withdrawSaving').addEventListener('click', withdrawSavingRewards);
            document.getElementById('withdrawCapitalSaving').addEventListener('click', openWithdrawCapitalModal);
            document.getElementById('withdrawSavingReferral').addEventListener('click', withdrawSavingReferral);
            
            // Modal buttons
            document.getElementById('closeWithdrawCycleModal').addEventListener('click', () => hideModal(withdrawCycleModal));
            document.getElementById('closeRegrowCycleModal').addEventListener('click', () => hideModal(regrowCycleModal));
            document.getElementById('closeWithdrawCapitalModal').addEventListener('click', () => hideModal(withdrawCapitalModal));
            
            document.getElementById('confirmWithdrawCycles').addEventListener('click', confirmWithdrawCycles);
            document.getElementById('confirmRegrowModal').addEventListener('click', confirmRegrowModal);
            document.getElementById('confirmWithdrawCapital').addEventListener('click', confirmWithdrawCapital);
            
            // Success popup
            goToDashboardBtn.addEventListener('click', () => {
                hidePopup(successPopup);
                showSection('cycle');
            });

            // Close popups on outside click
            successPopup.addEventListener('click', (e) => {
                if (e.target === successPopup) hidePopup(successPopup);
            });
            withdrawCycleModal.addEventListener('click', (e) => {
                if (e.target === withdrawCycleModal) hideModal(withdrawCycleModal);
            });
            regrowCycleModal.addEventListener('click', (e) => {
                if (e.target === regrowCycleModal) hideModal(regrowCycleModal);
            });
            withdrawCapitalModal.addEventListener('click', (e) => {
                if (e.target === withdrawCapitalModal) hideModal(withdrawCapitalModal);
            });

            // Window scroll for header effect
            window.addEventListener('scroll', handleScroll);
        }

        // ===== UTILITY FUNCTIONS =====
        function handleScroll() {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        }

        function checkPreloader() {
            setTimeout(() => {
                preloader.classList.add('fade-out');
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 600);
            }, 1500);
        }

        function checkURLForReferral() {
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            if (ref && web3.utils.isAddress(ref)) {
                referralAddress = ref;
                document.getElementById('cycleReferrer').value = ref;
                document.getElementById('savingReferrer').value = ref;
            }
        }

        function setupFAQ() {
            document.querySelectorAll('.faq-question').forEach(question => {
                question.addEventListener('click', () => {
                    const faqItem = question.parentElement;
                    faqItem.classList.toggle('active');
                });
            });
        }

        function showSection(sectionName) {
            // Hide all sections
            Object.values(sections).forEach(section => {
                section.style.display = 'none';
            });

            // Show selected section
            if (sections[sectionName]) {
                sections[sectionName].style.display = 'flex';
                
                // Update active nav link
                document.querySelectorAll('.nav__link').forEach(link => {
                    link.classList.remove('active');
                });
                document.querySelectorAll('.mobile-menu a').forEach(link => {
                    link.classList.remove('active');
                });
                
                document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');
                
                // Scroll to top of section
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function showNotification(message, type = 'info') {
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        function showPopup(popup) {
            popup.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hidePopup(popup) {
            popup.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showButtonLoading(button, isLoading) {
            if (isLoading) {
                button.classList.add('loading');
                button.innerHTML = `<i class="fas fa-spinner loading-spinner"></i>`;
                button.disabled = true;
            } else {
                button.classList.remove('loading');
                button.disabled = false;
                // Restore original content
                if (button.id === 'confirmCycle') {
                    button.innerHTML = `<i class="fas fa-sync-alt"></i> Confirm`;
                } else if (button.id === 'confirmSaving') {
                    button.innerHTML = `<i class="fas fa-piggy-bank"></i> Confirm`;
                } else if (button.id === 'confirmWithdrawCycles') {
                    button.innerHTML = `Confirm`;
                } else if (button.id === 'confirmRegrowModal') {
                    button.innerHTML = `Confirm`;
                } else if (button.id === 'confirmWithdrawCapital') {
                    button.innerHTML = `Confirm`;
                }
            }
        }

        // ===== VALIDATION FUNCTIONS =====
        function validateCycleAmount() {
            const amount = parseFloat(document.getElementById('cycleAmount').value);
            const minAmount = 5;
            
            if (amount < minAmount) {
                document.getElementById('cycleAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('cycleAmountRange').style.color = '#ff4444';
                return false;
            } else {
                document.getElementById('cycleAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('cycleAmountRange').style.color = 'var(--text-muted)';
                return true;
            }
        }

        function validateSavingAmount() {
            const amount = parseFloat(document.getElementById('savingAmount').value);
            const minAmount = 5;
            
            if (amount < minAmount) {
                document.getElementById('savingAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('savingAmountRange').style.color = '#ff4444';
                return false;
            } else {
                document.getElementById('savingAmountRange').innerHTML = `Minimum: ${minAmount} USDT`;
                document.getElementById('savingAmountRange').style.color = 'var(--text-muted)';
                return true;
            }
        }

        // ===== MODAL OPEN FUNCTIONS =====
        async function openWithdrawCycleModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            selectedCycleForWithdraw = [];
            
            try {
                const investments = await contract.methods.getUserInvestments(userAccount).call();
                const cycleCount = parseInt(investments.totalCycles);
                
                const cycleList = document.getElementById('withdrawCycleList');
                const noCyclesMessage = document.getElementById('noEndedCyclesMessage');
                
                cycleList.innerHTML = '';
                
                if (cycleCount === 0) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                    showModal(withdrawCycleModal);
                    return;
                }
                
                let hasEndedCycles = false;
                
                for (let i = 0; i < cycleCount; i++) {
                    const cycleDetails = await contract.methods.getCycleDetails(userAccount, i).call();
                    const isClaimed = cycleDetails.claimed;
                    const endTime = parseInt(cycleDetails.endTime);
                    const now = Math.floor(Date.now() / 1000);
                    
                    // Only show cycles that have ended and not claimed
                    if (endTime <= now && !isClaimed) {
                        hasEndedCycles = true;
                        
                        const planNames = ['1 Day', '7 Days', '14 Days', '30 Days'];
                        const planName = planNames[parseInt(cycleDetails.plan)];
                        const amount = parseFloat(web3.utils.fromWei(cycleDetails.amount, 'ether')).toFixed(2);
                        const totalReturn = parseFloat(web3.utils.fromWei(cycleDetails.totalReturn, 'ether')).toFixed(2);
                        const profit = parseFloat(web3.utils.fromWei(cycleDetails.profit, 'ether')).toFixed(2);
                        
                        const cycleItem = document.createElement('div');
                        cycleItem.className = 'cycle-item';
                        cycleItem.dataset.cycleId = i;
                        cycleItem.innerHTML = `
                            <div class="cycle-info">
                                <div>
                                    <div class="cycle-amount">${amount} USDT</div>
                                    <div class="cycle-plan">${planName} | Profit: ${profit} USDT</div>
                                </div>
                                <div>
                                    <input type="checkbox" class="cycle-checkbox" data-cycle-id="${i}">
                                </div>
                            </div>
                        `;
                        
                        cycleList.appendChild(cycleItem);
                    }
                }
                
                if (!hasEndedCycles) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                } else {
                    cycleList.style.display = 'block';
                    noCyclesMessage.style.display = 'none';
                }
                
                // Add event listeners to checkboxes
                document.querySelectorAll('.cycle-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const cycleId = e.target.getAttribute('data-cycle-id');
                        if (e.target.checked) {
                            selectedCycleForWithdraw.push(cycleId);
                            e.target.closest('.cycle-item').classList.add('selected');
                        } else {
                            const index = selectedCycleForWithdraw.indexOf(cycleId);
                            if (index > -1) {
                                selectedCycleForWithdraw.splice(index, 1);
                            }
                            e.target.closest('.cycle-item').classList.remove('selected');
                        }
                    });
                });
                
                showModal(withdrawCycleModal);
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error loading cycles', 'error');
            }
        }

        async function openRegrowCycleModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            selectedCycleForRegrow = null;
            selectedRegrowPlan = null;
            
            // Reset dropdown
            const regrowPlanSelected = document.querySelector('#regrowPlanDropdown .dropdown-selected');
            regrowPlanSelected.innerHTML = `<span>Select...</span><i class="fas fa-chevron-down"></i>`;
            
            try {
                const investments = await contract.methods.getUserInvestments(userAccount).call();
                const cycleCount = parseInt(investments.totalCycles);
                
                const cycleList = document.getElementById('regrowCycleList');
                const noCyclesMessage = document.getElementById('noEndedCyclesRegrowMessage');
                
                cycleList.innerHTML = '';
                
                if (cycleCount === 0) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                    showModal(regrowCycleModal);
                    return;
                }
                
                let hasEndedCycles = false;
                
                for (let i = 0; i < cycleCount; i++) {
                    const cycleDetails = await contract.methods.getCycleDetails(userAccount, i).call();
                    const isClaimed = cycleDetails.claimed;
                    const endTime = parseInt(cycleDetails.endTime);
                    const now = Math.floor(Date.now() / 1000);
                    
                    // Only show cycles that have ended and not claimed
                    if (endTime <= now && !isClaimed) {
                        hasEndedCycles = true;
                        
                        const planNames = ['1 Day', '7 Days', '14 Days', '30 Days'];
                        const planName = planNames[parseInt(cycleDetails.plan)];
                        const amount = parseFloat(web3.utils.fromWei(cycleDetails.amount, 'ether')).toFixed(2);
                        const totalReturn = parseFloat(web3.utils.fromWei(cycleDetails.totalReturn, 'ether')).toFixed(2);
                        const profit = parseFloat(web3.utils.fromWei(cycleDetails.profit, 'ether')).toFixed(2);
                        
                        const cycleItem = document.createElement('div');
                        cycleItem.className = 'cycle-item';
                        cycleItem.dataset.cycleId = i;
                        cycleItem.innerHTML = `
                            <div class="cycle-info">
                                <div>
                                    <div class="cycle-amount">${amount} USDT</div>
                                    <div class="cycle-plan">${planName} | Profit: ${profit} USDT</div>
                                </div>
                            </div>
                        `;
                        
                        cycleItem.addEventListener('click', () => {
                            // Remove selected class from all items
                            document.querySelectorAll('#regrowCycleList .cycle-item').forEach(item => {
                                item.classList.remove('selected');
                            });
                            
                            // Add selected class to clicked item
                            cycleItem.classList.add('selected');
                            selectedCycleForRegrow = i;
                        });
                        
                        cycleList.appendChild(cycleItem);
                    }
                }
                
                if (!hasEndedCycles) {
                    cycleList.style.display = 'none';
                    noCyclesMessage.style.display = 'block';
                } else {
                    cycleList.style.display = 'block';
                    noCyclesMessage.style.display = 'none';
                }
                
                showModal(regrowCycleModal);
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error loading cycles', 'error');
            }
        }

        async function openWithdrawCapitalModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            selectedSavingForWithdraw = null;
            
            try {
                const investments = await contract.methods.getUserInvestments(userAccount).call();
                const savingCount = parseInt(investments.totalSavings);
                
                const savingList = document.getElementById('withdrawCapitalList');
                const noSavingsMessage = document.getElementById('noActiveSavingsMessage');
                
                savingList.innerHTML = '';
                
                if (savingCount === 0) {
                    savingList.style.display = 'none';
                    noSavingsMessage.style.display = 'block';
                    showModal(withdrawCapitalModal);
                    return;
                }
                
                let hasActiveSavings = false;
                
                for (let i = 0; i < savingCount; i++) {
                    const savingDetails = await contract.methods.getSavingDetails(userAccount, i).call();
                    const isActive = savingDetails.active;
                    
                    if (isActive) {
                        hasActiveSavings = true;
                        
                        const amount = parseFloat(web3.utils.fromWei(savingDetails.amount, 'ether')).toFixed(2);
                        const percent = parseFloat(savingDetails.currentPercent) / 10;
                        const dailyReward = parseFloat(web3.utils.fromWei(savingDetails.dailyReward, 'ether')).toFixed(4);
                        
                        const savingItem = document.createElement('div');
                        savingItem.className = 'cycle-item';
                        savingItem.dataset.savingId = i;
                        savingItem.innerHTML = `
                            <div class="cycle-info">
                                <div>
                                    <div class="cycle-amount">${amount} USDT</div>
                                    <div class="cycle-plan">ROI: ${percent}% | Daily: ${dailyReward} USDT</div>
                                </div>
                                <div>
                                    <input type="radio" name="savingSelect" class="saving-radio" data-saving-id="${i}">
                                </div>
                            </div>
                        `;
                        
                        savingList.appendChild(savingItem);
                    }
                }
                
                if (!hasActiveSavings) {
                    savingList.style.display = 'none';
                    noSavingsMessage.style.display = 'block';
                } else {
                    savingList.style.display = 'block';
                    noSavingsMessage.style.display = 'none';
                }
                
                // Add event listeners to radio buttons
                document.querySelectorAll('.saving-radio').forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        if (e.target.checked) {
                            selectedSavingForWithdraw = e.target.getAttribute('data-saving-id');
                            // Add selected class to parent item
                            document.querySelectorAll('#withdrawCapitalList .cycle-item').forEach(item => {
                                item.classList.remove('selected');
                            });
                            e.target.closest('.cycle-item').classList.add('selected');
                        }
                    });
                });
                
                showModal(withdrawCapitalModal);
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error loading savings', 'error');
            }
        }

        // ===== BLOCKCHAIN INTERACTION FUNCTIONS =====
        async function loadUserData() {
            if (!userAccount || !contract) return;
            
            try {
                // Load user info
                userInfo = await contract.methods.getUserInfo(userAccount).call();
                
                // Update referral fields
                if (referralAddress) {
                    document.getElementById('cycleReferrer').value = referralAddress;
                    document.getElementById('savingReferrer').value = referralAddress;
                } else if (userInfo.referrer_ !== '0x0000000000000000000000000000000000000000') {
                    document.getElementById('cycleReferrer').value = userInfo.referrer_;
                    document.getElementById('savingReferrer').value = userInfo.referrer_;
                }
                
                // Update stats
                const formatUSDT = (weiValue) => {
                    const value = parseFloat(web3.utils.fromWei(weiValue, 'ether'));
                    return value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                };
                
                document.getElementById('cycleTotalEarned').textContent = `${formatUSDT(userInfo.cycleRewards_)} USDT`;
                document.getElementById('cycleTotalTeam').textContent = userInfo.referrals_;
                document.getElementById('savingTotalEarned').textContent = `${formatUSDT(userInfo.savingRewards_)} USDT`;
                document.getElementById('savingTotalTeam').textContent = userInfo.referrals_;
                
                // Load cycles and savings
                await loadUserCycles();
                await loadUserSavings();
                
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function loadUserCycles() {
            if (!userAccount || !contract) return;
            
            try {
                const investments = await contract.methods.getUserInvestments(userAccount).call();
                const cycleCount = parseInt(investments.totalCycles);
                
                if (cycleCount === 0) {
                    document.getElementById('noCyclesAlert').style.display = 'flex';
                    document.getElementById('cyclesTable').style.display = 'none';
                    return;
                }
                
                document.getElementById('noCyclesAlert').style.display = 'none';
                document.getElementById('cyclesTable').style.display = 'table';
                
                const tbody = document.getElementById('cyclesTableBody');
                tbody.innerHTML = '';
                
                for (let i = 0; i < cycleCount; i++) {
                    const cycleDetails = await contract.methods.getCycleDetails(userAccount, i).call();
                    const isClaimed = cycleDetails.claimed;
                    const endTime = parseInt(cycleDetails.endTime);
                    const now = Math.floor(Date.now() / 1000);
                    const profit = parseFloat(web3.utils.fromWei(cycleDetails.profit, 'ether')).toFixed(2);
                    
                    const planNames = ['1 Day', '7 Days', '14 Days', '30 Days'];
                    const planName = planNames[parseInt(cycleDetails.plan)];
                    
                    const amount = parseFloat(web3.utils.fromWei(cycleDetails.amount, 'ether')).toFixed(2);
                    
                    // Calculate time left or show Ready
                    let timeDisplay = '';
                    let status = 'Active';
                    let statusClass = 'status-active';
                    
                    if (isClaimed) {
                        status = 'Claimed';
                        statusClass = 'status-exp';
                        timeDisplay = 'Claimed';
                    } else if (endTime <= now) {
                        status = 'Ready';
                        statusClass = 'status-ready';
                        timeDisplay = 'Ready';
                    } else {
                        // Calculate countdown timer
                        const timeLeft = endTime - now;
                        const days = Math.floor(timeLeft / (24 * 60 * 60));
                        const hours = Math.floor((timeLeft % (24 * 60 * 60)) / (60 * 60));
                        const minutes = Math.floor((timeLeft % (60 * 60)) / 60);
                        const seconds = timeLeft % 60;
                        
                        timeDisplay = `${days}d ${hours}h ${minutes}m ${seconds}s`;
                        
                        // Update timer every second
                        setTimeout(() => {
                            updateCycleTimer(i, endTime);
                        }, 1000);
                    }
                    
                    const row = document.createElement('tr');
                    row.id = `cycle-row-${i}`;
                    row.innerHTML = `
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                        <td>${amount} USDT</td>
                        <td>${planName}</td>
                        <td><span class="timer" id="cycle-timer-${i}">${timeDisplay}</span></td>
                        <td>${profit} USDT</td>
                    `;
                    tbody.appendChild(row);
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function updateCycleTimer(cycleId, endTime) {
            const timerElement = document.getElementById(`cycle-timer-${cycleId}`);
            if (!timerElement) return;
            
            const now = Math.floor(Date.now() / 1000);
            const timeLeft = endTime - now;
            
            if (timeLeft <= 0) {
                timerElement.textContent = 'Ready';
                // Update status to Ready
                const row = document.getElementById(`cycle-row-${cycleId}`);
                if (row) {
                    const statusBadge = row.querySelector('.status-badge');
                    if (statusBadge) {
                        statusBadge.textContent = 'Ready';
                        statusBadge.className = 'status-badge status-ready';
                    }
                }
                return;
            }
            
            const days = Math.floor(timeLeft / (24 * 60 * 60));
            const hours = Math.floor((timeLeft % (24 * 60 * 60)) / (60 * 60));
            const minutes = Math.floor((timeLeft % (60 * 60)) / 60);
            const seconds = timeLeft % 60;
            
            timerElement.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            
            // Update every second
            setTimeout(() => {
                updateCycleTimer(cycleId, endTime);
            }, 1000);
        }

        async function loadUserSavings() {
            if (!userAccount || !contract) return;
            
            try {
                const investments = await contract.methods.getUserInvestments(userAccount).call();
                const savingCount = parseInt(investments.totalSavings);
                
                if (savingCount === 0) {
                    document.getElementById('noSavingsAlert').style.display = 'flex';
                    document.getElementById('savingsTable').style.display = 'none';
                    return;
                }
                
                document.getElementById('noSavingsAlert').style.display = 'none';
                document.getElementById('savingsTable').style.display = 'table';
                
                const tbody = document.getElementById('savingsTableBody');
                tbody.innerHTML = '';
                
                let totalEarned = 0;
                
                for (let i = 0; i < savingCount; i++) {
                    const savingDetails = await contract.methods.getSavingDetails(userAccount, i).call();
                    const isActive = savingDetails.active;
                    
                    const amount = parseFloat(web3.utils.fromWei(savingDetails.amount, 'ether')).toFixed(2);
                    const percent = parseFloat(savingDetails.currentPercent) / 10;
                    const dailyReward = parseFloat(web3.utils.fromWei(savingDetails.dailyReward, 'ether')).toFixed(4);
                    
                    // Calculate earned amount based on time since last payout
                    const lastPayout = parseInt(savingDetails.lastPayout);
                    const now = Math.floor(Date.now() / 1000);
                    let earned = 0;
                    
                    if (isActive && lastPayout > 0) {
                        const timePassed = now - lastPayout;
                        const daysPassed = timePassed / (24 * 60 * 60);
                        earned = parseFloat(dailyReward) * daysPassed;
                        totalEarned += earned;
                    }
                    
                    const status = isActive ? 'Active' : 'Exp';
                    const statusClass = isActive ? 'status-active' : 'status-exp';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                        <td>${amount} USDT</td>
                        <td>${percent}%</td>
                        <td>${earned.toFixed(4)} USDT</td>
                    `;
                    tbody.appendChild(row);
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function confirmCycleInvestment() {
            if (!userAccount || !contract || !usdtContract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const amount = document.getElementById('cycleAmount').value;
            if (!selectedCyclePlan) {
                showNotification('Please select a plan', 'error');
                return;
            }
            
            if (!validateCycleAmount()) {
                showNotification('Minimum 5 USDT!', 'error');
                return;
            }
            
            const confirmCycleBtn = document.getElementById('confirmCycle');
            showButtonLoading(confirmCycleBtn, true);
            
            try {
                const amountInWei = web3.utils.toWei(amount, 'ether');
                const referrer = document.getElementById('cycleReferrer').value || '0x0000000000000000000000000000000000000000';
                
                // Check allowance and approve if needed
                const allowance = await usdtContract.methods.allowance(userAccount, CONTRACT_ADDRESS).call();
                if (BigInt(allowance) < BigInt(amountInWei)) {
                    showNotification('Approving...', 'info');
                    const approveTx = await usdtContract.methods.approve(CONTRACT_ADDRESS, amountInWei).send({ from: userAccount });
                    if (!approveTx.status) {
                        throw new Error('Approval failed');
                    }
                }
                
                showNotification('Processing...', 'info');
                const tx = await contract.methods.depositCycle(amountInWei, selectedCyclePlan, referrer).send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Cycle investment successful!', 'success');
                    showPopup(successPopup);
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Transaction failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Transaction failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmCycleBtn, false);
            }
        }

        async function confirmSavingInvestment() {
            if (!userAccount || !contract || !usdtContract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const amount = document.getElementById('savingAmount').value;
            
            if (!validateSavingAmount()) {
                showNotification('Minimum 5 USDT!', 'error');
                return;
            }
            
            const confirmSavingBtn = document.getElementById('confirmSaving');
            showButtonLoading(confirmSavingBtn, true);
            
            try {
                const amountInWei = web3.utils.toWei(amount, 'ether');
                const referrer = document.getElementById('savingReferrer').value || '0x0000000000000000000000000000000000000000';
                
                // Check allowance and approve if needed
                const allowance = await usdtContract.methods.allowance(userAccount, CONTRACT_ADDRESS).call();
                if (BigInt(allowance) < BigInt(amountInWei)) {
                    showNotification('Approving...', 'info');
                    const approveTx = await usdtContract.methods.approve(CONTRACT_ADDRESS, amountInWei).send({ from: userAccount });
                    if (!approveTx.status) {
                        throw new Error('Approval failed');
                    }
                }
                
                showNotification('Processing...', 'info');
                const tx = await contract.methods.depositSaving(amountInWei, referrer).send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Saving investment successful!', 'success');
                    showPopup(successPopup);
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Transaction failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Transaction failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmSavingBtn, false);
            }
        }

        async function confirmWithdrawCycles() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            if (selectedCycleForWithdraw.length === 0) {
                showNotification('Please select at least one cycle to withdraw', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmWithdrawCycles');
            showButtonLoading(confirmBtn, true);
            
            try {
                showNotification('Withdrawing...', 'info');
                
                // Withdraw each selected cycle
                for (const cycleId of selectedCycleForWithdraw) {
                    try {
                        const tx = await contract.methods.claimCycle(cycleId).send({ from: userAccount });
                        if (!tx.status) {
                            throw new Error(`Failed to withdraw cycle ${cycleId}`);
                        }
                    } catch (error) {
                        console.error(`Error ${cycleId}:`, error);
                        showNotification(`Error ${cycleId}: ${error.message}`, 'error');
                    }
                }
                
                showNotification('Cycles withdrawn successfully!', 'success');
                hideModal(withdrawCycleModal);
                await loadUserData();
                await loadContractStats();
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdraw failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmBtn, false);
            }
        }

        async function confirmRegrowModal() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            if (selectedCycleForRegrow === null) {
                showNotification('Please select a cycle to regrow', 'error');
                return;
            }
            
            if (selectedRegrowPlan === null) {
                showNotification('Please select a new plan for regrow', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmRegrowModal');
            showButtonLoading(confirmBtn, true);
            
            try {
                showNotification('Processing...', 'info');
                const tx = await contract.methods.regrow(selectedCycleForRegrow, selectedRegrowPlan).send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Regrow successful!', 'success');
                    hideModal(regrowCycleModal);
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Regrow failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Regrow failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmBtn, false);
            }
        }

        async function confirmWithdrawCapital() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            if (selectedSavingForWithdraw === null) {
                showNotification('Please select a saving to withdraw capital from', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmWithdrawCapital');
            showButtonLoading(confirmBtn, true);
            
            try {
                showNotification('Withdrawing...', 'info');
                const tx = await contract.methods.capitalSaving(selectedSavingForWithdraw).send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Capital withdrawn successfully!', 'success');
                    hideModal(withdrawCapitalModal);
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Capital withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(confirmBtn, false);
            }
        }

        async function withdrawSavingRewards() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const withdrawBtn = document.getElementById('withdrawSaving');
            showButtonLoading(withdrawBtn, true);
            
            try {
                showNotification('Withdrawing...', 'info');
                const tx = await contract.methods.claimSaving().send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Saving rewards withdrawn successfully!', 'success');
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(withdrawBtn, false);
            }
        }

        async function withdrawCycleReferral() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const withdrawBtn = document.getElementById('withdrawCycleReferral');
            showButtonLoading(withdrawBtn, true);
            
            try {
                showNotification('Withdrawing...', 'info');
                const tx = await contract.methods.rewardCycle().send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Successfully!', 'success');
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(withdrawBtn, false);
            }
        }

        async function withdrawSavingReferral() {
            if (!userAccount || !contract) {
                showNotification('Please connect your wallet!', 'error');
                return;
            }
            
            const withdrawBtn = document.getElementById('withdrawSavingReferral');
            showButtonLoading(withdrawBtn, true);
            
            try {
                showNotification('Withdrawing...', 'info');
                const tx = await contract.methods.rewardSaving().send({ from: userAccount });
                
                if (tx.status) {
                    showNotification('Successfully!', 'success');
                    await loadUserData();
                    await loadContractStats();
                } else {
                    throw new Error('Withdrawal failed');
                }
                
            } catch (error) {
                console.error('Error:', error);
                showNotification('Withdrawal failed: ' + error.message, 'error');
            } finally {
                showButtonLoading(withdrawBtn, false);
            }
        }

        // Initialize with home section
        showSection('home');
    </script>
</body>
</html>
